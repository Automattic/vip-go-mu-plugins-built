!function(){"use strict";var e,n={204:function(e,n,r){var t,o,a=r(893),i=window.wp.blockEditor,l=window.wp.blocks,s=window.wp.i18n,c=window.wp.components,u=JSON.parse('{"u2":"wp-parsely/recommendations","Y4":{"imagestyle":{"type":"string","default":"original"},"limit":{"type":"number","default":3},"openlinksinnewtab":{"type":"boolean","default":false},"showimages":{"type":"boolean","default":true},"sort":{"type":"string","default":"score"},"title":{"type":"string","default":"Related Content"}}}'),d=window.wp.element;(o=t||(t={}))[o.Error=0]="Error",o[o.Loaded=1]="Loaded",o[o.Recommendations=2]="Recommendations";var p=function(){return p=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},p.apply(this,arguments)},m=(0,d.createContext)({}),f=function(e,n){switch(n.type){case t.Error:return p(p({},e),{isLoaded:!0,error:n.error,recommendations:[]});case t.Loaded:return p(p({},e),{isLoaded:!0});case t.Recommendations:var r=n.recommendations;if(!Array.isArray(r))return p(p({},e),{recommendations:[]});var o=r.map((function(e){return{title:e.title,url:e.url,image_url:e.image_url,thumb_url_medium:e.thumb_url_medium}}));return p(p({},e),{isLoaded:!0,error:null,recommendations:o});default:return p({},e)}},y=function(e){var n,r,t,o,i={isLoaded:!1,recommendations:[],uuid:null!==(t=null===(r=null===(n=window.PARSELY)||void 0===n?void 0:n.config)||void 0===r?void 0:r.uuid)&&void 0!==t?t:null,clientId:null!==(o=null==e?void 0:e.clientId)&&void 0!==o?o:null,error:null},l=(0,d.useReducer)(f,i),s=l[0],c=l[1];return(0,d.useMemo)((function(){return(0,a.jsx)(m.Provider,p({value:{state:s,dispatch:c}},e))}),[e,s])},w=function(){return(0,d.useContext)(m)},h=window.wp.apiFetch,v=r.n(h),g=window.wp.compose,b=window.wp.url,_=function(){return _=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},_.apply(this,arguments)},x=function(e){var n=e.limit,r=e.sort,o=e.isEditMode,a=w().dispatch,i=(0,d.useMemo)((function(){return{limit:n,sort:r,url:window.location.href,itm_source:"wp-parsely-recommendations-block"}}),[n,r]),l=(0,d.useCallback)((function(){return e=void 0,n=void 0,l=function(){var e,n,r,l,s;return function(e,n){var r,t,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(r=1,t&&(o=2&l[0]?t.return:l[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,l[1])).done)return o;switch(t=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,t=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e],t=0}finally{r=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,v()({path:(0,b.addQueryArgs)("/wp-parsely/v1/related",{query:i})})];case 1:return e=c.sent(),[3,3];case 2:return r=c.sent(),n=r,[3,3];case 3:return(null==e?void 0:e.error)&&(n=e.error),n?(a(function(e){var n=e.error;return{type:t.Error,error:n}}({error:n})),[2]):(l=null!==(s=null==e?void 0:e.data)&&void 0!==s?s:[],o&&(l=l.map((function(e){return _(_({},e),{url:"#"})}))),a(function(e){var n=e.recommendations;return{type:t.Recommendations,recommendations:n}}({recommendations:l})),[2])}}))},new((r=void 0)||(r=Promise))((function(t,o){function a(e){try{s(l.next(e))}catch(e){o(e)}}function i(e){try{s(l.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,i)}s((l=l.apply(e,n||[])).next())}));var e,n,r,l}),[i,a,o]),s=(0,g.useDebounce)(l,300);return(0,d.useEffect)((function(){s()}),[i,s]),null},j=function(){return j=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},j.apply(this,arguments)},k=function(e,n,r){return"original"===e?n:r},O=function(e){return!0===Boolean(e)?{target:"_blank",rel:"noopener"}:{target:"_self",rel:""}},P=function(e){var n=e.imageAlt,r=e.imagestyle,t=e.openlinksinnewtab,o=e.recommendation,i=o.title,l=o.url,s=o.image_url,u=o.thumb_url_medium,d=e.showimages;return(0,a.jsx)("li",{children:(0,a.jsx)("a",j({href:l,className:"parsely-recommendations-link"},O(t),{children:(0,a.jsxs)(c.Card,{className:"parsely-recommendations-card",children:[d&&(0,a.jsx)(c.CardMedia,{className:"parsely-recommendations-cardmedia",children:(0,a.jsx)("img",{className:"parsely-recommendations-image",src:k(r,s,u),alt:n})}),(0,a.jsx)(c.CardBody,{className:"parsely-recommendations-cardbody",children:i})]})}))})},R=function(e){var n=e.imagestyle,r=e.recommendations,t=e.showimages,o=e.openlinksinnewtab;return(0,a.jsx)("ul",{className:"parsely-recommendations-list",children:r.map((function(e){return(0,a.jsx)(P,{imageAlt:(0,s.__)("Image for link","wp-parsely"),imagestyle:n,openlinksinnewtab:o,recommendation:e,showimages:t},e.url+" "+e.title)}))})},C=function(e){var n=e.title;return n?(0,a.jsx)("p",{className:"parsely-recommendations-list-title",children:n}):(0,a.jsx)(a.Fragment,{})};function E(e){var n,r,t=e.imagestyle,o=e.isEditMode,i=e.limit,l=e.openlinksinnewtab,c=e.showimages,u=e.sort,d=e.title,p=w().state,m=p.error,f=p.isLoaded,y=p.recommendations;return f&&o&&(m?((r="".concat((0,s.__)("Error:","wp-parsely")," ").concat(JSON.stringify(m))).includes('"errors":{"http_request_failed"')||"object"==typeof m&&"fetch_error"===(null==m?void 0:m.code)?r=(0,s.__)("The Parse.ly Recommendations API is not accessible. You may be offline.","wp-parsely"):r.includes('Error: {"code":403,"message":"Forbidden","data":null}')?r=(0,s.__)("Access denied. Please verify that your Site ID is valid.","wp-parsely"):"object"==typeof m&&"rest_no_route"===(null==m?void 0:m.code)&&(r=(0,s.__)("The REST route is unavailable. To use it, wp_parsely_enable_related_api_proxy should be true.","wp-parsely")),n=r):Array.isArray(y)&&!(null==y?void 0:y.length)&&(n=(0,s.__)("No recommendations found.","wp-parsely"))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{limit:i,sort:u,isEditMode:o}),!f&&(0,a.jsx)("span",{className:"parsely-recommendations-loading",children:(0,s.__)("Loadingâ€¦","wp-parsely")}),n&&(0,a.jsx)("span",{className:"parsely-recommendations-error",children:n}),f&&!!(null==y?void 0:y.length)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C,{title:d}),(0,a.jsx)(R,{imagestyle:t,openlinksinnewtab:l,recommendations:y,showimages:c})]})]})}var S=function(e){var n=e.attributes,r=n.imagestyle,t=n.limit,o=n.openlinksinnewtab,l=n.showimages,u=n.sort,d=n.title,p=e.setAttributes;return(0,a.jsx)(i.InspectorControls,{children:(0,a.jsxs)(c.PanelBody,{title:"Settings",initialOpen:!0,children:[(0,a.jsx)(c.PanelRow,{children:(0,a.jsx)(c.TextControl,{label:(0,s.__)("Title","wp-parsely"),value:d,onChange:function(e){return p({title:e})}})}),(0,a.jsx)(c.PanelRow,{children:(0,a.jsx)(c.RangeControl,{label:(0,s.__)("Maximum Results","wp-parsely"),min:1,max:25,onChange:function(e){return p({limit:e})},value:t})}),(0,a.jsx)(c.PanelRow,{children:(0,a.jsx)(c.ToggleControl,{label:(0,s.__)("Open Links in New Tab","wp-parsely"),checked:o,onChange:function(){return p({openlinksinnewtab:!o})}})}),(0,a.jsx)(c.PanelRow,{children:(0,a.jsx)(c.ToggleControl,{label:(0,s.__)("Show Images","wp-parsely"),help:l?(0,s.__)("Showing images","wp-parsely"):(0,s.__)("Not showing images","wp-parsely"),checked:l,onChange:function(){return p({showimages:!l})}})}),l&&(0,a.jsx)(c.PanelRow,{children:(0,a.jsx)(c.RadioControl,{label:(0,s.__)("Image style","wp-parsely"),selected:r,options:[{label:(0,s.__)("Original image","wp-parsely"),value:"original"},{label:(0,s.__)("Thumbnail from Parse.ly","wp-parsely"),value:"thumbnail"}],onChange:function(e){p({imagestyle:"original"===e?"original":"thumbnail"})}})}),(0,a.jsx)(c.PanelRow,{children:(0,a.jsx)(c.SelectControl,{label:(0,s.__)("Sort Recommendations","wp-parsely"),value:u,options:[{label:(0,s.__)("Score","wp-parsely"),value:"score"},{label:(0,s.__)("Publication Date","wp-parsely"),value:"pub_date"}],onChange:function(e){return p({sort:e})}})})]})})},A=function(){return A=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},A.apply(this,arguments)},N=u.u2,L=u.Y4;(0,l.registerBlockType)(N,{apiVersion:2,icon:function(e){var n=e.size,r=void 0===n?24:n;return(0,a.jsxs)(c.SVG,{height:r,viewBox:"0 0 60 65",width:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)(c.Path,{fill:"#5ba745",d:"M23.72,51.53c0-.18,0-.34-.06-.52a13.11,13.11,0,0,0-2.1-5.53A14.74,14.74,0,0,0,19.12,43c-.27-.21-.5-.11-.51.22l-.24,3.42c0,.33-.38.35-.49,0l-1.5-4.8a1.4,1.4,0,0,0-.77-.78,23.91,23.91,0,0,0-3.1-.84c-1.38-.24-3.39-.39-3.39-.39-.34,0-.45.21-.25.49l2.06,3.76c.2.27,0,.54-.29.33l-4.51-3.6a3.68,3.68,0,0,0-2.86-.48c-1,.16-2.44.46-2.44.46a.68.68,0,0,0-.39.25.73.73,0,0,0-.14.45S.41,43,.54,44a3.63,3.63,0,0,0,1.25,2.62L6.48,50c.28.2.09.49-.23.37l-4.18-.94c-.32-.12-.5,0-.4.37,0,0,.69,1.89,1.31,3.16a24,24,0,0,0,1.66,2.74,1.34,1.34,0,0,0,1,.52l5,.13c.33,0,.41.38.1.48L7.51,58c-.31.1-.34.35-.07.55a14.29,14.29,0,0,0,3.05,1.66,13.09,13.09,0,0,0,5.9.5,25.13,25.13,0,0,0,4.34-1,9.55,9.55,0,0,1-.08-1.2,9.32,9.32,0,0,1,3.07-6.91"}),(0,a.jsx)(c.Path,{fill:"#5ba745",d:"M59.7,41.53a.73.73,0,0,0-.14-.45.68.68,0,0,0-.39-.25s-1.43-.3-2.44-.46a3.64,3.64,0,0,0-2.86.48l-4.51,3.6c-.26.21-.49-.06-.29-.33l2.06-3.76c.2-.28.09-.49-.25-.49,0,0-2,.15-3.39.39a23.91,23.91,0,0,0-3.1.84,1.4,1.4,0,0,0-.77.78l-1.5,4.8c-.11.32-.48.3-.49,0l-.24-3.42c0-.33-.24-.43-.51-.22a14.74,14.74,0,0,0-2.44,2.47A13.11,13.11,0,0,0,36.34,51c0,.18,0,.34-.06.52a9.26,9.26,0,0,1,3,8.1,24.1,24.1,0,0,0,4.34,1,13.09,13.09,0,0,0,5.9-.5,14.29,14.29,0,0,0,3.05-1.66c.27-.2.24-.45-.07-.55l-3.22-1.17c-.31-.1-.23-.47.1-.48l5-.13a1.38,1.38,0,0,0,1-.52A24.6,24.6,0,0,0,57,52.92c.61-1.27,1.31-3.16,1.31-3.16.1-.33-.08-.49-.4-.37l-4.18.94c-.32.12-.51-.17-.23-.37l4.69-3.34A3.63,3.63,0,0,0,59.46,44c.13-1,.24-2.47.24-2.47"}),(0,a.jsx)(c.Path,{fill:"#5ba745",d:"M46.5,25.61c0-.53-.35-.72-.8-.43l-4.86,2.66c-.45.28-.56-.27-.23-.69l4.66-6.23a2,2,0,0,0,.28-1.68,36.51,36.51,0,0,0-2.19-4.89,34,34,0,0,0-2.81-3.94c-.33-.41-.74-.35-.91.16l-2.28,5.68c-.16.5-.6.48-.59-.05l.28-8.93a2.54,2.54,0,0,0-.66-1.64S35,4.27,33.88,3.27,30.78.69,30.78.69a1.29,1.29,0,0,0-1.54,0s-1.88,1.49-3.12,2.59-2.48,2.35-2.48,2.35A2.5,2.5,0,0,0,23,7.27l.27,8.93c0,.53-.41.55-.58.05l-2.29-5.69c-.17-.5-.57-.56-.91-.14a35.77,35.77,0,0,0-3,4.2,35.55,35.55,0,0,0-2,4.62,2,2,0,0,0,.27,1.67l4.67,6.24c.33.42.23,1-.22.69l-4.87-2.66c-.45-.29-.82-.1-.82.43a18.6,18.6,0,0,0,.83,5.07,20.16,20.16,0,0,0,5.37,7.77c3.19,3,5.93,7.8,7.45,11.08A9.6,9.6,0,0,1,30,49.09a9.31,9.31,0,0,1,2.86.45c1.52-3.28,4.26-8.11,7.44-11.09a20.46,20.46,0,0,0,5.09-7,19,19,0,0,0,1.11-5.82"}),(0,a.jsx)(c.Path,{fill:"#5ba745",d:"M36.12,58.44A6.12,6.12,0,1,1,30,52.32a6.11,6.11,0,0,1,6.12,6.12"})]})},category:"widgets",edit:function(e){return(0,a.jsx)("div",A({},(0,i.useBlockProps)(),{children:(0,a.jsxs)(y,{clientId:e.clientId,children:[(0,a.jsx)(S,A({},e)),(0,a.jsx)(E,A({},e.attributes,{isEditMode:!0}))]})}))},example:{attributes:{preview:!0}},attributes:A(A({},L),{title:{type:"string",default:(0,s.__)("Related Content","wp-parsely")}}),transforms:{from:[{type:"block",blocks:["core/legacy-widget"],isMatch:function(e){var n=e.idBase,r=e.instance;return!!(null==r?void 0:r.raw)&&"Parsely_Recommended_Widget"===n},transform:function(e){var n=e.instance;return(0,l.createBlock)("wp-parsely/recommendations",{name:n.raw.name})}}]}})},251:function(e,n,r){var t=r(196),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,r){var t,a={},c=null,u=null;for(t in void 0!==r&&(c=""+r),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(u=n.ref),n)i.call(n,t)&&!s.hasOwnProperty(t)&&(a[t]=n[t]);if(e&&e.defaultProps)for(t in n=e.defaultProps)void 0===a[t]&&(a[t]=n[t]);return{$$typeof:o,type:e,key:c,ref:u,props:a,_owner:l.current}}n.Fragment=a,n.jsx=c,n.jsxs=c},893:function(e,n,r){e.exports=r(251)},196:function(e){e.exports=window.React}},r={};function t(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={exports:{}};return n[e](a,a.exports,t),a.exports}t.m=n,e=[],t.O=function(n,r,o,a){if(!r){var i=1/0;for(u=0;u<e.length;u++){r=e[u][0],o=e[u][1],a=e[u][2];for(var l=!0,s=0;s<r.length;s++)(!1&a||i>=a)&&Object.keys(t.O).every((function(e){return t.O[e](r[s])}))?r.splice(s--,1):(l=!1,a<i&&(i=a));if(l){e.splice(u--,1);var c=o();void 0!==c&&(n=c)}}return n}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},t.d=function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e={878:0,570:0};t.O.j=function(n){return 0===e[n]};var n=function(n,r){var o,a,i=r[0],l=r[1],s=r[2],c=0;if(i.some((function(n){return 0!==e[n]}))){for(o in l)t.o(l,o)&&(t.m[o]=l[o]);if(s)var u=s(t)}for(n&&n(r);c<i.length;c++)a=i[c],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(u)},r=self.webpackChunkwp_parsely=self.webpackChunkwp_parsely||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))}();var o=t.O(void 0,[570],(function(){return t(204)}));o=t.O(o)}();