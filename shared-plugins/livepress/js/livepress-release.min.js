/*! livepress -v1.2.2
 * http://livepress.com/
 * Copyright (c) 2014 LivePress, Inc.
 */
var Livepress=Livepress||{};Livepress.ensureExists=function(a){return void 0===a&&(a={}),a};var console=console||{log:function(){}};Livepress.getUpdatePermalink=function(a){var b,c=/livepress-update-([0-9]+)/,d=c.exec(a)[1],e="",f=jQuery(location).attr("protocol")+"//"+jQuery(location).attr("host")+jQuery(location).attr("pathname"),g=jQuery(location).attr("search");return f+=null!==(b=g.match(/\?p=[0-9]+/))?b+"&":"?",e+="lpup=",f+e+d+"#"+a},Livepress.updateShortlinksCache=window.LivepressConfig.shortlink||{},Livepress.getUpdateShortlink=function(a){var b=/livepress-update-([0-9]+)/,c=b.exec(a)[1];return c in Livepress.updateShortlinksCache?Livepress.updateShortlinksCache[c]:jQuery.ajax({url:window.LivepressConfig.ajax_url,xhrFields:{withCredentials:!0},type:"post",async:!1,dataType:"json",data:{action:"lp_update_shortlink",post_id:window.LivepressConfig.post_id,_ajax_nonce:LivepressConfig.lp_update_shortlink_nonce,update_id:c}}).promise()},String.prototype.parseGMT=function(a){var b,c,d=this,e=a||"h:i:s a";return b=Date.parse(d.replace(/-/gi,"/"),"Y/m/d H:i:s"),c=new Date(b),"Invalid Date"===c.toString()?this.toString():c=c.format(e)},String.prototype.replaceAll=function(a,b){var c=this;return c=c.split(a).join(b)},"undefined"==typeof window.twttr&&(window.twttr=function(a,b,c){var d,e,f=a.getElementsByTagName(b)[0];if(!a.getElementById(c))return e=a.createElement(b),e.id=c,e.src="https://platform.twitter.com/widgets.js",f.parentNode.insertBefore(e,f),window.twttr||(d={_e:[],ready:function(a){d._e.push(a)}})}(document,"script","twitter-wjs")),jQuery.fn.getBg=function(){var a,b,c,d=jQuery(this);return a=d.css("background-color"),"transparent"!==a&&"rgba(0, 0, 0, 0)"!==a&&void 0!==a?a:(b=this.parents().filter(function(){return c=d.css("background-color"),"transparent"!==c&&"rgba(0, 0, 0, 0)"!==c}).eq(0).css("background-color"),void(b?d.css("background-color",b):d.css("background-color","#ffffff")))},jQuery.extend({getUrlVars:function(a){for(var b,c=[],d=a.href||window.location.href,e=d.slice(d.indexOf("?")+1).split("&"),f=0;f<e.length;f++)b=e[f].split("="),c.push(b[0]),c[b[0]]=b[1];return c},getUrlVar:function(a,b){return jQuery.getUrlVars(b||!1)[a]}}),jQuery.fn.outerHTML=function(a){return a?this.before(a).remove():jQuery("<div>").append(this.eq(0).clone()).html()},jQuery.fn.autolink=function(){return this.each(function(){var a=new RegExp('((http|https|ftp)://[\\w?=&./-;#~%-]+(?![\\w\\s?&./;#~%"=-]*>))',"g");jQuery(this).html(jQuery(this).html().replace(a,'<a href="$1">$1</a> '))})},"undefined"==typeof document.activeElement&&jQuery(document).focusin(function(a){document.activeElement=a.target}).focusout(function(){document.activeElement=null}),jQuery.extend(jQuery.expr[":"],{focus:function(a){return a===document.activeElement}}),Date.prototype.format=function(a){var b,c,d="",e=Date.replaceChars;for(b=0;b<a.length;b++)c=a.charAt(b),d+=e[c]?e[c].call(this):c;return d},Date.replaceChars={shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d:function(){return(this.getDate()<10?"0":"")+this.getDate()},D:function(){return Date.replaceChars.shortDays[this.getDay()]},j:function(){return this.getDate()},l:function(){return Date.replaceChars.longDays[this.getDay()]},N:function(){return this.getDay()+1},S:function(){return this.getDate()%10===1&&11!==this.getDate()?"st":this.getDate()%10===2&&12!==this.getDate()?"nd":this.getDate()%10===3&&13!==this.getDate()?"rd":"th"},w:function(){return this.getDay()},z:function(){return"Not Yet Supported"},W:function(){return"Not Yet Supported"},F:function(){return Date.replaceChars.longMonths[this.getMonth()]},m:function(){return(this.getMonth()<9?"0":"")+(this.getMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){return"Not Yet Supported"},L:function(){return this.getFullYear()%4===0&&this.getFullYear()%100!==0||this.getFullYear()%400===0?"1":"0"},o:function(){return"Not Supported"},Y:function(){return this.getFullYear()},y:function(){return(""+this.getFullYear()).substr(2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){return"Not Yet Supported"},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){return((this.getHours()%12||12)<10?"0":"")+(this.getHours()%12||12)},H:function(){return(this.getHours()<10?"0":"")+this.getHours()},i:function(){return(this.getMinutes()<10?"0":"")+this.getMinutes()},s:function(){return(this.getSeconds()<10?"0":"")+this.getSeconds()},e:function(){return"Not Yet Supported"},I:function(){return"Not Supported"},O:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},P:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+":"+(Math.abs(this.getTimezoneOffset()%60)<10?"0":"")+Math.abs(this.getTimezoneOffset()%60)},T:function(){var a,b;return b=this.getMonth(),this.setMonth(0),a=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1"),this.setMonth(b),a},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return this.format("Y-m-d")+"T"+this.format("H:i:sP")},r:function(){return this.toString()},U:function(){return this.getTime()/1e3}},function(a){var b=function(a){return"object"==typeof a?a:{top:a,left:a}},c=a.scrollTo=function(b,c,d){a(window).scrollTo(b,c,d)};c.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1},c.window=function(){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||-1!==a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return a.browser.safari||"BackCompat"===d.compatMode?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return"object"==typeof e&&(f=e,e=0),"function"==typeof f&&(f={onAfter:f}),"max"===d&&(d=9e9),f=a.extend({},c.defaults,f),e=e||f.speed||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=b(f.offset),f.over=b(f.over),this._scrollable().each(function(){var g,h=this,i=a(h),j=d,k={},l=i.is("html,body"),m=function(a){i.animate(k,e,f.easing,a&&function(){a.call(this,d,f)})};"number"!=typeof j&&"string"!=typeof j||!/^([\-+]=)?\d+(\.\d+)?(px|%)?$/.test(j)?(("number"==typeof j||"string"==typeof j)&&(j=a(j,this)),(j.is||j.style)&&(g=(j=a(j)).offset())):j=b(j),a.each(f.axis.split(""),function(a,b){var d="x"===b?"Left":"Top",e=d.toLowerCase(),n="scroll"+d,o=h[n],p=c.max(h,b);if(g)k[n]=g[e]+(l?0:o-i.offset()[e]),f.margin&&(k[n]-=parseInt(j.css("margin"+d),10)||0,k[n]-=parseInt(j.css("border"+d+"Width"),10)||0),k[n]+=f.offset[e]||0,f.over[e]&&(k[n]+=j["x"===b?"width":"height"]()*f.over[e]);else{var q=j[e];k[n]=q.slice&&"%"===q.slice(-1)?parseFloat(q)/100*p:q}/^\d+$/.test(k[n])&&(k[n]=k[n]<=0?0:Math.min(k[n],p)),!a&&f.queue&&(o!==k[n]&&m(f.onAfterFirst),delete k[n])}),m(f.onAfter)}).end()},c.max=function(b,c){var d="x"===c?"Width":"Height",e="scroll"+d;if(!a(b).is("html,body"))return b[e]-a(b)[d.toLowerCase()]();var f="client"+d,g=b.ownerDocument.documentElement,h=b.ownerDocument.body;return Math.max(g[e],h[e])-Math.min(g[f],h[f])}}(jQuery),function(jQuery){var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]},b=function(b){var c;return b&&b.constructor===Array&&3===b.length?b:(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))?[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]:(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))?[2.55*parseFloat(c[1]),2.55*parseFloat(c[2]),2.55*parseFloat(c[3])]:(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))?[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]:a[jQuery.trim(b).toLowerCase()]},c=function(a,c){var d;do{if(d=jQuery.curCSS(a,c),""!==d&&"transparent"!==d||jQuery.nodeName(a,"body"))break;c="backgroundColor"}while(a=a.parentNode);return b(d)};jQuery.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(a,d){jQuery.fx.step[d]=function(a){void 0===a.start&&(a.start=c(a.elem,d),a.end=b(a.end)),a.elem.style[d]="rgb("+[Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0),Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0),Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)].join(",")+")"}})}(jQuery),function(a){a.gritter={},a.gritter.options={fade_in_speed:"fast",fade_out_speed:500,time:1e3};var b={fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_control:'<div class = "gritter-control"><div class ="gritter-scroll">Scroll to Comment</div><div class ="gritter-settings"></div><div class="gritter-close"></div></div>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper gritter-item [[item_class]] [[class_name]] [[comment_container_id]]" style="display:none"><div class="gritter-top"></div><div class="gritter-inner"><div class = "gritter-control"><div class ="gritter-scroll">Scroll to Comment</div><div class ="gritter-settings"></div><div class="gritter-close"></div></div>[[image]]<span class="gritter-title">[[username]]</span><div class="lp-date">[[date]]</div><p>[[text]]</p>[[comments]]<div class="bubble-point"></div></div><div class="gritter-bot"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(c){c.title||(c.title=""),c.text||(c.text=""),this._is_setup||this._runSetup();var d=c.title,e=c.commentContainerId,f=c.text,g=c.date,h=c.image,i=c.comments||"",j=c.sticky||!1,k=c.class_name||"",l=c.time||"";this._verifyWrapper(),this._item_count+=1;var m=this._item_count,n=this._tpl_item;a(["before_open","after_open","before_close","after_close"]).each(function(d,e){b["_"+e+"_"+m]=a.isFunction(c[e])?c[e]:function(){}}),this._custom_timer=0,l&&(this._custom_timer=l),void 0===h&&(h="");var o=h?'<img src="'+h+'" class="gritter-image" />':"",p=h?"gritter-with-image":"gritter-without-image";n=this._str_replace(["[[username]]","[[text]]","[[date]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]","[[comments]]","[[comment_container_id]]"],[d,f,g,o,this._item_count,p,k,i,e],n),this["_before_open_"+m](),a("#gritter-notice-wrapper").prepend(n);var q=a("#gritter-item-"+this._item_count),r=a(q.find(".gritter-scroll"));return jQuery.isFunction(c.scrollToCallback)?(r.bind("click",c.scrollToCallback),c.scrollToText&&r.text(c.scrollToText)):r.bind("click",function(a){var b=jQuery(jQuery(a.target).parents(".gritter-item-wrapper")[0]),c=b.attr("class").split(/\s+/);jQuery.each(c,function(a,b){var c=b.match(/comment\-/);return null!==c?void jQuery.scrollTo(jQuery("#"+b),900):void 0})}),q.fadeIn(this.fade_in_speed,function(){b["_after_open_"+m](a(this))}),j||this._setFadeTimer(q,m),a(q).bind("mouseenter mouseleave",function(c){"mouseenter"===c.type?j||b._restoreItemIfFading(a(this),m):j||b._setFadeTimer(a(this),m),b._hoverState(a(this),c.type)}),m},_countRemoveWrapper:function(b,c){c.remove(),this["_after_close_"+b](c),0===a(".gritter-item-wrapper").length&&a("#gritter-notice-wrapper").remove()},_fade:function(a,c,d,e){d=d||{};var f="undefined"!=typeof d.fade?d.fade:!0,g=d.speed||this.fade_out_speed;this["_before_close_"+c](a),e&&a.unbind("mouseenter mouseleave"),f?a.animate({opacity:0},g,function(){a.animate({height:0},300,function(){b._countRemoveWrapper(c,a)})}):this._countRemoveWrapper(c,a)},_hoverState:function(a,c){if("mouseenter"===c){a.addClass("hover");var d=a.find(".gritter-control");d.show(),a.find(".gritter-close").click(function(){var c=a.attr("id").split("-")[2];b.removeSpecific(c,{},a,!0)})}else a.removeClass("hover"),a.find(".gritter-control").hide()},removeSpecific:function(b,c,d,e){d||(d=a("#gritter-item-"+b)),this._fade(d,b,c||{},e)},_restoreItemIfFading:function(a,b){clearTimeout(this["_int_id_"+b]),a.stop().css({opacity:""})},_runSetup:function(){var b;for(b in a.gritter.options)a.gritter.options.hasOwnProperty(b)&&(this[b]=a.gritter.options[b]);this._is_setup=1},_setFadeTimer:function(a,c){var d=this._custom_timer?this._custom_timer:this.time;this["_int_id_"+c]=setTimeout(function(){b._fade(a,c)},d)},stop:function(b){var c=a.isFunction(b.before_close)?b.before_close:function(){},d=a.isFunction(b.after_close)?b.after_close:function(){},e=a("#gritter-notice-wrapper");c(e),e.fadeOut(function(){a(this).remove(),d()})},_str_replace:function(a,b,c,d){var e=0,f=0,g="",h="",i=0,j=0,k=[].concat(a),l=[].concat(b),m=c,n=l instanceof Array,o=m instanceof Array;for(m=[].concat(m),d&&(this.window[d]=0),e=0,i=m.length;i>e;e++)if(""!==m[e])for(f=0,j=k.length;j>f;f++)g=m[e]+"",h=n?void 0!==l[f]?l[f]:"":l[0],m[e]=g.split(k[f]).join(h),d&&m[e]!==g&&(this.window[d]+=(g.length-m[e].length)/k[f].length);return o?m:m[0]},_verifyWrapper:function(){0===a("#gritter-notice-wrapper").length&&a("body").append(this._tpl_wrap)}};a.gritter.add=function(a){try{return b.add(a||{})}catch(c){var d="Gritter Error: "+c;"undefined"!=typeof console&&console.error?console.error(d,a):alert(d)}},a.gritter.remove=function(a,c){b.removeSpecific(a,c||{})},a.gritter.removeAll=function(a){b.stop(a||{})}}(jQuery),Livepress.Ui={},Livepress.Ui.View=function(a){var b=this,c=jQuery("#livepress"),d=c.find(".lp-comments-count"),e=c.find(".lp-updates-count"),f=c.find(".lp-settings-button"),g=c.find(".lp-bar"),h=jQuery("#lp-settings");this.set_comment_num=function(a){var b=d.html();d.html(parseInt(a,10)),b!==a&&d.parent().animate({color:"#ffff66"},200).animate({color:"#ffffff"},800)},this.set_live_updates_num=function(a){e.html(parseInt(a,10))};var i=h.find(".lp-settings-close"),j=(h.find(".lp-tab"),h.find(".lp-pane"),h.find(".lp-button.lp-expand-options"),h.find("input[name=lp-setting-sound]"),h.find("input[name=lp-setting-updates]")),k=h.find("input[name=lp-setting-comments]"),l=h.find("input[name=lp-setting-scroll]"),m=(h.find(".lp-button.lp-update-settings"),h.find(".lp-options-ext"),h.find(".lp-settings-short"));a&&(g.find(".lp-sprite.comments").hide(),d.parent().hide(),k.parent().hide());var n=function(){var a=document.documentElement;return b.innerHeight||a&&a.clientHeight||document.body.clientHeight},o=function(){var a=document.documentElement;return b.innerWidth||a&&a.clientWidth||document.body.clientWidth},p=function(){o(),n(),g.offset();h.show("blind")},q=function(){h.hide("blind"),m.removeClass("expanded")},r=function(){return h.is(":visible")?q():p()};f.click(function(){return r()}),i.click(function(){return q()});var s=function(a,b,c,d){return b.prop("checked",a).change(function(){return b.is(":checked")?c(1):d(1)}),a?c():d()};this.live_control=function(a,b,c){s(a,j,b,c)},this.follow_comments_control=function(a,b,c){s(a,k,b,c)},this.scroll_control=function(a,b,c){s(a,l,b,c)},this.add_link_to_greader=function(a){h.find(".lp-greader-link").attr("href",a)},this.subscribeIm=function(a){h.find(".lp-subscribe .lp-button").click(function(){var b=h.find("[name=lp-im-type]").val(),c=h.find("[name=lp-im-username]").val();a(c,b)})},this.imFeedbackSpin=function(a){h.find(".lp-subscribe-im-spin")[a?"show":"hide"]()},this.handleImFeedback=function(a,b){var c={INVALID_JID:lp_client_strings.no_google_acct,NOT_IN_ROSTER:lp_client_strings.no_acct_in_jabber,NOT_AUTHORIZED:lp_client_strings.username_not_auth,AUTHORIZED:lp_client_strings.username_authorized,INTERNAL_SERVER_ERROR:lp_client_strings.livepress_err_retry,AUTHORIZATION_SENT:lp_client_strings.auth_request_sent},d=c[a];d="undefined"!=typeof d?d.replace("[USERNAME]",b):c.INTERNAL_SERVER_ERROR,d.length>0&&(this.imFeedbackSpin(!1),h.find(".lp-im-subscription-message").html(d).show())};var t=h.find(".live-updates-status"),u=g.find(".lp-counter");this.connected=function(){t.text("ON"),u.removeClass("lp-off").addClass("lp-on"),g.find(".lp-logo").attr("title","Connected")},this.disconnected=function(){t.text("OFF"),u.removeClass("lp-on").addClass("lp-off"),g.find(".lp-logo").attr("title","Not Connected")};var v=function(){jQuery(".gritter-settings").click(function(){p()})};this.comment_alert=function(a,b){console.log("Comment alert",a);var c=jQuery("<div>"),d=jQuery("<abbr>").attr("class","timeago").attr("title",b).text(b.replace(/Z/," UTC"));c.append(d);var e={class_name:"comment",date:c.html(),time:7e3};jQuery.gritter.add(jQuery.extend({},e,a)),jQuery(".gritter-comments .add-comment").click(function(){jQuery().scrollTo("#respond, #commentform, #submit",900)}),v(),jQuery("abbr.livepress-timestamp").timeago().attr("title","")}},Livepress.Ui.UpdateBoxView=function(a){function b(a){var b=['<li style="display:none;">',a,"</li>"].join("");if(m+=1,m>1?(j.html(" new updates."),k.html("them")):(j.html(" new update."),k.html("it")),m>7)h.slideDown(300);else{g.append(b);var c=g.find("li:last");c.show()}i.text(m),e.is(":visible")||(e.slideDown(600),e.css("display","inline-block")),jQuery("abbr.livepress-timestamp").timeago().attr("title","")}"undefined"==typeof a&&(a=!0);var c=['<div class="update-box-content">','<div class="lp-update-count">','<strong class="lp-update-num">0</strong>','<strong class="lp-update-new-update"> '+lp_client_strings.new_updates+". </strong>",'<a href="javascript:location.reload();" class="lp-refresher">'+lp_client_strings.refresh+"</a> "+lp_client_strings.to_see+' <span class="lp-update-it-them">'+lp_client_strings.them+"</span>.","</div>",'<div class="lp-balloon">','<img class="lp-close-button" title="Close" />','<ul class="lp-new-posts"></ul>','<a class="lp-more-link" href="javascript:location.reload();">+ more</a>','<div class="lp-balloon-tail">&nbsp;</div>',"</div>","</div>",'<div class="clear"></div>'].join(""),d=".livepress lp-update-container",e=jQuery("#lp-update-box");e.addClass(d),e.append(c);var f=e.find(".lp-balloon"),g=e.find(".lp-new-posts"),h=e.find(".lp-more-link"),i=e.find(".lp-update-num"),j=e.find(".lp-update-new-update"),k=e.find(".lp-update-it-them"),l=e.find(".lp-close-button"),m=0;l.click(function(){f.fadeOut()}),l.attr("src",LivepressConfig.lp_plugin_url+"/img/lp-settings-close.png"),this.reposition_balloon=function(){f.css("margin-top",-(f.height()+60))},this.new_post=function(a,c,d,e){if(void 0!==e){var f=jQuery("<div>"),g=jQuery("<abbr>").attr("class","timeago").attr("title",e).text(e.replace(/Z/," UTC")),h=jQuery("<a></a>").attr("href",c).text("Update: "+a);f.append(g).append(h),b(f.html()),this.reposition_balloon()}},this.post_update=function(a,c){var d=25,e=28,f=jQuery("<div>"),g=jQuery("<abbr>").attr("class","timeago").attr("title",c).text(c.replace(/Z/," UTC")),h=a.indexOf(" ",d);-1===h&&(h=a.length),h>e&&(h=a.substr(0,h).lastIndexOf(" ")),(-1===h||h>e)&&(h=e);var i=a.substr(0,h)+(h<a.length?"&hellip;":""),j=" Update: <strong>"+i+"</strong>";f.append(g).append(j),b(f.html())},this.clear=function(){h.hide(),g.html(""),m=0,i.text("0"),e.is(":visible")&&e.slideUp(600)}},Livepress.Ui.UpdateView=function(a){var b,c={},d=a.hasClass("pinned-first-live-update"),e=function(){return a.find(".livepress-update-header").text()},f=function(b){if(d)return LivepressConfig.post_title;var c,e=a.clone();e.find(".livepress-meta").remove(),e.find(".live-update-authors").remove(),e.find(".live-update-livetags").remove();var f=e.text();f=e.text().replace(/\n/g,""),f=f.replace(/\s+/," ");var g=[];for(g.push(0),c=1;c<f.length;c+=1)" "===f.charAt(c)&&g.push(c);if(g.push(f.length),f.length>b){c=0;for(var h=b;g[c]<b&&c<g.length-1;)h=g[c],c+=1;f=f.substring(0,h)+"…"}return f.trim()},g=jQuery("<div>").addClass("lp-share");if(void 0===b){c.element=a,c.id=a.attr("id");var h="";c.title=e(),c.shortExcerpt=f(100),c.longExcerpt=f(1e3)+" ",c.shortExcerpt+=h,c.longExcerpt+=h}c.link=function(){return d?LivepressConfig.post_url:Livepress.getUpdatePermalink(c.id)},c.shortLink=function(){return d?LivepressConfig.post_url:Livepress.getUpdateShortlink(c.id)};var i=["facebook","twitter","hyperlink"],j=Livepress.Ui.ReactButtons(c,i);g.append(j),c.element.append(g),b=a.find(".lp-pre-update-ui"),a.get(0)===jQuery(".livepress-update").get(0)&&b.addClass("lp-first-update"),a.addClass("ui-container")},Livepress.Ui.ReactButton=function(a,b){var c={},d={};return d.btnDiv=jQuery("<div>").addClass("lp-pu-ui-feature lp-pu-"+a),c.buttonFor=function(a,b){var c={};return c.link=b.link,c.type=a,d[a+"Button"](c),c.div},d.constructButtonMarkup=function(){var b=jQuery("<span>").addClass("lp-icon-"+a+" lp-pu-ico");return d.btnDiv.append(b)},d.twitterButton=function(a){a.div=d.constructButtonMarkup(),a.div.click(function(){var a=screen.width/2-300,c=screen.height/2-175,d="width=600,height=350,location=yes,,status=yes,top="+c+", left="+a,e=b.shortLink(),f=3>b.shortExcerpt.length?"":b.shortExcerpt.replace(/#/g,"%23")+" ",g=b.title.trim(),h=""===g?f:g+" ";"string"==typeof e?window.open("https://twitter.com/intent/tweet?text="+h+e,"Twitter",d):e.done(function(a){window.open("https://twitter.com/intent/tweet?text="+h+("undefined"!=typeof a.data?a.data.shortlink:Livepress.getUpdatePermalink(b.id)),"Twitter",d);var c=/livepress-update-([0-9]+)/,e=c.exec(b.id)[1];"undefined"!=typeof a.data&&(Livepress.updateShortlinksCache[e]=a.data.shortlink)}).fail(function(){window.open("https://twitter.com/intent/tweet?text="+h+Livepress.getUpdatePermalink(b.id),"Twitter",d)})})},d.facebookButton=function(a){a.div=d.constructButtonMarkup(),a.div.click(function(){var a=Livepress.getUpdatePermalink(b.id),c=436,d=626,e=(screen.width-d)/2,f=(screen.height-c)/2,g="toolbar=0, status=0, width="+d+", height="+c+", left="+e+", top="+f;return"undefined"==typeof LivepressConfig.facebook_app_id||""===LivepressConfig.facebook_app_id?window.open("http://www.facebook.com/sharer.php?u="+encodeURIComponent(a)," sharer",g):window.open("https://www.facebook.com/dialog/share_open_graph?app_id="+LivepressConfig.facebook_app_id+"&display=popup&action_type=og.likes&action_properties="+encodeURIComponent('{"object":"'+a+'" }')+"&redirect_uri="+encodeURIComponent(a)),!1})},d.hyperlinkButton=function(a){a.div=d.constructButtonMarkup(),a.div.click(function(){if(0===jQuery("#"+b.id+"-share input.permalink").length){var a=jQuery("<div/>"),c=jQuery("<input/>"),d=b.shortLink(),e=jQuery("<span/>");"string"!=typeof d?(c.hide(),d.done(function(a){console.log(a.data.shortlink),c.show(),c.attr("value",""+("undefined"!=typeof a.data)?a.data.shortlink:Livepress.getUpdatePermalink(b.id))}).fail(function(){c.show()})):c.attr("value",d),c.addClass("permalink"),c.click(function(){c.select()}),e.text(lp_client_strings.copy_permalink),a.addClass("lp-permalink-meta"),a.prepend(e),a.prepend(c),jQuery("#"+b.id+" .lp-pre-update-ui").append(a),c.select()}else jQuery("#"+b.id+"-share").find(".lp-permalink-meta").remove();return!1})},c.buttonFor(a,b)},Livepress.Ui.ReactButtons=function(a,b){var c=jQuery("<div>").addClass("lp-pre-update-ui").attr("id",a.id+"-share");return jQuery.each(b,function(b,d){var e=Livepress.Ui.ReactButton(d,a);c.append(e)}),c},function(){var a=function(){var a=!1;this.settings_enabled=!1,jQuery("input:text, textarea").on("focusin",function(){a=!0}).on("focusout",function(){a=!1}),this.shouldScroll=function(){return this.settings_enabled&&!a}};Livepress.Scroll=new a}(),Livepress.DOMManipulator=function(a,b){this.custom_background_color=b,this.containerJQueryElement="string"==typeof a?jQuery(a):a,this.containerElement=this.containerJQueryElement[0],this.cleaned_ws=!1},Livepress.DOMManipulator.prototype={debug:!1,log:function(){this.debug&&console.log.apply(console,arguments)},update:function(a,b){b=b||{},this.log("Livepress.DOMManipulator.update begin."),this.clean_updates(),this.apply_changes(a,b);var c=this;setTimeout(function(){c.clean_updates()},1500),this.log("Livepress.DOMManipulator.update end.")},selector:function(a){return this.containerJQueryElement.find(a)},selectors:function(){if(0===arguments.length)throw"The method expects arguments.";var a=jQuery.map(arguments,function(a){return a});return this.containerJQueryElement.find(a.join(","))},clean_whitespaces:function(){},block_elements:function(){return{address:1,blockquote:1,center:1,dir:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,noscript:1,ol:1,p:1,pre:1,table:1,ul:1,div:1,math:1,caption:1,colgroup:1,col:1,dd:1,dt:1,frameset:1,li:1,tbody:1,td:1,thead:1,tfoot:1,th:1,tr:1}},is_block_element:function(a){return"string"==typeof a?this.block_elements().hasOwnProperty(a.toLowerCase()):!1},remove_whitespace:function(a){var b,c=!1,d=a.parentNode;return a===d.firstChild||a===d.lastChild?c=!0:(b=a.previousSibling,null!==b&&1===b.nodeType&&this.is_block_element(b.tagName)&&(c=!0)),c},clean_children_ws:function(a){var b,c;for(b=!1,c=a.firstChild;null!==c;null)if(3===c.nodeType?/^\s*$/.test(c.nodeValue)&&this.remove_whitespace(c)&&(b=!0):this.clean_children_ws(c),b){var d=c;c=c.nextSibling,a.removeChild(d),b=!1}else c=c.nextSibling},clean_updates:function(){this.log("DOMManipulator clean_updates."),jQuery.each(this.selector("span.oortle-diff-text-updated"),function(){var a;a=this.childNodes.length>1?this.childNodes[1]:this.childNodes[0],8!==a.nodeType&&(a=a.childNodes[0]),this.parentNode.replaceChild(a,this)}),this.selector(".oortle-diff-changed").removeClass("oortle-diff-changed"),this.selector(".oortle-diff-inserted").removeClass("oortle-diff-inserted"),this.selector(".oortle-diff-inserted-block").removeClass("oortle-diff-inserted-block"),this.selector(".oortle-diff-removed").remove(),this.selector(".oortle-diff-removed-block").remove()},process_twitter:function(a,b){if(b.match(/<blockquote[^>]*twitter-tweet/i))if("twttr"in window)try{window.twttr.events.bind("loaded",function(){jQuery(document).trigger("live_post_update")}),console.log("loading twitter"),window.twttr.widgets.load(a)}catch(c){}else try{if(!document.getElementById("twitter-wjs")){var d=document.createElement("script");d.src="https://platform.twitter.com/widgets.js",d.id="twitter-wjs",document.getElementsByTagName("head")[0].appendChild(d)}}catch(c){}},apply_changes:function(a,b){var c,d=jQuery,e=b.effects_display||!1,f=[];for(this.clean_whitespaces(),c=0;c<a.length;c++){this.log("apply changes i=",c," changes.length = ",a.length);var g=a[c];this.log("change[i] = ",g[c]);var h,i,j,k,l,m,n,o,p,q,r;switch(g[0]){case"add_class":try{h=this.get_path_parts(g[1]),i=this.node_at_path(h),this.add_class(i,g[2])}catch(s){this.log("Exception on add_class: ",s)}break;case"set_attr":try{h=this.get_path_parts(g[1]),i=this.node_at_path(h),this.set_attr(i,g[2],g[3])}catch(t){this.log("Exception on set_attr: ",t)}break;case"del_attr":try{h=this.get_path_parts(g[1]),i=this.node_at_path(h),this.del_attr(i,g[2])}catch(u){this.log("Exception on del_attr: ",u)}break;case"set_text":try{this.set_text(g[1],g[2])}catch(v){this.log("Exception on set_text: ",v)}break;case"del_node":try{if(h=this.get_path_parts(g[1]),i=this.node_at_path(h),3===i.nodeType){for(j=i.parentNode,q=0;q<j.childNodes.length;q++)if(j.childNodes[q]===i){k=j.ownerDocument.createElement("span"),k.appendChild(i),k.className="oortle-diff-removed";break}q<j.childNodes.length?j.insertBefore(k,j.childNodes[q]):j.appendChild(k)}else 8===i.nodeType?i.parentNode.removeChild(i):this.add_class(i,"oortle-diff-removed")}catch(w){this.log("Exception on del_node: ",w)}break;case"push_node":try{if(h=this.get_path_parts(g[1]),i=this.node_at_path(h),null!==i){var x=i.parentNode;this.log("push_node: parentNode = ",x,", node = ",i),f[g[2]]=x.removeChild(i),d(f[g[2]]).addClass("oortle-diff-inserted")}}catch(y){this.log("Exception on push_node: ",y)}break;case"pop_node":try{h=this.get_path_parts(g[1]),l=this.get_child_index(h),j=this.node_at_path(this.get_parent_path(h)),l>-1&&null!==j&&(m=f[g[2]],n=j.childNodes.length<=l?null:j.childNodes[l],this.log("pop_node",m,"from register",g[2],"before element",n,"on index ",l," on parent ",j),r=j.insertBefore(m,n),d(r).addClass("oortle-diff-inserted"))}catch(z){this.log("Exception on pop_node: ",z)}break;case"ins_node":try{if(h=this.get_path_parts(g[1]),l=this.get_child_index(h),o=this.get_parent_path(h),j=this.node_at_path(o),this.log("ins_node: childIndex = ",l,", parent = ",j),l>-1&&null!==j&&(m=document.createElement("span"),m.innerHTML=g[2],p=m.childNodes[0],""===p.id||null===document.getElementById(p.id))){this.process_twitter(p,g[2]),n=j.childNodes.length<=l?null:j.childNodes[l],r=j.insertBefore(p,n);var A=d(r);A.addClass("oortle-diff-inserted");var B=d(p).find("div.live-update-livetags");"undefined"!=typeof B&&0!==B.length&&this.addLiveTagsToUpdate(A,B),this.filterUpdate(A,B)}}catch(C){this.log("Exception on ins_node: ",C)}break;case"append_child":try{o=this.get_path_parts(g[1]),j=this.node_at_path(o),null!==j&&(m=document.createElement("span"),m.innerHTML=g[2],p=m.childNodes[0],""!==p.id&&null!==document.getElementById(p.id)&&(this.process_twitter(p,g[2]),r=j.appendChild(p),d(r).addClass("oortle-diff-inserted")))}catch(C){this.log("Exception on append_child: ",C)}break;case"replace_node":try{h=this.get_path_parts(g[1]),i=this.node_at_path(h),j=i.parentNode,m=document.createElement("span"),m.innerHTML=g[2],p=m.childNodes[0];var D=d(p).data("lpg");if(""!==D&&null!==D&&D<=d(i).data("lpg"));else if(this.process_twitter(p,g[2]),this.add_class(p,"oortle-diff-changed"),d(i).hasClass("pinned-first-live-update")&&(this.add_class(p,"pinned-first-live-update"),setTimeout(this.scrollToPinnedHeader,500)),j.insertBefore(p,i),3===i.nodeType){for(q=0;q<j.childNodes.length;q++)if(j.childNodes[q]===i){k=j.ownerDocument.createElement("span"),k.appendChild(i),k.className="oortle-diff-removed";break}q<j.childNodes.length?j.insertBefore(k,j.childNodes[q]):j.appendChild(k)}else 8===i.nodeType?i.parentNode.removeChild(i):this.add_class(i,"oortle-diff-removed")}catch(C){this.log("Exception on append_child: ",C)}break;default:throw this.log("Operation not implemented yet."),"Operation not implemented yet."}this.log("i=",c," container: ",this.containerElement.childNodes," -- registers: ",f)}try{this.display(e)}catch(E){this.log("Exception on display: ",E)}try{if(Livepress.Scroll.shouldScroll()){var F=void 0===b.custom_scroll_class?".oortle-diff-inserted-block, .oortle-diff-changed, .oortle-diff-inserted":b.custom_scroll_class;jQuery.scrollTo(F,900,{axis:"y",offset:-30})}}catch(G){this.log("Exception on scroll ",G)}this.log("end apply_changes.")},scrollToPinnedHeader:function(){Livepress.Scroll.shouldScroll()&&jQuery.scrollTo(".pinned-first-live-update",900,{axis:"y",offset:-30})},filterUpdate:function(a,b){var c,d,e=jQuery(".live-update-tag-control"),f=e.find(".live-update-tagcontrol.active");if(0!==f.length&&0===b.length)return void a.hide().removeClass("oortle-diff-inserted");if(0!==f.length){var g=!1,h=b.find(".live-update-livetag");
jQuery.each(h,function(a,b){console.log(b)}),jQuery.each(h,function(a,b){c=jQuery(b).attr("class"),c=c.replace(/live-update-livetag live-update-livetag-/gi,""),c="live-update-livetag-"+c.toLowerCase().replace(/ /g,"-"),c='.live-update-tagcontrol.active[data-tagclass="'+c+'"]',d=e.find(c),0!==d.length&&(g=!0)}),g||a.hide().removeClass("oortle-diff-inserted")}},addLiveTagsToUpdate:function(a,b){var c,d=this,e=jQuery("#livepress"),f=b.find(".live-update-livetag"),g=(b.parent().parent(),e.find(".live-update-tag-control"));0===g.length&&this.addLiveTagControlBar(),f.each(function(){var b=jQuery(this).attr("class");b=b.replace(/live-update-livetag live-update-livetag-/gi,""),c="live-update-livetag-"+b.toLowerCase().replace(/ /g,"-"),a.addClass(c),d.addLiveTagToControls(b)})},addLiveTagToControls:function(a){var b,c=jQuery("#livepress"),d=c.find(".live-update-tag-control"),e=d.find('[data-tagclass="live-update-livetag-'+a.toLowerCase().replace(/ /g,"-")+'"]');0===e.length&&(b='<span class="live-update-tagcontrol" data-tagclass="live-update-livetag-'+a.toLowerCase().replace(/ /g,"-")+'">'+a+"</span>",d.append(b))},addLiveTagControlBar:function(){var a=jQuery("#livepress"),b=a.find(".live-update-tag-control");a.append('<div class="live-update-tag-control"><span class="live-update-tag-title">'+lp_client_strings.filter_by_tag+"</span></div>"),b=a.find(".live-update-tag-control"),this.addLiveTagHandlers(b)},addLiveTagHandlers:function(a){var b=this,c=jQuery(".livepress_content");a.on("click",".live-update-tagcontrol",function(){var d=jQuery(this);d.toggleClass("active"),b.filterUpdateListbyLiveTag(a,c)})},filterUpdateListbyLiveTag:function(a,b){var c,d=a.find(".live-update-tagcontrol.active");return 0===d.length?void b.find(".livepress-update").show():(b.find(".livepress-update").hide(),void jQuery.each(d,function(a,d){c="."+jQuery(d).data("tagclass"),b.find(c).show()}))},colorForOperation:function(a){if(0===a.length)return!1;var b={"oortle-diff-inserted":LivepressConfig.oortle_diff_inserted,"oortle-diff-changed":LivepressConfig.oortle_diff_changed,"oortle-diff-inserted-block":LivepressConfig.oortle_diff_inserted_block,"oortle-diff-removed-block":LivepressConfig.oortle_diff_removed_block,"oortle-diff-removed":LivepressConfig.oortle_diff_removed},c="#fff";return jQuery.each(b,function(b,d){return a.hasClass(b)?(c=d,!1):void 0}),c},show:function(a){var b=jQuery(a);!LivepressConfig.page_active&&LivepressConfig.effects&&(b.getBg(),b.data("oldbg",b.css("background-color")),b.addClass("unfocused-lp-update"),b.css("background-color",this.colorForOperation(b))),b.show()},sliderFixed:function(a,b){var c=jQuery,d={slideType:"down",duration:250};b=c.extend({},d,b);var e="down"===b.slideType,f=c(a),g=f.data("originalHeight"),h=f.is(":visible"),i=f.data("originalStyle");return 1===arguments.length&&(e=!h),e===h?!1:(g&&i||(g=f.show().height(),i=f.attr("style"),f.data("originalStyle",i),f.data("originalHeight",g),h||f.hide()),void(e?f.show().animate({height:g},{duration:b.duration,complete:function(){f.css({height:f.data("originalHeight")}),f.attr("style",f.data("originalStyle")),f.show()}}):f.animate({height:0},{duration:b.duration,complete:function(){f.hide()}})))},show_with_effects:function(a,b){"string"===this.custom_background_color&&a.css("background-color",this.custom_background_color),a.getBg(),b(a,a.css("background-color"))},display:function(a){if(a){var b=this.selector(".oortle-diff-inserted-block");b.hide().css("height","");var c=this,d=function(a,b){c.sliderFixed(a,"down"),a.animate({backgroundColor:c.colorForOperation(a)},200).animate({backgroundColor:b},800),setTimeout(function(){a.css("background-color","")},1500)};b.each(function(a,b){c.show_with_effects(jQuery(b),d)}),this.show_with_effects(this.selectors(".oortle-diff-inserted",".oortle-diff-changed"),function(a,b){a.slideDown(200);try{a.animate({backgroundColor:c.colorForOperation(a)},200).animate({backgroundColor:b},800)}catch(d){console.log("Error when animating new comment div.")}setTimeout(function(){a.css("background-color","")},1500)}),this.show_with_effects(this.selectors(".oortle-diff-removed-block",".oortle-diff-removed"),function(a,b){try{a.animate({backgroundColor:c.colorForOperation(a)},200).animate({backgroundColor:b},800).slideUp(200)}catch(d){console.log("Error when removing comment div.")}setTimeout(function(){a.css("background-color","")},1500)})}else this.show(this.selectors(".oortle-diff-changed",".oortle-diff-inserted",".oortle-diff-removed")),this.show(this.selector(".oortle-diff-inserted-block"))},set_text:function(a,b){var c=this.get_path_parts(a),d=this.get_child_index(c),e=this.node_at_path(this.get_parent_path(c));if(d>-1&&null!==e){for(var f=e.childNodes[d],g=jQuery(b),h=0,i=g.length;i>h;h++)e.insertBefore(g[h],f);e.removeChild(f)}},get_path_parts:function(a){if("#"===a[0]){var b=jQuery(a,this.containerElement)[0];return b?[b.parentNode,b]:[null,null]}for(var c=a.split(":"),d=[],e=0,f=c.length;f>e;e++)d[e]=parseInt(c[e],10);return d},get_child_index:function(a){return a.length>0?parseInt(a[a.length-1],10):-1},get_parent_path:function(a){var b=a.slice();return b.splice(-1,1),b},node_at_path:function(a){return void 0===a[0].nodeType?this.get_node_by_path(this.containerElement,a):a[a.length-1]},get_node_by_path:function(a,b){var c=b.slice();if(c.splice(0,1),0===c.length)return a;for(var d=0,e=a,f=null,g=c.length;g>d&&(e=e.childNodes[c[d]],"undefined"!=typeof e);d++);return d===c.length&&(f=e),f},add_class:function(a,b){null!==a&&(a.className+=" "+b)},set_attr:function(a,b,c){null!==a&&a.setAttribute(b,c)},del_attr:function(a,b){null!==a&&a.removeAttribute(b)}},Livepress.DOMManipulator.clean_updates=function(a){var b=new Livepress.DOMManipulator(a);b.clean_updates()},function(){if(!window.google||!google.gears){var a=null;if("undefined"!=typeof GearsFactory)a=new GearsFactory;else try{"undefined"!=typeof window.ActiveXObject&&(a=new ActiveXObject("Gears.Factory"),-1!=a.getBuildInfo().indexOf("ie_mobile")&&a.privateSetGlobalObject(this))}catch(b){"undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes["application/x-googlegears"]&&(a=document.createElement("object"),a.style.display="none",a.width=0,a.height=0,a.type="application/x-googlegears",document.documentElement.appendChild(a))}a&&(window.google||(google={}),google.gears||(google.gears={factory:a}))}}();var internalStorage=function(){var a={expires:30,get:function(a){return jQuery.cookie(a)},set:function(a,b){return jQuery.cookie(a,b,{path:"/",expires:this.expires})},remove:function(a){return jQuery.cookie(a,null)}},b=a;try{"localStorage"in window&&null!==window.localStorage&&(b=window.localStorage)}catch(c){}return function(a){return a||(a=""),{get:function(c){return b.getItem(a+"-"+c)},set:function(c,d){return b.setItem(a+"-"+c,d)},remove:function(c){return b.remoteItem(a+"-"+c)}}}}();Livepress.storage=function(){var a=new internalStorage("Livepress");return{get:function(b,c){var d=a.get(b);return null===d||"undefined"==typeof d?c:d},set:function(b,c){return a.set(b,c)}}}(),Livepress.Ui.Controller=function(a,b){function c(){void 0!==t&&t.connected()}function d(a){console.log("Comet error: ",a)}function e(a){return"object"==typeof b&&"function"==typeof b[a]?b[a].apply(this,Array.prototype.slice.call(arguments,1)):void 0}function f(){setTimeout(function(){C.is_connected()?t.connected():t.disconnected()},1500)}function g(b,c,d){if(a.comment_msg_id!==d){e("before_live_comment",b);var g=e("should_attach_comment",a);if(g=void 0===g?!0:g){var h=e("on_comment_update",b,r);void 0===h&&r.update(b.diff)}if(f(),e("post_comment_update"),D.play(0===w?"firstComment":"commentAdded"),w+=1,b.comment_id){var i=e("get_comment_container",b.comment_id);if(void 0===i)for(var j=0;j<b.diff.length;j+=1)if("ins_node"===b.diff[j][0]&&b.diff[j][2].indexOf(b.content)>=0){i=jQuery(b.diff[j][2]).attr("id");break}var k;k=0===jQuery(b.avatar_url).length?b.avatar_url:jQuery(b.avatar_url).attr("src");var l={title:b.author,text:b.content,commentContainerId:i,image:k};g||(l.scrollToText=lp_client_strings.refresh_page,l.scrollToCallback=function(){location.reload()}),t.comment_alert(l,b.comment_gmt)}t.set_comment_num(w)}}function h(){var b=jQuery(document.querySelectorAll("#post_content_livepress .livepress-update")).not(".oortle-diff-removed");t.set_live_updates_num(b.length);var c=window.location.href.replace(window.location.hash,"");z&&b.addClass("lp-hl-on-hover"),b.each(function(){var b=jQuery(this);return b.is(".lp-live")||(b.addClass("lp-live"),"dont_display"===LivepressConfig.sharing_ui)?void 0:new Livepress.Ui.UpdateView(b,c,a.disable_comments)})}function i(a){"undefined"!=typeof FB&&FB.XFBML.parse();var b=/id\=\"(livepress-update-[0-9]+)/,c=b.exec(a[0][2])[1];j(c)}function j(a){var b={};"undefined"!=typeof _wpmejsSettings&&(b.pluginPath=_wpmejsSettings.pluginPath),b.success=function(a){var b=a.attributes.autoplay&&"false"!==a.attributes.autoplay;"flash"===a.pluginType&&b&&a.addEventListener("canplay",function(){a.play()},!1)};var c=["#",a," .wp-audio-shortcode, ","#",a," .wp-video-shortcode"].join("");jQuery(c).not(".mejs-container").mediaelementplayer(b)}function k(a){if(!window.is_active){var b=!1;if(jQuery.each(a,function(a,c){b="ins_node"===c[0]}),b){var c=jQuery("title"),d=c.data("updates");d+=1,c.data("updates",d),c.text("("+d+") "+c.data("text"))}}}function l(b){if(f(),2===b.length){var c,d=b[0],e=b[1];c="string"==typeof a.custom_title_css_selector?a.custom_title_css_selector:"#post-"+a.post_id;var g=jQuery(c),h=g.html().replaceAll(d,e);g.html(h);var i=document.title.replace(d,e);document.title=i}else console.log("error -- received data about post = "+b)}function m(a){var b=new Date,c=b.toISOString(),d='<abbr class="livepress-timestamp" title="'+c+'"></abbr>';if(console.log("post_update with data = ",a),"op"in a&&"broadcast"===a.op){var e=JSON.parse(a.data);return void("shortlink"in e&&jQuery.each(e.shortlink,function(a,b){Livepress.updateShortlinksCache[a]=b}))}if("event"in a&&"post_title"===a.event)return l(a.data);var g=a.pop();if(k(a),B){if(A.push(a),"undefined"!=typeof s)for(var j=g.updated_at,m=0;m<g.post_updates.length;m+=1)s.post_update(g.post_updates[m],j)}else q.update(a,{effects_display:window.is_active}),h();f(),i(a),D.play("postUpdated"),v.find(".lp-updated-counter").html(d),v.find(".lp-updated-counter").find(".livepress-timestamp").attr("title",c),v.find(".lp-bar .lp-status").removeClass("lp-off").addClass("lp-on");var n=jQuery("abbr.livepress-timestamp").eq(1),o=n.closest(".livepress-update").attr("id");"timeago"===LivepressConfig.timestamp_format?n.timeago().attr("title",""):(jQuery(".lp-bar abbr.livepress-timestamp").timeago(),jQuery("abbr.livepress-timestamp").attr("title","")),n.wrap('<a href="'+Livepress.getUpdatePermalink(o)+'" ></a>'),jQuery(document).trigger("live_post_update")}function n(b,c,d){a.new_post_msg_id!==d&&(s.new_post(b.title,b.link,b.author,b.updated_at_gmt),D.play("postUpdated"))}function o(b,c){if(!E&&0!==b.length&&"username"!==b){E=!0,t.imFeedbackSpin(!0);var d={action:"new_im_follower",user_name:b,im_type:c,post_id:a.post_id};jQuery.post(a.ajax_url,d,function(a){t.handleImFeedback(a,b),E=!1})}}function p(){console.log("bindPageActivity");var a=function(){var a=jQuery(".unfocused-lp-update"),b=a.data("oldbg")||"#FFF";a.animate({backgroundColor:b},4e3,"swing",function(){jQuery(this).removeClass("unfocused-lp-update").css("background-color","")})},b=jQuery("title");b.data("text",b.text()),b.data("updates",0),u.focus(function(){this.is_active=!0,b.text(b.data("text")),b.data("updates",0),a()}),u.blur(function(){this.is_active=!1});var c=jQuery("#post_content_livepress"),d=c.data("livetags");if(console.log(d),""!==d){q.addLiveTagControlBar();var e=d.split(",");e.map(function(a){q.addLiveTagToControls(a)})}jQuery(document).trigger("live_post_update")}var q,r,s,t,u=jQuery(window),v=jQuery(document.getElementById("livepress")),w=a.comment_count,x=a.page_type,y="home"===x,z="single"===x,A=[],B=!1,C=OORTLE.instance,D=Livepress.sounds,E=!1;if(window.is_active=!0,u.ready(p),null!==document.getElementById("lp-update-box")&&(s=new Livepress.Ui.UpdateBoxView(y)),null!==document.getElementById("livepress")){t=new Livepress.Ui.View(a.disable_comments),t.set_comment_num(w),h();var F=encodeURIComponent(a.feed_sub_link),G=encodeURIComponent(a.feed_title);t.add_link_to_greader("http://www.google.com/ig/addtoreader?et=gEs490VY&source=ign_pLt&feedurl="+F+"&feedtitle="+G)}if(void 0!==s||void 0!==t){var H="#livepress-connection";jQuery(document.body).append('<div id="'+H+'"><!-- --></div>');var I="|livepress|"+a.site_url+"|post-new-update";if(C.attachEvent("connected",c),C.attachEvent("error",d),void 0!==s&&y){var J=a.new_post_msg_id?{last_id:a.new_post_msg_id}:{fetch_all:!0};C.subscribe(I,n,J),C.connect()}if(void 0!==t){C.attachEvent("reconnected",t.connected),C.attachEvent("disconnected",t.disconnected);var K="|livepress|"+a.site_url+"|post-"+a.post_id,L="|livepress|"+a.site_url+"|post-"+a.post_id+"_comment";a.can_edit_comments&&(L+="-logged"),q=new Livepress.DOMManipulator("#post_content_livepress",a.custom_background_color),r=new Livepress.DOMManipulator("#post_comments_livepress",a.custom_background_color);var M=a.new_post_msg_id?{last_id:a.new_post_msg_id}:{fetch_all:!0};!a.disable_comments&&a.comment_live_updates_default&&(M=a.comment_msg_id?{last_id:a.comment_msg_id}:{fetch_all:!0},C.subscribe(L,function(){},M)),M=a.post_update_msg_id?{last_id:a.post_update_msg_id}:{fetch_all:!0},C.subscribe(K,m,M),t.subscribeIm(o),t.live_control(Livepress.storage.get("settings-live",!0),function(a){C.connect(),a&&Livepress.storage.set("settings-live","1")},function(a){C.disconnect(),a&&Livepress.storage.set("settings-live","")}),a.disable_comments||t.follow_comments_control(Livepress.storage.get("settings-comments",!0),function(a){C.subscribe(L,g),a&&Livepress.storage.set("settings-comments","1")},function(a){C.unsubscribe(L,g),a&&Livepress.storage.set("settings-comments","")}),t.scroll_control(Livepress.storage.get("settings-scroll",void 0===a.autoscroll||a.autoscroll),function(a){Livepress.Scroll.settings_enabled=!0,a&&Livepress.storage.set("settings-scroll","1")},function(a){Livepress.Scroll.settings_enabled=!1,a&&Livepress.storage.set("settings-scroll","")})}}},jQuery(function(){Livepress.Comment=function(){var a=!1,b=function(a){var b=jQuery("#oortle-comment-status");0===b.length&&(jQuery("#submit").after("<span id='oortle-comment-status'></span>"),b=jQuery("#oortle-comment-status")),b.text(a)},c=function(a){var b=jQuery("#comment");b.attr("disabled",!1),a&&(b.val(""),jQuery("#cancel-comment-reply-link").click())},d=function(){try{if(a)return!1;a=!0;var d=jQuery("#submit"),e=d.attr("value");d.attr("value",lp_client_strings.sending+"..."),d.attr("disabled",!0),jQuery("textarea#comment").attr("disabled",!0),b("");var f={},g=document.getElementById("commentform")||document.getElementById("comment-form");f.comment_post_ID=g.comment_post_ID.value,"undefined"!=typeof g.comment_parent&&(f.comment_parent=g.comment_parent.value),f.comment=g.comment.value,g.comment.value="",f.author=g.elements[0].value,f.email=g.elements[1].value,f.url=g.elements[2].value,f._wp_unfiltered_html_comment=void 0!==g._wp_unfiltered_html_comment?g._wp_unfiltered_html_comment.value:"",f.redirect_to="",f.livepress_update="true",f.action="lp_post_comment",f._ajax_nonce=LivepressConfig.ajax_comment_nonce,Livepress.sounds.play("commented"),jQuery.ajax({url:LivepressConfig.site_url+"/wp-admin/admin-ajax.php",type:"post",dataType:"json",data:f,error:function(a,d){console.log("comment response: "+a.status+" :: "+a.statusText),console.log("comment ajax failed: %s",d),b(lp_client_strings.comment_status+": "+a.responseText),c(!1)},success:function(a){b(lp_client_strings.comment_status+": "+a.msg),c("200"===a.code)},complete:function(){d=jQuery("#submit"),a=!1,d.attr("value",e),d.attr("disabled",!1)}})}catch(h){console.log("EXCEPTION: %s",h),b(lp_client_strings.sending_error)}return!1},e=function(){jQuery("#submit").click(d)},f=function(a){var b=jQuery("#comment");a.ajax_nonce===LivepressConfig.ajax_nonce&&b.val()===a.content&&c(!0)},g=function(a){var b=a.comment_page_number;return"asc"===a.comment_order?0===b||b===a.comment_pages_count:1>=b},h=function(a){return jQuery("#comment-"+a).parent().attr("id")},i=function(a,b){var c={custom_scroll_class:"#comment-"+a.comment_id};if("0"===a.comment_parent)b.update(a.diff,c);else{b.update(a.comments_counter_only_diff,c);var d=jQuery(a.comment_html);d.addClass("oortle-diff-inserted-block").hide();var e=jQuery("#comment-"+a.comment_parent),f=e.children(".children");0===f.length&&(f=jQuery("<ul>").addClass("children").appendTo(e)),f.append(d),b.display(!0)}return!0};return LivepressConfig.disable_comments||e(),{send:d,attach:e,before_live_comment:f,should_attach_comment:g,get_comment_container:h,on_comment_update:i}}()}),void 0!==jQuery&&(jQuery.ajax=function(a){return function(){return void 0!==OORTLE&&void 0!==OORTLE.instance&&OORTLE.instance&&OORTLE.instance.flush(),a.apply(this,arguments)}}(jQuery.ajax));var unow=Date.now||function(){return(new Date).getTime()},throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:unow(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=unow();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}};Livepress.Ready=function(){var a,b,c,d,e,f,g={post_comment_update:Livepress.Comment.attach,before_live_comment:Livepress.Comment.before_live_comment,should_attach_comment:Livepress.Comment.should_attach_comment,get_comment_container:Livepress.Comment.get_comment_container,on_comment_update:Livepress.Comment.on_comment_update};if(jQuery.each(jQuery(".livepress-update"),function(){var a=jQuery(this).find("abbr.livepress-timestamp");a.wrap('<a href="'+Livepress.getUpdatePermalink(jQuery(this).attr("id"))+'" ></a>'),console.log(LivepressConfig.update_format),"timeago"===LivepressConfig.timestamp_format?jQuery("abbr.livepress-timestamp").timeago().attr("title",""):(jQuery(".lp-bar abbr.livepress-timestamp").timeago(),jQuery("abbr.livepress-timestamp").attr("title",""))}),jQuery(".lp-status").hasClass("livepress-pinned-header")){jQuery(".livepress_content").find(".livepress-update:first").addClass("pinned-first-live-update");var h=function(){window.console.log("adjust top"),a=jQuery(".livepress_content"),b=a.find(".pinned-first-live-update"),b.detach().prependTo(a),e=a.parent(),b.css("marginTop",0),c=jQuery("#livepress"),c.css("marginTop",0),f=b.offset().top-e.offset().top,d=b.outerHeight()+20,b.css({"margin-top":"-"+(f+d)+"px",position:"absolute",width:c.outerWidth()+"px"}),c.css({"margin-top":d+"px"})};h(),jQuery(document).on("live_post_update",function(){console.log("live_post_update triggered"),setTimeout(h,50)}),jQuery(window).on("resize",throttle(function(){h()},500))}return new Livepress.Ui.Controller(LivepressConfig,g)},jQuery.effects||function(a,b){function c(b){var c;return b&&b.constructor==Array&&3==b.length?b:(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))?[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]:(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))?[2.55*parseFloat(c[1]),2.55*parseFloat(c[2]),2.55*parseFloat(c[3])]:(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))?[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]:(c=/rgba\(0, 0, 0, 0\)/.exec(b))?j.transparent:j[a.trim(b).toLowerCase()]}function d(b,d){var e;do{if(e=(a.curCSS||a.css)(b,d),""!=e&&"transparent"!=e||a.nodeName(b,"body"))break;d="backgroundColor"}while(b=b.parentNode);return c(e)}function e(){var a,b,c=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,d={};if(c&&c.length&&c[0]&&c[c[0]])for(var e=c.length;e--;)a=c[e],"string"==typeof c[a]&&(b=a.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),d[b]=c[a]);else for(a in c)"string"==typeof c[a]&&(d[a]=c[a]);return d}function f(b){var c,d;for(c in b)d=b[c],(null==d||a.isFunction(d)||c in l||/scrollbar/.test(c)||!/color/i.test(c)&&isNaN(parseFloat(d)))&&delete b[c];return b}function g(a,b){var c,d={_:0};for(c in b)a[c]!=b[c]&&(d[c]=b[c]);return d}function h(b,c,d,e){return"object"==typeof b&&(e=c,d=null,c=b,b=c.effect),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c=c||{},d=d||c.duration,d=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,e=e||c.complete,[b,c,d,e]}function i(b){return!b||"number"==typeof b||a.fx.speeds[b]?!0:"string"!=typeof b||a.effects[b]?!1:!0}a.effects={},a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(b,e){a.fx.step[e]=function(a){a.colorInit||(a.start=d(a.elem,e),a.end=c(a.end),a.colorInit=!0),a.elem.style[e]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var j={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},k=["add","remove","toggle"],l={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.effects.animateClass=function(b,c,d,h){return a.isFunction(d)&&(h=d,d=null),this.queue(function(){var i,j=a(this),l=j.attr("style")||" ",m=f(e.call(this)),n=j.attr("class")||"";a.each(k,function(a,c){b[c]&&j[c+"Class"](b[c])}),i=f(e.call(this)),j.attr("class",n),j.animate(g(m,i),{queue:!1,duration:c,easing:d,complete:function(){a.each(k,function(a,c){b[c]&&j[c+"Class"](b[c])}),"object"==typeof j.attr("style")?(j.attr("style").cssText="",j.attr("style").cssText=l):j.attr("style",l),h&&h.apply(this,arguments),a.dequeue(this)}})})},a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{add:b},c,d,e]):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{remove:b},c,d,e]):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,g){return"boolean"==typeof d||d===b?e?a.effects.animateClass.apply(this,[d?{add:c}:{remove:c},e,f,g]):this._toggleClass(c,d):a.effects.animateClass.apply(this,[{toggle:c},d,e,f])},switchClass:function(b,c,d,e,f){return a.effects.animateClass.apply(this,[{add:c,remove:b},d,e,f])}}),a.extend(a.effects,{version:"1.8.24",save:function(a,b){for(var c=0;c<b.length;c++)null!==b[c]&&a.data("ec.storage."+b[c],a[0].style[b[c]])},restore:function(a,b){for(var c=0;c<b.length;c++)null!==b[c]&&a.css(b[c],a.data("ec.storage."+b[c]))},setMode:function(a,b){return"toggle"==b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e=document.activeElement;try{e.id}catch(f){e=document.body}return b.wrap(d),(b[0]===e||a.contains(b[0],e))&&a(e).focus(),d=b.parent(),"static"==b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),d.css(c).show()},removeWrapper:function(b){var c,d=document.activeElement;return b.parent().is(".ui-effects-wrapper")?(c=b.parent().replaceWith(b),(b[0]===d||a.contains(b[0],d))&&a(d).focus(),c):b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(b){var c=h.apply(this,arguments),d={options:c[1],duration:c[2],callback:c[3]},e=d.options.mode,f=a.effects[b];return a.fx.off||!f?e?this[e](d.duration,d.callback):this.each(function(){d.callback&&d.callback.call(this)}):f.call(this,d)},_show:a.fn.show,show:function(a){if(i(a))return this._show.apply(this,arguments);var b=h.apply(this,arguments);return b[1].mode="show",this.effect.apply(this,b)},_hide:a.fn.hide,hide:function(a){if(i(a))return this._hide.apply(this,arguments);var b=h.apply(this,arguments);return b[1].mode="hide",this.effect.apply(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(i(b)||"boolean"==typeof b||a.isFunction(b))return this.__toggle.apply(this,arguments);var c=h.apply(this,arguments);return c[1].mode="toggle",this.effect.apply(this,c)},cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}});var m={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,b){m[b]=function(b){return Math.pow(b,a+2)}}),a.extend(m,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(m,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:c(-2*a+2)/-2+1}}),a.effects.blind=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.direction||"vertical";a.effects.save(c,d),c.show();var g=a.effects.createWrapper(c).css({overflow:"hidden"}),h="vertical"==f?"height":"width",i="vertical"==f?g.height():g.width();"show"==e&&g.css(h,0);var j={};j[h]="show"==e?i:0,g.animate(j,b.duration,b.options.easing,function(){"hide"==e&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}}(jQuery),this.createjs=this.createjs||{},function(){var a=createjs.SoundJS=createjs.SoundJS||{};a.version="0.5.2",a.buildDate="Thu, 12 Dec 2013 23:33:37 GMT"}(),this.createjs=this.createjs||{},function(){"use strict";var a=function(){},b=a.prototype;a.initialize=function(a){a.addEventListener=b.addEventListener,a.on=b.on,a.removeEventListener=a.off=b.removeEventListener,a.removeAllEventListeners=b.removeAllEventListeners,a.hasEventListener=b.hasEventListener,a.dispatchEvent=b.dispatchEvent,a._dispatchEvent=b._dispatchEvent,a.willTrigger=b.willTrigger},b._listeners=null,b._captureListeners=null,b.initialize=function(){},b.addEventListener=function(a,b,c){var d;d=c?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var e=d[a];return e&&this.removeEventListener(a,b,c),e=d[a],e?e.push(b):d[a]=[b],b},b.on=function(a,b,c,d,e,f){return b.handleEvent&&(c=c||b,b=b.handleEvent),c=c||this,this.addEventListener(a,function(a){b.call(c,a,e),d&&a.remove()},f)},b.removeEventListener=function(a,b,c){var d=c?this._captureListeners:this._listeners;if(d){var e=d[a];if(e)for(var f=0,g=e.length;g>f;f++)if(e[f]==b){1==g?delete d[a]:e.splice(f,1);break}}},b.off=b.removeEventListener,b.removeAllEventListeners=function(a){a?(this._listeners&&delete this._listeners[a],this._captureListeners&&delete this._captureListeners[a]):this._listeners=this._captureListeners=null},b.dispatchEvent=function(a,b){if("string"==typeof a){var c=this._listeners;if(!c||!c[a])return!1;a=new createjs.Event(a)}if(a.target=b||this,a.bubbles&&this.parent){for(var d=this,e=[d];d.parent;)e.push(d=d.parent);var f,g=e.length;for(f=g-1;f>=0&&!a.propagationStopped;f--)e[f]._dispatchEvent(a,1+(0==f));for(f=1;g>f&&!a.propagationStopped;f++)e[f]._dispatchEvent(a,3)}else this._dispatchEvent(a,2);return a.defaultPrevented},b.hasEventListener=function(a){var b=this._listeners,c=this._captureListeners;return!!(b&&b[a]||c&&c[a])},b.willTrigger=function(a){for(var b=this;b;){if(b.hasEventListener(a))return!0;b=b.parent}return!1},b.toString=function(){return"[EventDispatcher]"},b._dispatchEvent=function(a,b){var c,d=1==b?this._captureListeners:this._listeners;if(a&&d){var e=d[a.type];if(!e||!(c=e.length))return;a.currentTarget=this,a.eventPhase=b,a.removed=!1,e=e.slice();for(var f=0;c>f&&!a.immediatePropagationStopped;f++){var g=e[f];g.handleEvent?g.handleEvent(a):g(a),a.removed&&(this.off(a.type,g,1==b),a.removed=!1)}}},createjs.EventDispatcher=a}(),this.createjs=this.createjs||{},function(){"use strict";var a=function(a,b,c){this.initialize(a,b,c)},b=a.prototype;b.type=null,b.target=null,b.currentTarget=null,b.eventPhase=0,b.bubbles=!1,b.cancelable=!1,b.timeStamp=0,b.defaultPrevented=!1,b.propagationStopped=!1,b.immediatePropagationStopped=!1,b.removed=!1,b.initialize=function(a,b,c){this.type=a,this.bubbles=b,this.cancelable=c,this.timeStamp=(new Date).getTime()},b.preventDefault=function(){this.defaultPrevented=!0},b.stopPropagation=function(){this.propagationStopped=!0},b.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},b.remove=function(){this.removed=!0},b.clone=function(){return new a(this.type,this.bubbles,this.cancelable)},b.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=a}(),this.createjs=this.createjs||{},function(){"use strict";createjs.indexOf=function(a,b){for(var c=0,d=a.length;d>c;c++)if(b===a[c])return c;return-1}}(),this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(a,b){var c=Array.prototype.slice.call(arguments,2);return function(){return a.apply(b,Array.prototype.slice.call(arguments,0).concat(c))}}}(),this.createjs=this.createjs||{},function(){"use strict";function a(){throw"Sound cannot be instantiated"}function b(a,b){this.init(a,b)}function c(){this.isDefault=!0,this.addEventListener=this.removeEventListener=this.removeAllEventListeners=this.dispatchEvent=this.hasEventListener=this._listeners=this._interrupt=this._playFailed=this.pause=this.resume=this.play=this._beginPlaying=this._cleanUp=this.stop=this.setMasterVolume=this.setVolume=this.mute=this.setMute=this.getMute=this.setPan=this.getPosition=this.setPosition=this.playFailed=function(){return!1},this.getVolume=this.getPan=this.getDuration=function(){return 0},this.playState=a.PLAY_FAILED,this.toString=function(){return"[Sound Default Sound Instance]"}}function d(){}var e=a;e.DELIMITER="|",e.INTERRUPT_ANY="any",e.INTERRUPT_EARLY="early",e.INTERRUPT_LATE="late",e.INTERRUPT_NONE="none",e.PLAY_INITED="playInited",e.PLAY_SUCCEEDED="playSucceeded",e.PLAY_INTERRUPTED="playInterrupted",e.PLAY_FINISHED="playFinished",e.PLAY_FAILED="playFailed",e.SUPPORTED_EXTENSIONS=["mp3","ogg","mpeg","wav","m4a","mp4","aiff","wma","mid"],e.EXTENSION_MAP={m4a:"mp4"},e.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([/.]*?(?:[^?]+)?\/)?((?:[^/?]+)\.(\w+))(?:\?(\S+)?)?$/,e.defaultInterruptBehavior=e.INTERRUPT_NONE,e.alternateExtensions=[],e._lastID=0,e.activePlugin=null,e._pluginsRegistered=!1,e._masterVolume=1,e._masterMute=!1,e._instances=[],e._idHash={},e._preloadHash={},e._defaultSoundInstance=null,e.addEventListener=null,e.removeEventListener=null,e.removeAllEventListeners=null,e.dispatchEvent=null,e.hasEventListener=null,e._listeners=null,createjs.EventDispatcher.initialize(e),e._sendFileLoadEvent=function(a){if(e._preloadHash[a])for(var b=0,c=e._preloadHash[a].length;c>b;b++){var d=e._preloadHash[a][b];
if(e._preloadHash[a][b]=!0,e.hasEventListener("fileload")){var f=new createjs.Event("fileload");f.src=d.src,f.id=d.id,f.data=d.data,e.dispatchEvent(f)}}},e.getPreloadHandlers=function(){return{callback:createjs.proxy(e.initLoad,e),types:["sound"],extensions:e.SUPPORTED_EXTENSIONS}},e.registerPlugin=function(a){try{console.log("createjs.Sound.registerPlugin has been deprecated. Please use registerPlugins.")}catch(b){}return e._registerPlugin(a)},e._registerPlugin=function(a){return e._pluginsRegistered=!0,null==a?!1:a.isSupported()?(e.activePlugin=new a,!0):!1},e.registerPlugins=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];if(e._registerPlugin(d))return!0}return!1},e.initializeDefaultPlugins=function(){return null!=e.activePlugin?!0:e._pluginsRegistered?!1:e.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin])?!0:!1},e.isReady=function(){return null!=e.activePlugin},e.getCapabilities=function(){return null==e.activePlugin?null:e.activePlugin._capabilities},e.getCapability=function(a){return null==e.activePlugin?null:e.activePlugin._capabilities[a]},e.initLoad=function(a,b,c,d,f){a=a.replace(f,"");var g=e.registerSound(a,c,d,!1,f);return null==g?!1:g},e.registerSound=function(a,c,d,f,g){if(!e.initializeDefaultPlugins())return!1;if(a instanceof Object&&(g=c,c=a.id,d=a.data,a=a.src),e.alternateExtensions.length)var h=e._parsePath2(a,"sound",c,d);else var h=e._parsePath(a,"sound",c,d);if(null==h)return!1;null!=g&&(a=g+a,h.src=g+h.src),null!=c&&(e._idHash[c]=h.src);var i=null;null!=d&&(isNaN(d.channels)?isNaN(d)||(i=parseInt(d)):i=parseInt(d.channels));var j=e.activePlugin.register(h.src,i);if(null!=j&&(null!=j.numChannels&&(i=j.numChannels),b.create(h.src,i),null!=d&&isNaN(d)?d.channels=h.data.channels=i||b.maxPerChannel():d=h.data=i||b.maxPerChannel(),null!=j.tag?h.tag=j.tag:j.src&&(h.src=j.src),null!=j.completeHandler&&(h.completeHandler=j.completeHandler),j.type&&(h.type=j.type)),0!=f)if(e._preloadHash[h.src]||(e._preloadHash[h.src]=[]),e._preloadHash[h.src].push({src:a,id:c,data:d}),1==e._preloadHash[h.src].length)e.activePlugin.preload(h.src,j);else if(1==e._preloadHash[h.src][0])return!0;return h},e.registerManifest=function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c[d]=createjs.Sound.registerSound(a[d].src,a[d].id,a[d].data,a[d].preload,b);return c},e.removeSound=function(a,c){if(null==e.activePlugin)return!1;if(a instanceof Object&&(a=a.src),a=e._getSrcById(a),e.alternateExtensions.length)var d=e._parsePath2(a);else var d=e._parsePath(a);if(null==d)return!1;null!=c&&(d.src=c+d.src),a=d.src;for(var f in e._idHash)e._idHash[f]==a&&delete e._idHash[f];return b.removeSrc(a),delete e._preloadHash[a],e.activePlugin.removeSound(a),!0},e.removeManifest=function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c[d]=createjs.Sound.removeSound(a[d].src,b);return c},e.removeAllSounds=function(){e._idHash={},e._preloadHash={},b.removeAll(),e.activePlugin.removeAllSounds()},e.loadComplete=function(a){if(e.alternateExtensions.length)var b=e._parsePath2(a,"sound");else var b=e._parsePath(a,"sound");return a=e._getSrcById(b?b.src:a),1==e._preloadHash[a][0]},e._parsePath=function(a,b,c,d){"string"!=typeof a&&(a=a.toString());var f=a.split(e.DELIMITER);if(f.length>1)try{console.log('createjs.Sound.DELIMITER "|" loading approach has been deprecated. Please use the new alternateExtensions property.')}catch(g){}for(var h={type:b||"sound",id:c,data:d},i=e.getCapabilities(),j=0,k=f.length;k>j;j++){var l=f[j],m=l.match(e.FILE_PATTERN);if(null==m)return!1;var n=m[4],o=m[5];if(i[o]&&createjs.indexOf(e.SUPPORTED_EXTENSIONS,o)>-1)return h.name=n,h.src=l,h.extension=o,h}return null},e._parsePath2=function(a,b,c,d){"string"!=typeof a&&(a=a.toString());var f=a.match(e.FILE_PATTERN);if(null==f)return!1;for(var g=f[4],h=f[5],i=e.getCapabilities(),j=0;!i[h];)if(h=e.alternateExtensions[j++],j>e.alternateExtensions.length)return null;a=a.replace("."+f[5],"."+h);var k={type:b||"sound",id:c,data:d};return k.name=g,k.src=a,k.extension=h,k},e.play=function(a,b,c,d,f,g,h){var i=e.createInstance(a),j=e._playInstance(i,b,c,d,f,g,h);return j||i.playFailed(),i},e.createInstance=function(c){if(!e.initializeDefaultPlugins())return e._defaultSoundInstance;if(c=e._getSrcById(c),e.alternateExtensions.length)var d=e._parsePath2(c,"sound");else var d=e._parsePath(c,"sound");var f=null;return null!=d&&null!=d.src?(b.create(d.src),f=e.activePlugin.create(d.src)):f=a._defaultSoundInstance,f.uniqueId=e._lastID++,f},e.setVolume=function(a){if(null==Number(a))return!1;if(a=Math.max(0,Math.min(1,a)),e._masterVolume=a,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(a))for(var b=this._instances,c=0,d=b.length;d>c;c++)b[c].setMasterVolume(a)},e.getVolume=function(){return e._masterVolume},e.setMute=function(a){if(null==a||void 0==a)return!1;if(this._masterMute=a,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(a))for(var b=this._instances,c=0,d=b.length;d>c;c++)b[c].setMasterMute(a);return!0},e.getMute=function(){return this._masterMute},e.stop=function(){for(var a=this._instances,b=a.length;b--;)a[b].stop()},e._playInstance=function(a,b,c,d,f,g,h){if(b instanceof Object&&(c=b.delay,d=b.offset,f=b.loop,g=b.volume,h=b.pan,b=b.interrupt),b=b||e.defaultInterruptBehavior,null==c&&(c=0),null==d&&(d=a.getPosition()),null==f&&(f=0),null==g&&(g=a.volume),null==h&&(h=a.pan),0==c){var i=e._beginPlaying(a,b,d,f,g,h);if(!i)return!1}else{var j=setTimeout(function(){e._beginPlaying(a,b,d,f,g,h)},c);a._delayTimeoutId=j}return this._instances.push(a),!0},e._beginPlaying=function(a,c,d,e,f,g){if(!b.add(a,c))return!1;var h=a._beginPlaying(d,e,f,g);if(!h){var i=createjs.indexOf(this._instances,a);return i>-1&&this._instances.splice(i,1),!1}return!0},e._getSrcById=function(a){return null==e._idHash||null==e._idHash[a]?a:e._idHash[a]},e._playFinished=function(a){b.remove(a);var c=createjs.indexOf(this._instances,a);c>-1&&this._instances.splice(c,1)},createjs.Sound=a,b.channels={},b.create=function(a,c){var d=b.get(a);return null==d?(b.channels[a]=new b(a,c),!0):!1},b.removeSrc=function(a){var c=b.get(a);return null==c?!1:(c.removeAll(),delete b.channels[a],!0)},b.removeAll=function(){for(var a in b.channels)b.channels[a].removeAll();b.channels={}},b.add=function(a,c){var d=b.get(a.src);return null==d?!1:d.add(a,c)},b.remove=function(a){var c=b.get(a.src);return null==c?!1:(c.remove(a),!0)},b.maxPerChannel=function(){return f.maxDefault},b.get=function(a){return b.channels[a]};var f=b.prototype;f.src=null,f.max=null,f.maxDefault=100,f.length=0,f.init=function(a,b){this.src=a,this.max=b||this.maxDefault,-1==this.max&&(this.max=this.maxDefault),this._instances=[]},f.get=function(a){return this._instances[a]},f.add=function(a,b){return this.getSlot(b,a)?(this._instances.push(a),this.length++,!0):!1},f.remove=function(a){var b=createjs.indexOf(this._instances,a);return-1==b?!1:(this._instances.splice(b,1),this.length--,!0)},f.removeAll=function(){for(var a=this.length-1;a>=0;a--)this._instances[a].stop()},f.getSlot=function(b){for(var c,d,e=0,f=this.max;f>e;e++){if(c=this.get(e),null==c)return!0;(b!=a.INTERRUPT_NONE||c.playState==a.PLAY_FINISHED)&&(0!=e?c.playState==a.PLAY_FINISHED||c.playState==a.PLAY_INTERRUPTED||c.playState==a.PLAY_FAILED?d=c:(b==a.INTERRUPT_EARLY&&c.getPosition()<d.getPosition()||b==a.INTERRUPT_LATE&&c.getPosition()>d.getPosition())&&(d=c):d=c)}return null!=d?(d._interrupt(),this.remove(d),!0):!1},f.toString=function(){return"[Sound SoundChannel]"},a._defaultSoundInstance=new c,d.init=function(){var a=window.navigator.userAgent;d.isFirefox=a.indexOf("Firefox")>-1,d.isOpera=null!=window.opera,d.isChrome=a.indexOf("Chrome")>-1,d.isIOS=a.indexOf("iPod")>-1||a.indexOf("iPhone")>-1||a.indexOf("iPad")>-1,d.isAndroid=a.indexOf("Android")>-1,d.isBlackberry=a.indexOf("Blackberry")>-1},d.init(),createjs.Sound.BrowserDetect=d}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this._init()}var b=a;b._capabilities=null,b.isSupported=function(){var a=createjs.Sound.BrowserDetect.isIOS||createjs.Sound.BrowserDetect.isAndroid||createjs.Sound.BrowserDetect.isBlackberry;return"file:"!=location.protocol||a||this._isFileXHRSupported()?(b._generateCapabilities(),null==b.context?!1:!0):!1},b._isFileXHRSupported=function(){var a=!0,b=new XMLHttpRequest;try{b.open("GET","fail.fail",!1)}catch(c){return a=!1}b.onerror=function(){a=!1},b.onload=function(){a=404==this.status||200==this.status||0==this.status&&""!=this.response};try{b.send()}catch(c){a=!1}return a},b._generateCapabilities=function(){if(null==b._capabilities){var a=document.createElement("audio");if(null==a.canPlayType)return null;if(window.webkitAudioContext)b.context=new webkitAudioContext;else{if(!window.AudioContext)return null;b.context=new AudioContext}b._compatibilitySetUp(),b.playEmptySound(),b._capabilities={panning:!0,volume:!0,tracks:-1};for(var c=createjs.Sound.SUPPORTED_EXTENSIONS,d=createjs.Sound.EXTENSION_MAP,e=0,f=c.length;f>e;e++){var g=c[e],h=d[g]||g;b._capabilities[g]="no"!=a.canPlayType("audio/"+g)&&""!=a.canPlayType("audio/"+g)||"no"!=a.canPlayType("audio/"+h)&&""!=a.canPlayType("audio/"+h)}b.context.destination.numberOfChannels<2&&(b._capabilities.panning=!1),b.dynamicsCompressorNode=b.context.createDynamicsCompressor(),b.dynamicsCompressorNode.connect(b.context.destination),b.gainNode=b.context.createGain(),b.gainNode.connect(b.dynamicsCompressorNode)}},b._compatibilitySetUp=function(){if(!b.context.createGain){b.context.createGain=b.context.createGainNode;var a=b.context.createBufferSource();a.__proto__.start=a.__proto__.noteGrainOn,a.__proto__.stop=a.__proto__.noteOff,this._panningModel=0}},b.playEmptySound=function(){var a=this.context.createBuffer(1,1,22050),b=this.context.createBufferSource();b.buffer=a,b.connect(this.context.destination),b.start(0,0,0)};var c=a.prototype;c._capabilities=null,c._volume=1,c.context=null,c._panningModel="equalpower",c.dynamicsCompressorNode=null,c.gainNode=null,c._arrayBuffers=null,c._init=function(){this._capabilities=b._capabilities,this._arrayBuffers={},this.context=b.context,this.gainNode=b.gainNode,this.dynamicsCompressorNode=b.dynamicsCompressorNode},c.register=function(a){this._arrayBuffers[a]=!0;var b=new createjs.WebAudioPlugin.Loader(a,this);return{tag:b}},c.isPreloadStarted=function(a){return null!=this._arrayBuffers[a]},c.isPreloadComplete=function(a){return!(null==this._arrayBuffers[a]||1==this._arrayBuffers[a])},c.removeSound=function(a){delete this._arrayBuffers[a]},c.removeAllSounds=function(){this._arrayBuffers={}},c.addPreloadResults=function(a,b){this._arrayBuffers[a]=b},c._handlePreloadComplete=function(){createjs.Sound._sendFileLoadEvent(this.src)},c.preload=function(a){this._arrayBuffers[a]=!0;var b=new createjs.WebAudioPlugin.Loader(a,this);b.onload=this._handlePreloadComplete,b.load()},c.create=function(a){return this.isPreloadStarted(a)||this.preload(a),new createjs.WebAudioPlugin.SoundInstance(a,this)},c.setVolume=function(a){return this._volume=a,this._updateVolume(),!0},c._updateVolume=function(){var a=createjs.Sound._masterMute?0:this._volume;a!=this.gainNode.gain.value&&(this.gainNode.gain.value=a)},c.getVolume=function(){return this._volume},c.setMute=function(){return this._updateVolume(),!0},c.toString=function(){return"[WebAudioPlugin]"},createjs.WebAudioPlugin=a}(),function(){"use strict";function a(a,b){this._init(a,b)}var b=a.prototype=new createjs.EventDispatcher;b.src=null,b.uniqueId=-1,b.playState=null,b._owner=null,b._offset=0,b._delay=0,b._volume=1;try{Object.defineProperty(b,"volume",{get:function(){return this._volume},set:function(a){return null==Number(a)?!1:(a=Math.max(0,Math.min(1,a)),this._volume=a,void this._updateVolume())}})}catch(c){}b._pan=0;try{Object.defineProperty(b,"pan",{get:function(){return this._pan},set:function(a){return this._owner._capabilities.panning&&null!=Number(a)?(a=Math.max(-1,Math.min(1,a)),this._pan=a,void this.panNode.setPosition(a,0,-.5)):!1}})}catch(c){}b._duration=0,b._remainingLoops=0,b._delayTimeoutId=null,b._soundCompleteTimeout=null,b.gainNode=null,b.panNode=null,b.sourceNode=null,b._sourceNodeNext=null,b._muted=!1,b._paused=!1,b._startTime=0,b._endedHandler=null,b._sendEvent=function(a){var b=new createjs.Event(a);this.dispatchEvent(b)},b._init=function(a,b){this._owner=b,this.src=a,this.gainNode=this._owner.context.createGain(),this.panNode=this._owner.context.createPanner(),this.panNode.panningModel=this._owner._panningModel,this.panNode.connect(this.gainNode),this._owner.isPreloadComplete(this.src)&&(this._duration=1e3*this._owner._arrayBuffers[this.src].duration),this._endedHandler=createjs.proxy(this._handleSoundComplete,this)},b._cleanUp=function(){this.sourceNode&&this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._delayTimeoutId),clearTimeout(this._soundCompleteTimeout),this._startTime=0,null!=window.createjs&&createjs.Sound._playFinished(this)},b._cleanUpAudioNode=function(a){return a&&(a.stop(0),a.disconnect(this.panNode),a=null),a},b._interrupt=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_INTERRUPTED,this._paused=!1,this._sendEvent("interrupted")},b._handleSoundReady=function(){if(null!=window.createjs){if(1e3*this._offset>this.getDuration())return void this.playFailed();this._offset<0&&(this._offset=0),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._paused=!1,this.gainNode.connect(this._owner.gainNode);var a=this._owner._arrayBuffers[this.src].duration;this.sourceNode=this._createAndPlayAudioNode(this._owner.context.currentTime-a,this._offset),this._duration=1e3*a,this._startTime=this.sourceNode.startTime-this._offset,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(a-this._offset)),0!=this._remainingLoops&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._startTime,0))}},b._createAndPlayAudioNode=function(a,b){var c=this._owner.context.createBufferSource();return c.buffer=this._owner._arrayBuffers[this.src],c.connect(this.panNode),this._owner.context.currentTime,c.startTime=a+c.buffer.duration,c.start(c.startTime,b,c.buffer.duration-b),c},b.play=function(a,b,c,d,e,f){this._cleanUp(),createjs.Sound._playInstance(this,a,b,c,d,e,f)},b._beginPlaying=function(a,b,c,d){return null!=window.createjs&&this.src?(this._offset=a/1e3,this._remainingLoops=b,this.volume=c,this.pan=d,this._owner.isPreloadComplete(this.src)?(this._handleSoundReady(null),this._sendEvent("succeeded"),1):void this.playFailed()):void 0},b.pause=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED?!1:(this._paused=!0,this._offset=this._owner.context.currentTime-this._startTime,this._cleanUpAudioNode(this.sourceNode),this._cleanUpAudioNode(this._sourceNodeNext),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(),clearTimeout(this._delayTimeoutId),clearTimeout(this._soundCompleteTimeout),!0)},b.resume=function(){return this._paused?(this._handleSoundReady(null),!0):!1},b.stop=function(){return this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this._offset=0,!0},b.setVolume=function(a){return this.volume=a,!0},b._updateVolume=function(){var a=this._muted?0:this._volume;return a!=this.gainNode.gain.value?(this.gainNode.gain.value=a,!0):!1},b.getVolume=function(){return this.volume},b.setMute=function(a){return null==a||void 0==a?!1:(this._muted=a,this._updateVolume(),!0)},b.getMute=function(){return this._muted},b.setPan=function(a){return this.pan=a,this.pan!=a?!1:void 0},b.getPan=function(){return this.pan},b.getPosition=function(){if(this._paused||null==this.sourceNode)var a=this._offset;else var a=this._owner.context.currentTime-this._startTime;return 1e3*a},b.setPosition=function(a){return this._offset=a/1e3,this.sourceNode&&this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._cleanUpAudioNode(this.sourceNode),this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout)),this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED||this._handleSoundReady(null),!0},b.getDuration=function(){return this._duration},b._handleSoundComplete=function(){return this._offset=0,0!=this._remainingLoops?(this._remainingLoops--,this._sourceNodeNext?(this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._startTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._startTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)):this._handleSoundReady(null),void this._sendEvent("loop")):void(null!=window.createjs&&(this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this._sendEvent("complete")))},b.playFailed=function(){null!=window.createjs&&(this._cleanUp(),this.playState=createjs.Sound.PLAY_FAILED,this._sendEvent("failed"))},b.toString=function(){return"[WebAudioPlugin SoundInstance]"},createjs.WebAudioPlugin.SoundInstance=a}(),function(){"use strict";function a(a,b){this._init(a,b)}var b=a.prototype;b.request=null,b.owner=null,b.progress=-1,b.src=null,b.originalSrc=null,b.result=null,b.onload=null,b.onprogress=null,b.onError=null,b._init=function(a,b){this.src=a,this.originalSrc=a,this.owner=b},b.load=function(a){null!=a&&(this.src=a),this.request=new XMLHttpRequest,this.request.open("GET",this.src,!0),this.request.responseType="arraybuffer",this.request.onload=createjs.proxy(this.handleLoad,this),this.request.onError=createjs.proxy(this.handleError,this),this.request.onprogress=createjs.proxy(this.handleProgress,this),this.request.send()},b.handleProgress=function(a,b){this.progress=a/b,null!=this.onprogress&&this.onprogress({loaded:a,total:b,progress:this.progress})},b.handleLoad=function(){this.owner.context.decodeAudioData(this.request.response,createjs.proxy(this.handleAudioDecoded,this),createjs.proxy(this.handleError,this))},b.handleAudioDecoded=function(a){this.progress=1,this.result=a,this.src=this.originalSrc,this.owner.addPreloadResults(this.src,this.result),this.onload&&this.onload()},b.handleError=function(a){this.owner.removeSound(this.src),this.onerror&&this.onerror(a)},b.toString=function(){return"[WebAudioPlugin Loader]"},createjs.WebAudioPlugin.Loader=a}(),this.createjs=this.createjs||{},function(){"use strict";function a(){this._init()}var b=a;b.MAX_INSTANCES=30,b._AUDIO_READY="canplaythrough",b._AUDIO_ENDED="ended",b._AUDIO_SEEKED="seeked",b._AUDIO_STALLED="stalled",b._capabilities=null,b.enableIOS=!1,b.isSupported=function(){if(createjs.Sound.BrowserDetect.isIOS&&!b.enableIOS)return!1;b._generateCapabilities();var a=b.tag;return null==a||null==b._capabilities?!1:!0},b._generateCapabilities=function(){if(null==b._capabilities){var a=b.tag=document.createElement("audio");if(null==a.canPlayType)return null;b._capabilities={panning:!0,volume:!0,tracks:-1};for(var c=createjs.Sound.SUPPORTED_EXTENSIONS,d=createjs.Sound.EXTENSION_MAP,e=0,f=c.length;f>e;e++){var g=c[e],h=d[g]||g;b._capabilities[g]="no"!=a.canPlayType("audio/"+g)&&""!=a.canPlayType("audio/"+g)||"no"!=a.canPlayType("audio/"+h)&&""!=a.canPlayType("audio/"+h)}}};var c=a.prototype;c._capabilities=null,c._audioSources=null,c.defaultNumChannels=2,c.loadedHandler=null,c._init=function(){this._capabilities=b._capabilities,this._audioSources={}},c.register=function(a,b){this._audioSources[a]=!0;for(var c=createjs.HTMLAudioPlugin.TagPool.get(a),d=null,e=b||this.defaultNumChannels,f=0;e>f;f++)d=this._createTag(a),c.add(d);if(d.id=a,this.loadedHandler=createjs.proxy(this._handleTagLoad,this),d.addEventListener&&d.addEventListener("canplaythrough",this.loadedHandler),null==d.onreadystatechange)d.onreadystatechange=this.loadedHandler;else{var g=d.onreadystatechange;d.onreadystatechange=function(){g(),this.loadedHandler()}}return{tag:d,numChannels:e}},c._handleTagLoad=function(a){a.target.removeEventListener&&a.target.removeEventListener("canplaythrough",this.loadedHandler),a.target.onreadystatechange=null,a.target.src!=a.target.id&&createjs.HTMLAudioPlugin.TagPool.checkSrc(a.target.id)},c._createTag=function(a){var b=document.createElement("audio");return b.autoplay=!1,b.preload="none",b.src=a,b},c.removeSound=function(a){delete this._audioSources[a],createjs.HTMLAudioPlugin.TagPool.remove(a)},c.removeAllSounds=function(){this._audioSources={},createjs.HTMLAudioPlugin.TagPool.removeAll()},c.create=function(a){if(!this.isPreloadStarted(a)){var b=createjs.HTMLAudioPlugin.TagPool.get(a),c=this._createTag(a);c.id=a,b.add(c),this.preload(a,{tag:c})}return new createjs.HTMLAudioPlugin.SoundInstance(a,this)},c.isPreloadStarted=function(a){return null!=this._audioSources[a]},c.preload=function(a,b){this._audioSources[a]=!0,new createjs.HTMLAudioPlugin.Loader(a,b.tag)},c.toString=function(){return"[HTMLAudioPlugin]"},createjs.HTMLAudioPlugin=a}(),function(){"use strict";function a(a,b){this._init(a,b)}var b=a.prototype=new createjs.EventDispatcher;b.src=null,b.uniqueId=-1,b.playState=null,b._owner=null,b.loaded=!1,b._offset=0,b._delay=0,b._volume=1;try{Object.defineProperty(b,"volume",{get:function(){return this._volume},set:function(a){null!=Number(a)&&(a=Math.max(0,Math.min(1,a)),this._volume=a,this._updateVolume())}})}catch(c){}b.pan=0,b._duration=0,b._remainingLoops=0,b._delayTimeoutId=null,b.tag=null,b._muted=!1,b._paused=!1,b._endedHandler=null,b._readyHandler=null,b._stalledHandler=null,b.loopHandler=null,b._init=function(a,b){this.src=a,this._owner=b,this._endedHandler=createjs.proxy(this._handleSoundComplete,this),this._readyHandler=createjs.proxy(this._handleSoundReady,this),this._stalledHandler=createjs.proxy(this._handleSoundStalled,this),this.loopHandler=createjs.proxy(this.handleSoundLoop,this)},b._sendEvent=function(a){var b=new createjs.Event(a);this.dispatchEvent(b)},b._cleanUp=function(){var a=this.tag;if(null!=a){a.pause(),a.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),a.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),a.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this.loopHandler,!1);try{a.currentTime=0}catch(b){}createjs.HTMLAudioPlugin.TagPool.setInstance(this.src,a),this.tag=null}clearTimeout(this._delayTimeoutId),null!=window.createjs&&createjs.Sound._playFinished(this)},b._interrupt=function(){null!=this.tag&&(this.playState=createjs.Sound.PLAY_INTERRUPTED,this._cleanUp(),this._paused=!1,this._sendEvent("interrupted"))},b.play=function(a,b,c,d,e,f){this._cleanUp(),createjs.Sound._playInstance(this,a,b,c,d,e,f)},b._beginPlaying=function(a,b,c,d){if(null==window.createjs)return-1;var e=this.tag=createjs.HTMLAudioPlugin.TagPool.getInstance(this.src);return null==e?(this.playFailed(),-1):(e.addEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._offset=a,this.volume=c,this.pan=d,this._updateVolume(),this._remainingLoops=b,4!==e.readyState?(e.addEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),e.addEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),e.preload="auto",e.load()):this._handleSoundReady(null),this._sendEvent("succeeded"),1)},b._handleSoundStalled=function(){this._cleanUp(),this._sendEvent("failed")},b._handleSoundReady=function(){if(null!=window.createjs){if(this._duration=1e3*this.tag.duration,this.playState=createjs.Sound.PLAY_SUCCEEDED,this._paused=!1,this.tag.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._offset>=this.getDuration())return void this.playFailed();this._offset>0&&(this.tag.currentTime=.001*this._offset),-1==this._remainingLoops&&(this.tag.loop=!0),0!=this._remainingLoops&&(this.tag.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this.loopHandler,!1),this.tag.loop=!0),this.tag.play()}},b.pause=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED||null==this.tag?!1:(this._paused=!0,this.tag.pause(),clearTimeout(this._delayTimeoutId),!0)},b.resume=function(){return this._paused&&null!=this.tag?(this._paused=!1,this.tag.play(),!0):!1},b.stop=function(){return this._offset=0,this.pause(),this.playState=createjs.Sound.PLAY_FINISHED,this._cleanUp(),!0},b.setMasterVolume=function(){return this._updateVolume(),!0},b.setVolume=function(a){return this.volume=a,!0},b._updateVolume=function(){if(null!=this.tag){var a=this._muted||createjs.Sound._masterMute?0:this._volume*createjs.Sound._masterVolume;return a!=this.tag.volume&&(this.tag.volume=a),!0}return!1},b.getVolume=function(){return this.volume},b.setMasterMute=function(){return this._updateVolume(),!0},b.setMute=function(a){return null==a||void 0==a?!1:(this._muted=a,this._updateVolume(),!0)},b.getMute=function(){return this._muted},b.setPan=function(){return!1},b.getPan=function(){return 0},b.getPosition=function(){return null==this.tag?this._offset:1e3*this.tag.currentTime},b.setPosition=function(a){if(null==this.tag)this._offset=a;else{this.tag.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this.loopHandler,!1);try{this.tag.currentTime=.001*a}catch(b){return!1}this.tag.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this.loopHandler,!1)}return!0},b.getDuration=function(){return this._duration},b._handleSoundComplete=function(){this._offset=0,null!=window.createjs&&(this.playState=createjs.Sound.PLAY_FINISHED,this._cleanUp(),this._sendEvent("complete"))},b.handleSoundLoop=function(){this._offset=0,this._remainingLoops--,0==this._remainingLoops&&(this.tag.loop=!1,this.tag.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this.loopHandler,!1)),this._sendEvent("loop")},b.playFailed=function(){null!=window.createjs&&(this.playState=createjs.Sound.PLAY_FAILED,this._cleanUp(),this._sendEvent("failed"))},b.toString=function(){return"[HTMLAudioPlugin SoundInstance]"},createjs.HTMLAudioPlugin.SoundInstance=a}(),function(){"use strict";function a(a,b){this._init(a,b)}var b=a.prototype;b.src=null,b.tag=null,b.preloadTimer=null,b.loadedHandler=null,b._init=function(a,b){if(this.src=a,this.tag=b,this.preloadTimer=setInterval(createjs.proxy(this.preloadTick,this),200),this.loadedHandler=createjs.proxy(this.sendLoadedEvent,this),this.tag.addEventListener&&this.tag.addEventListener("canplaythrough",this.loadedHandler),null==this.tag.onreadystatechange)this.tag.onreadystatechange=createjs.proxy(this.sendLoadedEvent,this);else{var c=this.tag.onreadystatechange;this.tag.onreadystatechange=function(){c(),this.tag.onreadystatechange=createjs.proxy(this.sendLoadedEvent,this)}}this.tag.preload="auto",this.tag.load()},b.preloadTick=function(){var a=this.tag.buffered,b=this.tag.duration;a.length>0&&a.end(0)>=b-1&&this.handleTagLoaded()},b.handleTagLoaded=function(){clearInterval(this.preloadTimer)},b.sendLoadedEvent=function(){this.tag.removeEventListener&&this.tag.removeEventListener("canplaythrough",this.loadedHandler),this.tag.onreadystatechange=null,createjs.Sound._sendFileLoadEvent(this.src)},b.toString=function(){return"[HTMLAudioPlugin Loader]"},createjs.HTMLAudioPlugin.Loader=a}(),function(){"use strict";function a(a){this._init(a)}var b=a;b.tags={},b.get=function(c){var d=b.tags[c];return null==d&&(d=b.tags[c]=new a(c)),d},b.remove=function(a){var c=b.tags[a];return null==c?!1:(c.removeAll(),delete b.tags[a],!0)},b.removeAll=function(){for(var a in b.tags)b.tags[a].removeAll();b.tags={}},b.getInstance=function(a){var c=b.tags[a];return null==c?null:c.get()},b.setInstance=function(a,c){var d=b.tags[a];return null==d?null:d.set(c)},b.checkSrc=function(a){var c=b.tags[a];return null==c?null:void c.checkSrcChange()};var c=a.prototype;c.src=null,c.length=0,c.available=0,c.tags=null,c._init=function(a){this.src=a,this.tags=[]},c.add=function(a){this.tags.push(a),this.length++,this.available++},c.removeAll=function(){for(;this.length--;)delete this.tags[this.length];this.src=null,this.tags.length=0},c.get=function(){if(0==this.tags.length)return null;this.available=this.tags.length;var a=this.tags.pop();return null==a.parentNode&&document.body.appendChild(a),a},c.set=function(a){var b=createjs.indexOf(this.tags,a);-1==b&&this.tags.push(a),this.available=this.tags.length},c.checkSrcChange=function(){for(var a=this.tags.length-1,b=this.tags[a].src;a--;)this.tags[a].src=b},c.toString=function(){return"[HTMLAudioPlugin TagPool]"},createjs.HTMLAudioPlugin.TagPool=a}(),Livepress.sounds=function(){var a=LivepressConfig.lp_plugin_url+"sounds/",b=1==LivepressConfig.sounds_default,c={},d="vibes_04-04LR_02-01.mp3",e="vibes-short_09-08.mp3",f="piano_w-pad_01-16M_01-01.mp3",g="piano_w-pad_01-17M_01.mp3";return createjs.Sound.alternateExtensions=["mp3"],createjs.Sound.registerSound(a+d,"commentAdded"),createjs.Sound.registerSound(a+d,"firstComment"),createjs.Sound.registerSound(a+e,"commentReplyToUserReceived"),createjs.Sound.registerSound(a+d,"commented"),createjs.Sound.registerSound(a+g,"newPost"),createjs.Sound.registerSound(a+f,"postUpdated"),c.on=function(){b=!0},c.off=function(){b=!1},c.play=function(a){b&&createjs.Sound.play(a)},c}();