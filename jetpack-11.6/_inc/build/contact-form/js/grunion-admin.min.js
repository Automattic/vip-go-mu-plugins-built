jQuery((function(a){if("undefined"!=typeof jetpack_empty_spam_button_parameters){var t=a("<div/>").addClass("jetpack-empty-spam-container"),e=a("<a />").addClass("button-secondary").addClass("jetpack-empty-spam").attr("href","#").attr("data-progress-label",jetpack_empty_spam_button_parameters.progress_label).attr("data-success-url",jetpack_empty_spam_button_parameters.success_url).attr("data-failure-url",jetpack_empty_spam_button_parameters.failure_url).attr("data-spam-feedbacks-count",jetpack_empty_spam_button_parameters.spam_count).attr("data-nonce",jetpack_empty_spam_button_parameters.nonce).text(jetpack_empty_spam_button_parameters.label);t.append(e);var n=a("<span />").addClass("jetpack-empty-spam-spinner");t.append(n),a(".tablenav.top .actions, .tablenav.bottom .actions").not(".bulkactions").append(t)}function s(t,e){var n=a("#jetpack-check-feedback-spam").data("nonce-name"),c=a("#"+n).attr("value"),p=a("#jetpack-check-feedback-spam").data("failure-url"),o={action:"grunion_recheck_queue",offset:t,limit:e};o[n]=c,a.post(ajaxurl,o).fail((function(){window.location.href=p})).done((function(a){a.processed<e?window.location.reload():s(t+e,e)}))}a(document).on("click","#jetpack-check-feedback-spam:not(.button-disabled)",(function(t){t.preventDefault(),a("#jetpack-check-feedback-spam:not(.button-disabled)").addClass("button-disabled"),a(".jetpack-check-feedback-spam-spinner").addClass("spinner").show(),s(0,100)}));var c=0,p=0;function o(){var t=a(".jetpack-empty-spam"),e=t.data("nonce"),n=Math.round(p/c*1e3)/10;t.text(t.data("progress-label").replace("%1$s",n)),a.post(ajaxurl,{action:"jetpack_delete_spam_feedbacks",nonce:e}).fail((function(a){window.location.href=t.data("failure-url")})).done((function(a){p+=a.data.counts.deleted,a.data.counts.deleted<a.data.counts.limit?window.location.href=t.data("success-url"):o()}))}a(document).on("click",".jetpack-empty-spam",(function(t){t.preventDefault(),a(this).hasClass("button-disabled")||(a(".jetpack-empty-spam").addClass("button-disabled").addClass("emptying"),a(".jetpack-empty-spam-spinner").addClass("spinner").addClass("is-active"),a(".jetpack-empty-spam").text(a(".jetpack-empty-spam").data("progress-label").replace("%1$s","0")),c=parseInt(a(this).data("spam-feedbacks-count"),10),o())})),a(document).ready((function(){function t(t,e,n){a.post(ajaxurl,{action:"grunion_ajax_spam",post_id:t,make_it:e,sub_menu:jQuery(".subsubsub .current").attr("href"),_ajax_nonce:window.__grunionPostStatusNonce},(function(e){a("#post-"+t).css({backgroundColor:n}).fadeOut(350,(function(){a(this).remove(),a(".subsubsub").html(e)}))}))}a("tr.type-feedback .row-actions a").click((function(e){e.preventDefault();var n=a(e.target).closest("tr.type-feedback").attr("id").match(/^post\-(\d+)/);if(n){var s=parseInt(n[1],10);a(e.target).parent().hasClass("spam")&&(e.preventDefault(),t(s,"spam","#FF7979")),a(e.target).parent().hasClass("trash")&&(e.preventDefault(),t(s,"trash","#FF7979")),a(e.target).parent().hasClass("unspam")&&(e.preventDefault(),t(s,"ham","#59C859")),a(e.target).parent().hasClass("untrash")&&(e.preventDefault(),t(s,"publish","#59C859"))}}))})),a(document).on("click","#jetpack-export-feedback",(function(t){t.preventDefault();var e=a("#jetpack-export-feedback").data("nonce-name"),n=a("#"+e).attr("value"),s=window.location.search.match(/(\?|\&)m=(\d+)/),c=window.location.search.match(/(\?|\&)jetpack_form_parent_id=(\d+)/),p=[];a("#posts-filter .check-column input[type=checkbox]:checked").each((function(){p.push(parseInt(a(this).attr("value"),10))})),a.post(ajaxurl,{action:"feedback_export",year:s?s[2].substr(0,4):"",month:s?s[2].substr(4,2):"",post:c?parseInt(c[2],10):"all",selected:p,[e]:n},(function(a){var t=new Blob([a],{type:"application/octetstream"}),e=document.createElement("a");e.href=window.URL.createObjectURL(t),e.download="feedback.csv",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(e.href)}))}))}));