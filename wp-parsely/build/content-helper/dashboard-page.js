!function(){"use strict";var e={69:function(e,t){Object.prototype.toString},20:function(e,t,n){var r=n(609),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},848:function(e,t,n){e.exports=n(20)},609:function(e){e.exports=window.React}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e=n(848),t=n(609),r=(n(69),"popstate");function o(e={}){return function(e,t,n,o={}){let{window:a=document.defaultView,v5Compat:u=!1}=o,d=a.history,p="POP",f=null,h=g();function g(){return(d.state||{idx:null}).idx}function v(){p="POP";let e=g(),t=null==e?null:e-h;h=e,f&&f({action:p,location:y.location,delta:t})}function m(e){return function(e,t=!1){let n="http://localhost";"undefined"!=typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),i(n,"No window.location.(origin|href) available to create URL");let r="string"==typeof e?e:c(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}(e)}null==h&&(h=0,d.replaceState({...d.state,idx:h},""));let y={get action(){return p},get location(){return e(a,d)},listen(e){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(r,v),f=e,()=>{a.removeEventListener(r,v),f=null}},createHref(e){return t(a,e)},createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){p="PUSH";let r=l(y.location,e,t);n&&n(r,e),h=g()+1;let o=s(r,h),i=y.createHref(r);try{d.pushState(o,"",i)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;a.location.assign(i)}u&&f&&f({action:p,location:y.location,delta:1})},replace:function(e,t){p="REPLACE";let r=l(y.location,e,t);n&&n(r,e),h=g();let o=s(r,h),i=y.createHref(r);d.replaceState(o,"",i),u&&f&&f({action:p,location:y.location,delta:0})},go(e){return d.go(e)}};return y}((function(e,t){let{pathname:n="/",search:r="",hash:o=""}=u(e.location.hash.substring(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),l("",{pathname:n,search:r,hash:o},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let n=e.document.querySelector("base"),r="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");r=-1===n?t:t.slice(0,n)}return r+"#"+("string"==typeof t?t:c(t))}),(function(e,t){a("/"===e.pathname.charAt(0),`relative pathnames are not supported in hash history.push(${JSON.stringify(t)})`)}),e)}function i(e,t){if(!1===e||null==e)throw new Error(t)}function a(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function s(e,t){return{usr:e.state,key:e.key,idx:t}}function l(e,t,n=null,r){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?u(t):t,state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)}}function c({pathname:e="/",search:t="",hash:n=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function u(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function d(e,t,n="/"){return function(e,t,n,r){let o=E(("string"==typeof t?u(t):t).pathname||"/",n);if(null==o)return null;let i=p(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]))?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let a=null;for(let e=0;null==a&&e<i.length;++e){let t=S(o);a=k(i[e],t,r)}return a}(e,t,n,!1)}function p(e,t=[],n=[],r=""){let o=(e,o,a)=>{let s={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};s.relativePath.startsWith("/")&&(i(s.relativePath.startsWith(r),`Absolute route path "${s.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),s.relativePath=s.relativePath.slice(r.length));let l=T([r,s.relativePath]),c=n.concat(s);e.children&&e.children.length>0&&(i(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),p(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:x(l,e.index),routesMeta:c})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let n of f(e.path))o(e,t,n);else o(e,t)})),t}function f(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return o?[i,""]:[i];let a=f(r.join("/")),s=[];return s.push(...a.map((e=>""===e?i:[i,e].join("/")))),o&&s.push(...a),s.map((t=>e.startsWith("/")&&""===t?"/":t))}new WeakMap;var h=/^:[\w-]+$/,g=3,v=2,m=1,y=10,b=-2,w=e=>"*"===e;function x(e,t){let n=e.split("/"),r=n.length;return n.some(w)&&(r+=b),t&&(r+=v),n.filter((e=>!w(e))).reduce(((e,t)=>e+(h.test(t)?g:""===t?m:y)),r)}function k(e,t,n=!1){let{routesMeta:r}=e,o={},i="/",a=[];for(let e=0;e<r.length;++e){let s=r[e],l=e===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=_({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},c),d=s.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=_({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},c)),!u)return null;Object.assign(o,u.params),a.push({params:o,pathname:T([i,u.pathname]),pathnameBase:N(T([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=T([i,u.pathnameBase]))}return a}function _(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t=!1,n=!0){a("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(r.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],s=i.replace(/(.)\/+$/,"$1"),l=o.slice(1);return{params:r.reduce(((e,{paramName:t,isOptional:n},r)=>{if("*"===t){let e=l[r]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[r];return e[t]=n&&!o?void 0:(o||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:s,pattern:e}}function S(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return a(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function E(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function P(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function L(e){let t=function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function j(e,t,n,r=!1){let o;"string"==typeof e?o=u(e):(o={...e},i(!o.pathname||!o.pathname.includes("?"),P("?","pathname","search",o)),i(!o.pathname||!o.pathname.includes("#"),P("#","pathname","hash",o)),i(!o.search||!o.search.includes("#"),P("#","search","hash",o)));let a,s=""===e||""===o.pathname,l=s?"/":o.pathname;if(null==l)a=n;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}a=e>=0?t[e]:"/"}let c=function(e,t="/"){let{pathname:n,search:r="",hash:o=""}="string"==typeof e?u(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:C(r),hash:I(o)}}(o,a),d=l&&"/"!==l&&l.endsWith("/"),p=(s||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!d&&!p||(c.pathname+="/"),c}var T=e=>e.join("/").replace(/\/\/+/g,"/"),N=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),C=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",I=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function A(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}var R=["POST","PUT","PATCH","DELETE"],O=(new Set(R),["GET",...R]);new Set(O),Symbol("ResetLoaderData");var D=t.createContext(null);D.displayName="DataRouter";var G=t.createContext(null);G.displayName="DataRouterState";var B=t.createContext({isTransitioning:!1});B.displayName="ViewTransition",t.createContext(new Map).displayName="Fetchers",t.createContext(null).displayName="Await";var M=t.createContext(null);M.displayName="Navigation";var F=t.createContext(null);F.displayName="Location";var U=t.createContext({outlet:null,matches:[],isDataRoute:!1});U.displayName="Route";var H=t.createContext(null);function V(){return null!=t.useContext(F)}function $(){return i(V(),"useLocation() may be used only in the context of a <Router> component."),t.useContext(F).location}H.displayName="RouteError";var W="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function z(e){t.useContext(M).static||t.useLayoutEffect(e)}function q(){let{isDataRoute:e}=t.useContext(U);return e?function(){let{router:e}=function(e){let n=t.useContext(D);return i(n,ee(e)),n}("useNavigate"),n=te("useNavigate"),r=t.useRef(!1);return z((()=>{r.current=!0})),t.useCallback((async(t,o={})=>{a(r.current,W),r.current&&("number"==typeof t?e.navigate(t):await e.navigate(t,{fromRouteId:n,...o}))}),[e,n])}():function(){i(V(),"useNavigate() may be used only in the context of a <Router> component.");let e=t.useContext(D),{basename:n,navigator:r}=t.useContext(M),{matches:o}=t.useContext(U),{pathname:s}=$(),l=JSON.stringify(L(o)),c=t.useRef(!1);return z((()=>{c.current=!0})),t.useCallback(((t,o={})=>{if(a(c.current,W),!c.current)return;if("number"==typeof t)return void r.go(t);let i=j(t,JSON.parse(l),s,"path"===o.relative);null==e&&"/"!==n&&(i.pathname="/"===i.pathname?n:T([n,i.pathname])),(o.replace?r.replace:r.push)(i,o.state,o)}),[n,r,l,s,e])}()}function K(e,{relative:n}={}){let{matches:r}=t.useContext(U),{pathname:o}=$(),i=JSON.stringify(L(r));return t.useMemo((()=>j(e,JSON.parse(i),o,"path"===n)),[e,i,o,n])}function Z(e,n,r,o){i(V(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=t.useContext(M),{matches:l}=t.useContext(U),c=l[l.length-1],p=c?c.params:{},f=c?c.pathname:"/",h=c?c.pathnameBase:"/",g=c&&c.route;{let e=g&&g.path||"";re(f,!g||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let v,m=$();if(n){let e="string"==typeof n?u(n):n;i("/"===h||e.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${e.pathname}" was given in the \`location\` prop.`),v=e}else v=m;let y=v.pathname||"/",b=y;if("/"!==h){let e=h.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=d(e,{pathname:b});a(g||null!=w,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),a(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=function(e,n=[],r=null){if(null==e){if(!r)return null;if(r.errors)e=r.matches;else{if(0!==n.length||r.initialized||!(r.matches.length>0))return null;e=r.matches}}let o=e,a=r?.errors;if(null!=a){let e=o.findIndex((e=>e.route.id&&void 0!==a?.[e.route.id]));i(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),o=o.slice(0,Math.min(o.length,e+1))}let s=!1,l=-1;if(r)for(let e=0;e<o.length;e++){let t=o[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=e),t.route.id){let{loaderData:e,errors:n}=r,i=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||i){s=!0,o=l>=0?o.slice(0,l+1):[o[0]];break}}}return o.reduceRight(((e,i,c)=>{let u,d=!1,p=null,f=null;r&&(u=a&&i.route.id?a[i.route.id]:void 0,p=i.route.errorElement||J,s&&(l<0&&0===c?(re("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,f=null):l===c&&(d=!0,f=i.route.hydrateFallbackElement||null)));let h=n.concat(o.slice(0,c+1)),g=()=>{let n;return n=u?p:d?f:i.route.Component?t.createElement(i.route.Component,null):i.route.element?i.route.element:e,t.createElement(X,{match:i,routeContext:{outlet:e,matches:h,isDataRoute:null!=r},children:n})};return r&&(i.route.ErrorBoundary||i.route.errorElement||0===c)?t.createElement(Q,{location:r.location,revalidation:r.revalidation,component:p,error:u,children:g(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):g()}),null)}(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},p,e.params),pathname:T([h,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:T([h,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,r,o);return n&&x?t.createElement(F.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},x):x}function Y(){let e=function(){let e=t.useContext(H),n=function(e){let n=t.useContext(G);return i(n,ee(e)),n}("useRouteError"),r=te("useRouteError");return void 0!==e?e:n.errors?.[r]}(),n=A(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:o},s={padding:"2px 4px",backgroundColor:o},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=t.createElement(t.Fragment,null,t.createElement("p",null,"💿 Hey developer 👋"),t.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",t.createElement("code",{style:s},"ErrorBoundary")," or"," ",t.createElement("code",{style:s},"errorElement")," prop on your route.")),t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:a},r):null,l)}t.createContext(null);var J=t.createElement(Y,null),Q=class extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(U.Provider,{value:this.props.routeContext},t.createElement(H.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function X({routeContext:e,match:n,children:r}){let o=t.useContext(D);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),t.createElement(U.Provider,{value:e},r)}function ee(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function te(e){let n=function(e){let n=t.useContext(U);return i(n,ee(e)),n}(e),r=n.matches[n.matches.length-1];return i(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}var ne={};function re(e,t,n){t||ne[e]||(ne[e]=!0,a(!1,n))}function oe({to:e,replace:n,state:r,relative:o}){i(V(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=t.useContext(M);a(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=t.useContext(U),{pathname:c}=$(),u=q(),d=j(e,L(l),c,"path"===o),p=JSON.stringify(d);return t.useEffect((()=>{u(JSON.parse(p),{replace:n,state:r,relative:o})}),[u,p,o,n,r]),null}function ie(e){i(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ae({basename:e="/",children:n=null,location:r,navigationType:o="POP",navigator:s,static:l=!1}){i(!V(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),d=t.useMemo((()=>({basename:c,navigator:s,static:l,future:{}})),[c,s,l]);"string"==typeof r&&(r=u(r));let{pathname:p="/",search:f="",hash:h="",state:g=null,key:v="default"}=r,m=t.useMemo((()=>{let e=E(p,c);return null==e?null:{location:{pathname:e,search:f,hash:h,state:g,key:v},navigationType:o}}),[c,p,f,h,g,v,o]);return a(null!=m,`<Router basename="${c}"> is not able to match the URL "${p}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),null==m?null:t.createElement(M.Provider,{value:d},t.createElement(F.Provider,{children:n,value:m}))}function se({children:e,location:t}){return Z(le(e),t)}function le(e,n=[]){let r=[];return t.Children.forEach(e,((e,o)=>{if(!t.isValidElement(e))return;let a=[...n,o];if(e.type===t.Fragment)return void r.push.apply(r,le(e.props.children,a));i(e.type===ie,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),i(!e.props.index||!e.props.children,"An index route cannot have child routes.");let s={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=le(e.props.children,a)),r.push(s)})),r}t.memo((function({routes:e,future:t,state:n}){return Z(e,void 0,n,t)})),t.Component;var ce="get",ue="application/x-www-form-urlencoded";function de(e){return null!=e&&"string"==typeof e.tagName}var pe=null,fe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function he(e){return null==e||fe.has(e)?e:(a(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ue}"`),null)}function ge(e,t){if(!1===e||null==e)throw new Error(t)}function ve(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function me(e,t,n,r,o,i){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith("*")&&n[t].params["*"]!==e.params["*"];return"assets"===i?t.filter(((e,t)=>a(e,t)||s(e,t))):"data"===i?t.filter(((t,i)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,i)||s(t,i))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof r)return r}return!0})):[]}function ye(e,t,{includeHydrateFallback:n}={}){return r=e.map((e=>{let r=t.routes[e.route.id];if(!r)return[];let o=[r.module];return r.clientActionModule&&(o=o.concat(r.clientActionModule)),r.clientLoaderModule&&(o=o.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(o=o.concat(r.hydrateFallbackModule)),r.imports&&(o=o.concat(r.imports)),o})).flat(1),[...new Set(r)];var r}Object.getOwnPropertyNames(Object.prototype).sort().join("\0"),"undefined"!=typeof window?window:"undefined"!=typeof globalThis&&globalThis,Symbol("SingleFetchRedirect");function be(){let e=t.useContext(D);return ge(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function we(){let e=t.useContext(G);return ge(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}t.Component;var xe=t.createContext(void 0);function ke(){let e=t.useContext(xe);return ge(e,"You must render this element inside a <HydratedRouter> element"),e}function _e(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Se({page:e,...n}){let{router:r}=be(),o=t.useMemo((()=>d(r.routes,e,r.basename)),[r.routes,e,r.basename]);return o?t.createElement(Pe,{page:e,matches:o,...n}):null}function Ee(e){let{manifest:n,routeModules:r}=ke(),[o,i]=t.useState([]);return t.useEffect((()=>{let t=!1;return async function(e,t,n){return function(e,t){let n=new Set,r=new Set(t);return e.reduce(((e,o)=>{if(t&&(null==(i=o)||"string"!=typeof i.page)&&"script"===o.as&&o.href&&r.has(o.href))return e;var i;let a=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(o));return n.has(a)||(n.add(a),e.push({key:a,link:o})),e}),[])}((await Promise.all(e.map((async e=>{let r=t.routes[e.route.id];if(r){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}(r,n);return e.links?e.links():[]}return[]})))).flat(1).filter(ve).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,n,r).then((e=>{t||i(e)})),()=>{t=!0}}),[e,n,r]),o}function Pe({page:e,matches:n,...r}){let o=$(),{manifest:i,routeModules:a}=ke(),{basename:s}=be(),{loaderData:l,matches:c}=we(),u=t.useMemo((()=>me(e,n,c,i,o,"data")),[e,n,c,i,o]),d=t.useMemo((()=>me(e,n,c,i,o,"assets")),[e,n,c,i,o]),p=t.useMemo((()=>{if(e===o.pathname+o.search+o.hash)return[];let t=new Set,r=!1;if(n.forEach((e=>{let n=i.routes[e.route.id];n&&n.hasLoader&&(!u.some((t=>t.route.id===e.route.id))&&e.route.id in l&&a[e.route.id]?.shouldRevalidate||n.hasClientLoader?r=!0:t.add(e.route.id))})),0===t.size)return[];let c=function(e,t){let n="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.data":t&&"/"===E(n.pathname,t)?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}(e,s);return r&&t.size>0&&c.searchParams.set("_routes",n.filter((e=>t.has(e.route.id))).map((e=>e.route.id)).join(",")),[c.pathname+c.search]}),[s,l,o,i,u,n,e,a]),f=t.useMemo((()=>ye(d,i)),[d,i]),h=Ee(d);return t.createElement(t.Fragment,null,p.map((e=>t.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...r}))),f.map((e=>t.createElement("link",{key:e,rel:"modulepreload",href:e,...r}))),h.map((({key:e,link:n})=>t.createElement("link",{key:e,...n}))))}xe.displayName="FrameworkContext";function Le(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}var je="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{je&&(window.__reactRouterVersion="7.6.1")}catch(e){}function Te({basename:e,children:n,window:r}){let i=t.useRef();null==i.current&&(i.current=o({window:r,v5Compat:!0}));let a=i.current,[s,l]=t.useState({action:a.action,location:a.location}),c=t.useCallback((e=>{t.startTransition((()=>l(e)))}),[l]);return t.useLayoutEffect((()=>a.listen(c)),[a,c]),t.createElement(ae,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:a})}var Ne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ce=t.forwardRef((function({onClick:e,discover:n="render",prefetch:r="none",relative:o,reloadDocument:s,replace:l,state:u,target:d,to:p,preventScrollReset:f,viewTransition:h,...g},v){let m,{basename:y}=t.useContext(M),b="string"==typeof p&&Ne.test(p),w=!1;if("string"==typeof p&&b&&(m=p,je))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),n=E(t.pathname,y);t.origin===e.origin&&null!=n?p=n+t.search+t.hash:w=!0}catch(e){a(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=function(e,{relative:n}={}){i(V(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:o}=t.useContext(M),{hash:a,pathname:s,search:l}=K(e,{relative:n}),c=s;return"/"!==r&&(c="/"===s?r:T([r,s])),o.createHref({pathname:c,search:l,hash:a})}(p,{relative:o}),[k,_,S]=function(e,n){let r=t.useContext(xe),[o,i]=t.useState(!1),[a,s]=t.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:p}=n,f=t.useRef(null);t.useEffect((()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{s(e.isIntersecting)}))}),{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}}),[e]),t.useEffect((()=>{if(o){let e=setTimeout((()=>{s(!0)}),100);return()=>{clearTimeout(e)}}}),[o]);let h=()=>{i(!0)},g=()=>{i(!1),s(!1)};return r?"intent"!==e?[a,f,{}]:[a,f,{onFocus:_e(l,h),onBlur:_e(c,g),onMouseEnter:_e(u,h),onMouseLeave:_e(d,g),onTouchStart:_e(p,h)}]:[!1,f,{}]}(r,g),P=function(e,{target:n,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}={}){let l=q(),u=$(),d=K(e,{relative:a});return t.useCallback((t=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(t,n)){t.preventDefault();let n=void 0!==r?r:c(u)===c(d);l(e,{replace:n,state:o,preventScrollReset:i,relative:a,viewTransition:s})}}),[u,l,d,r,o,n,e,i,a,s])}(p,{replace:l,state:u,target:d,preventScrollReset:f,relative:o,viewTransition:h}),L=t.createElement("a",{...g,...S,href:m||x,onClick:w||s?e:function(t){e&&e(t),t.defaultPrevented||P(t)},ref:Le(v,_),target:d,"data-discover":b||"render"!==n?void 0:"true"});return k&&!b?t.createElement(t.Fragment,null,L,t.createElement(Se,{page:x})):L}));function Ie(e){let n=t.useContext(D);return i(n,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),n}Ce.displayName="Link",t.forwardRef((function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:o=!1,style:a,to:s,viewTransition:l,children:c,...u},d){let p=K(s,{relative:u.relative}),f=$(),h=t.useContext(G),{navigator:g,basename:v}=t.useContext(M),m=null!=h&&function(e,n={}){let r=t.useContext(B);i(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=Ie("useViewTransitionState"),a=K(e,{relative:n.relative});if(!r.isTransitioning)return!1;let s=E(r.currentLocation.pathname,o)||r.currentLocation.pathname,l=E(r.nextLocation.pathname,o)||r.nextLocation.pathname;return null!=_(a.pathname,l)||null!=_(a.pathname,s)}(p)&&!0===l,y=g.encodeLocation?g.encodeLocation(p).pathname:p.pathname,b=f.pathname,w=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;n||(b=b.toLowerCase(),w=w?w.toLowerCase():null,y=y.toLowerCase()),w&&v&&(w=E(w,v)||w);const x="/"!==y&&y.endsWith("/")?y.length-1:y.length;let k,S=b===y||!o&&b.startsWith(y)&&"/"===b.charAt(x),P=null!=w&&(w===y||!o&&w.startsWith(y)&&"/"===w.charAt(y.length)),L={isActive:S,isPending:P,isTransitioning:m},j=S?e:void 0;k="function"==typeof r?r(L):[r,S?"active":null,P?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let T="function"==typeof a?a(L):a;return t.createElement(Ce,{...u,"aria-current":j,className:k,ref:d,style:T,to:s,viewTransition:l},"function"==typeof c?c(L):c)})).displayName="NavLink",t.forwardRef((({discover:e="render",fetcherKey:n,navigate:r,reloadDocument:o,replace:a,state:s,method:l=ce,action:u,onSubmit:d,relative:p,preventScrollReset:f,viewTransition:h,...g},v)=>{let m=function(){let{router:e}=Ie("useSubmit"),{basename:n}=t.useContext(M),r=te("useRouteId");return t.useCallback((async(t,o={})=>{let{action:i,method:a,encType:s,formData:l,body:c}=function(e,t){let n,r,o,i,a;if(de(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");r=a?E(a,t):null,n=e.getAttribute("method")||ce,o=he(e.getAttribute("enctype"))||ue,i=new FormData(e)}else if(function(e){return de(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return de(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(r=s?E(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||ce,o=he(e.getAttribute("formenctype"))||he(a.getAttribute("enctype"))||ue,i=new FormData(a,e),!function(){if(null===pe)try{new FormData(document.createElement("form"),0),pe=!1}catch(e){pe=!0}return pe}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?`${t}.`:"";i.append(`${e}x`,"0"),i.append(`${e}y`,"0")}else t&&i.append(t,r)}}else{if(de(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ce,r=null,o=ue,a=e}var s;return i&&"text/plain"===o&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:i,body:a}}(t,n);if(!1===o.navigate){let t=o.fetcherKey||Re();await e.fetch(t,r,o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||a,formEncType:o.encType||s,flushSync:o.flushSync})}else await e.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||a,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})}),[e,n,r])}(),y=function(e,{relative:n}={}){let{basename:r}=t.useContext(M),o=t.useContext(U);i(o,"useFormAction must be used inside a RouteContext");let[a]=o.matches.slice(-1),s={...K(e||".",{relative:n})},l=$();if(null==e){s.search=l.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();s.search=n?`?${n}`:""}}return e&&"."!==e||!a.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),"/"!==r&&(s.pathname="/"===s.pathname?r:T([r,s.pathname])),c(s)}(u,{relative:p}),b="get"===l.toLowerCase()?"get":"post",w="string"==typeof u&&Ne.test(u);return t.createElement("form",{ref:v,method:b,action:y,onSubmit:o?d:e=>{if(d&&d(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,o=t?.getAttribute("formmethod")||l;m(t||e.currentTarget,{fetcherKey:n,method:o,navigate:r,replace:a,state:s,relative:p,preventScrollReset:f,viewTransition:h})},...g,"data-discover":w||"render"!==e?void 0:"true"})})).displayName="Form";var Ae=0,Re=()=>`__${String(++Ae)}__`;var Oe=window.wp.domReady,De=n.n(Oe),Ge=window.wp.element,Be=window.wp.i18n,Me=window.wp.data,Fe=function(){return Fe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Fe.apply(this,arguments)},Ue={},He="wp-parsely/settings",Ve=(0,Me.createReduxStore)(He,{initialState:Ue,reducer:function(e,t){var n,r;switch(void 0===e&&(e=Ue),t.type){case"SET_SETTINGS":return Fe(Fe({},e),((n={})[t.endpoint]=t.settings,n));case"SET_PARTIAL_SETTINGS":var o=e[t.endpoint]||{},i=Fe(Fe({},o),t.partialSettings);return Fe(Fe({},e),((r={})[t.endpoint]=i,r));default:return e}},actions:{setSettings:function(e,t){return{type:"SET_SETTINGS",endpoint:e,settings:t}},setPartialSettings:function(e,t){return{type:"SET_PARTIAL_SETTINGS",endpoint:e,partialSettings:t}}},selectors:{getSettings:function(e,t){return e[t]}}}),$e=window.wp.apiFetch,We=n.n($e);(0,Ge.createContext)({settings:{},setSettings:function(){console.error("WP Parse.ly: setSettings not implemented")}}),void 0!==(0,Me.select)(He)||(0,Me.register)(Ve);var ze,qe,Ke=function(t){void 0===t&&(t=null);var n="";(null==t?void 0:t.children)&&(n=t.children);var r="content-helper-error-message";return(null==t?void 0:t.className)&&(r+=" "+t.className),(0,e.jsx)("div",{className:r,"data-testid":null==t?void 0:t.testId,dangerouslySetInnerHTML:{__html:n}})},Ze=function(t){var n=t.className,r=t.children;return(0,e.jsx)("main",{className:"parsely-dashboard-page-body"+(n?" "+n:""),children:r})},Ye=function(){return Ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ye.apply(this,arguments)},Je=function(t){var n=t.className,r=t.name,o=t.children,i=t.backgroundColor,a=t.style;return(0,e.jsx)("div",{className:"parsely-menu-page parsely-menu-page-"+r+(n?" "+n:""),style:Ye(Ye({},i?{backgroundColor:i}:{}),a),children:o})},Qe=function(t){var n=t.className,r=t.children;return(0,e.jsx)("header",{className:"parsely-dashboard-page-header"+(n?" "+n:""),children:r})},Xe=window.wp.components,et=window.wp.primitives,tt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})}),nt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M10.6 6L9.4 7l4.6 5-4.6 5 1.2 1 5.4-6z"})}),rt=(ze=function(e,t){return ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ze(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}ze(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});!function(e){e.AccessToFeatureDisabled="ch_access_to_feature_disabled",e.CannotFormulateApiQuery="ch_cannot_formulate_api_query",e.FetchError="fetch_error",e.HttpRequestFailed="http_request_failed",e.ParselyAborted="ch_parsely_aborted",e[e.ParselyApiForbidden=403]="ParselyApiForbidden",e.ParselyApiResponseContainsError="ch_response_contains_error",e.ParselyApiReturnedNoData="ch_parsely_api_returned_no_data",e.ParselyApiReturnedTooManyResults="ch_parsely_api_returned_too_many_results",e.PluginCredentialsNotSetMessageDetected="parsely_credentials_not_set_message_detected",e.PluginSettingsApiSecretNotSet="parsely_api_secret_not_set",e.PluginSettingsSiteIdNotSet="parsely_site_id_not_set",e.PostIsNotPublished="ch_post_not_published",e.UnknownError="ch_unknown_error",e.ParselySuggestionsApiAuthUnavailable="AUTH_UNAVAILABLE",e.ParselySuggestionsApiNoAuthentication="NO_AUTHENTICATION",e.ParselySuggestionsApiNoAuthorization="NO_AUTHORIZATION",e.ParselySuggestionsApiNoData="NO_DATA",e.ParselySuggestionsApiOpenAiError="OPENAI_ERROR",e.ParselySuggestionsApiOpenAiSchema="OPENAI_SCHEMA",e.ParselySuggestionsApiOpenAiUnavailable="OPENAI_UNAVAILABLE",e.ParselySuggestionsApiSchemaError="SCHEMA_ERROR",e.TrafficBoostInboundLinkNotFound="tb_inbound_link_not_found"}(qe||(qe={}));var ot=function(t){function n(e,r,o){void 0===o&&(o=(0,Be.__)("Error:","wp-parsely"));var i=this;e.startsWith(o)&&(o=""),(i=t.call(this,o.length>0?"".concat(o," ").concat(e):e)||this).hint=null,i.name=i.constructor.name,i.code=r;var a=[qe.AccessToFeatureDisabled,qe.ParselyApiForbidden,qe.ParselyApiResponseContainsError,qe.ParselyApiReturnedNoData,qe.ParselyApiReturnedTooManyResults,qe.PluginCredentialsNotSetMessageDetected,qe.PluginSettingsApiSecretNotSet,qe.PluginSettingsSiteIdNotSet,qe.PostIsNotPublished,qe.UnknownError,qe.ParselySuggestionsApiAuthUnavailable,qe.ParselySuggestionsApiNoAuthentication,qe.ParselySuggestionsApiNoAuthorization,qe.ParselySuggestionsApiNoData,qe.ParselySuggestionsApiSchemaError];return i.retryFetch=!a.includes(i.code),Object.setPrototypeOf(i,n.prototype),i.code===qe.AccessToFeatureDisabled?i.message=(0,Be.__)("Access to this feature is disabled by the site's administration.","wp-parsely"):i.code===qe.ParselySuggestionsApiNoAuthorization?i.message=(0,Be.__)('This AI-powered feature is opt-in. To gain access, please submit a request <a href="https://wpvip.com/content-helper/#content-helper-form" target="_blank" rel="noopener">here</a>.',"wp-parsely"):i.code===qe.ParselySuggestionsApiOpenAiError||i.code===qe.ParselySuggestionsApiOpenAiUnavailable?i.message=(0,Be.__)("The Parse.ly API returned an internal server error. Please retry with a different input, or try again later.","wp-parsely"):i.code===qe.HttpRequestFailed&&i.message.includes("cURL error 28")?i.message=(0,Be.__)("The Parse.ly API did not respond in a timely manner. Please try again later.","wp-parsely"):i.code===qe.ParselySuggestionsApiSchemaError?i.message=(0,Be.__)("The Parse.ly API returned a validation error. Please try again with different parameters.","wp-parsely"):i.code===qe.ParselySuggestionsApiNoData?i.message=(0,Be.__)("The Parse.ly API couldn't find any relevant data to fulfill the request. Please retry with a different input.","wp-parsely"):i.code===qe.ParselySuggestionsApiOpenAiSchema?i.message=(0,Be.__)("The Parse.ly API returned an incorrect response. Please try again later.","wp-parsely"):i.code===qe.ParselySuggestionsApiAuthUnavailable&&(i.message=(0,Be.__)("The Parse.ly API is currently unavailable. Please try again later.","wp-parsely")),i}return rt(n,t),n.prototype.Message=function(t){return void 0===t&&(t=null),[qe.PluginCredentialsNotSetMessageDetected,qe.PluginSettingsSiteIdNotSet,qe.PluginSettingsApiSecretNotSet].includes(this.code)?function(t){var n;return void 0===t&&(t=null),(0,e.jsx)(Ke,{className:null==t?void 0:t.className,testId:"empty-credentials-message",children:null!==(n=window.wpParselyEmptyCredentialsMessage)&&void 0!==n?n:(0,Be.__)("Please ensure that the Site ID and API Secret given in the plugin's settings are correct.","wp-parsely")})}(t):(this.code===qe.FetchError&&(this.hint=this.Hint((0,Be.__)("This error can sometimes be caused by ad-blockers or browser tracking protections. Please add this site to any applicable allow lists and try again.","wp-parsely"))),this.code!==qe.ParselyApiForbidden&&this.code!==qe.ParselySuggestionsApiNoAuthentication||(this.hint=this.Hint((0,Be.__)("Please ensure that the Site ID and API Secret given in the plugin's settings are correct.","wp-parsely"))),this.code===qe.HttpRequestFailed&&(this.hint=this.Hint((0,Be.__)("The Parse.ly API cannot be reached. Please verify that you are online.","wp-parsely"))),(0,e.jsx)(Ke,{className:null==t?void 0:t.className,testId:"error",children:"<p>".concat(this.message,"</p>").concat(this.hint?this.hint:"")}))},n.prototype.Hint=function(e){return'<p className="content-helper-error-message-hint" data-testid="content-helper-error-message-hint"><strong>'.concat((0,Be.__)("Hint:","wp-parsely"),"</strong> ").concat(e,"</p>")},n.prototype.createErrorSnackbar=function(){/<a.*?>/.test(this.message)||(0,Me.dispatch)("core/notices").createNotice("error",this.message,{type:"snackbar"})},n}(Error),it=window.wp.url,at=function(){function e(){this.abortControllers=new Map}return e.prototype.cancelRequest=function(e){if(e)(t=this.abortControllers.get(e))&&(t.abort(),this.abortControllers.delete(e));else{var t,n=Array.from(this.abortControllers.keys()).pop();n&&(t=this.abortControllers.get(n))&&(t.abort(),this.abortControllers.delete(n))}},e.prototype.cancelAll=function(){this.abortControllers.forEach((function(e){return e.abort()})),this.abortControllers.clear()},e.prototype.getOrCreateController=function(e){if(e&&this.abortControllers.has(e))return{abortController:this.abortControllers.get(e),abortId:e};var t=null!=e?e:"auto-"+Date.now(),n=new AbortController;return this.abortControllers.set(t,n),{abortController:n,abortId:t}},e.prototype.fetch=function(e,t){return n=this,r=void 0,i=function(){var n,r,o,i,a,s;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}(this,(function(l){switch(l.label){case 0:n=this.getOrCreateController(t),r=n.abortController,o=n.abortId,e.signal=r.signal,l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,We()(e)];case 2:return(i=l.sent()).error?[2,Promise.reject(new ot(i.error.message,qe.ParselyApiResponseContainsError))]:[2,i.data];case 3:return"AbortError"===(a=l.sent()).name?[2,Promise.reject(new ot((0,Be.__)("The operation was aborted.","wp-parsely"),qe.ParselyAborted))]:(s=a.message,"object"==typeof a.message&&a.message[0].msg&&(s=a.message[0].msg),[2,Promise.reject(new ot(s,a.code))]);case 4:return this.abortControllers.delete(o),[7];case 5:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{l(i.next(e))}catch(e){t(e)}}function s(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,s)}l((i=i.apply(n,r||[])).next())}));var n,r,o,i},e}(),st=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),lt=function(){return lt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},lt.apply(this,arguments)},ct=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},ut=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return st(t,e),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.getStats=function(e){return ct(this,void 0,void 0,(function(){var t,n;return ut(this,(function(r){switch(r.label){case 0:t=[],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.fetch({path:(0,it.addQueryArgs)("/wp-parsely/v2/stats/posts",lt({},e))})];case 2:return t=r.sent(),[3,4];case 3:if((n=r.sent())instanceof ot)throw n;if(n instanceof Error)throw new ot(n.message,qe.UnknownError);return[3,4];case 4:if(0===t.length)throw new ot((0,Be.__)("No data was returned by the Parse.ly API.","wp-parsely"),qe.ParselyApiReturnedNoData);return[2,t]}}))}))},t.prototype.getStatsForPosts=function(e,t){return ct(this,void 0,void 0,(function(){var n;return ut(this,(function(r){return n=e.map((function(e){var n,r;return t.use_wp_permalink?e.link:null!==(r=null===(n=e.parsely)||void 0===n?void 0:n.canonical_url)&&void 0!==r?r:e.link})),[2,this.getStats(lt(lt({},t),{urls:n}))]}))}))},t}(at),pt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ft=function(){return ft=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ft.apply(this,arguments)},ht=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},gt=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pt(t,e),t.prototype.apiFetch=function(e,t){return ht(this,void 0,void 0,(function(){var n,r,o,i,a,s,l,c,u,d,p,f;return gt(this,(function(h){switch(h.label){case 0:n=this.getOrCreateController(t),r=n.abortController,o=n.abortId,e.signal=r.signal,e.parse=!1,h.label=1;case 1:return h.trys.push([1,4,6,7]),[4,We()(e)];case 2:return i=h.sent(),a=i.headers.get("X-WP-Total"),s=i.headers.get("X-WP-TotalPages"),l=a?parseInt(a,10):0,c=s?parseInt(s,10):0,[4,i.json()];case 3:return u=h.sent(),[2,{total_items:l,total_pages:c,data:u,response:i}];case 4:return"AbortError"===(d=h.sent()).name?[2,Promise.reject(new ot((0,Be.__)("The operation was aborted.","wp-parsely"),qe.ParselyAborted))]:[4,d.json()];case 5:return p=h.sent(),[2,Promise.reject(new ot(null!==(f=p.message)&&void 0!==f?f:"",p.code,""))];case 6:return this.abortControllers.delete(o),[7];case 7:return[2]}}))}))},t.prototype.fetch=function(e,t){return ht(this,void 0,void 0,(function(){return gt(this,(function(n){switch(n.label){case 0:return[4,this.apiFetch(e,t)];case 1:return[2,n.sent().data]}}))}))},t.prototype.hydratePosts=function(e){return ht(this,void 0,void 0,(function(){var t;return gt(this,(function(n){return t=e.map((function(e){var t,n,r,o,i,a,s,l,c,u,d=[],p=[],f="",h=(null===(n=e._embedded)||void 0===n?void 0:n.author)?e._embedded.author[0]:null;if((null===(r=null==e?void 0:e._embedded)||void 0===r?void 0:r["wp:term"])&&(d=(t=e._embedded["wp:term"])[0],p=t[1]),null===(o=null==e?void 0:e._embedded)||void 0===o?void 0:o["wp:featuredmedia"]){var g=null===(i=e._embedded["wp:featuredmedia"])||void 0===i?void 0:i[0];(f=null===(l=null===(s=null===(a=null==g?void 0:g.media_details)||void 0===a?void 0:a.sizes)||void 0===s?void 0:s.thumbnail)||void 0===l?void 0:l.source_url)||(f=null!==(c=null==g?void 0:g.source_url)&&void 0!==c?c:void 0)}var v=null===(u=e.parsely)||void 0===u?void 0:u.canonical_url;return ft(ft({},e),{thumbnail:f,author:h,categories:d,tags:p,parsely_canonical_url:v})})),[2,t]}))}))},t.prototype.getPosts=function(){return ht(this,arguments,void 0,(function(e,t){var n,r,o,i,a,s;return void 0===e&&(e={}),gt(this,(function(l){switch(l.label){case 0:return n=null!==(a=e.rest_endpoint)&&void 0!==a?a:"/wp/v2/posts",r=null!==(s=e.context)&&void 0!==s?s:"view",[4,this.apiFetch({path:(0,it.addQueryArgs)(n,ft(ft({},e),{_embed:!0,context:r})),method:"GET"},t)];case 1:return o=l.sent(),[4,this.hydratePosts(o.data)];case 2:return i=l.sent(),[2,ft(ft({},o),{data:i})]}}))}))},t.prototype.getPages=function(){return ht(this,arguments,void 0,(function(e,t){var n,r,o,i;return void 0===e&&(e={}),gt(this,(function(a){switch(a.label){case 0:return n=null!==(i=e.context)&&void 0!==i?i:"view",[4,this.apiFetch({path:(0,it.addQueryArgs)("/wp/v2/pages",ft(ft({},e),{_embed:!0,context:n})),method:"GET"},t)];case 1:return r=a.sent(),[4,this.hydratePosts(r.data)];case 2:return o=a.sent(),[2,ft(ft({},r),{data:o})]}}))}))},t.prototype.getPost=function(e,t){return ht(this,void 0,void 0,(function(){var n;return gt(this,(function(r){switch(r.label){case 0:return[4,this.apiFetch({path:"/wp/v2/posts/".concat(e,"?_embed&context=").concat("edit"),method:"GET"},t)];case 1:return n=r.sent(),[4,this.hydratePosts([n.data])];case 2:return[2,r.sent()[0]]}}))}))},t.prototype.fetchFromRestApi=function(e){return ht(this,arguments,void 0,(function(e,t,n){var r;return void 0===t&&(t={}),gt(this,(function(o){return r=ft({path:e,method:"GET"},t),[2,this.apiFetch(r,n)]}))}))},t}(at),mt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mt(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t}(vt),bt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})}),wt=(0,e.jsxs)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,e.jsx)(et.Path,{d:"M15.5 7.5h-7V9h7V7.5Zm-7 3.5h7v1.5h-7V11Zm7 3.5h-7V16h7v-1.5Z"}),(0,e.jsx)(et.Path,{d:"M17 4H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2ZM7 5.5h10a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V6a.5.5 0 0 1 .5-.5Z"})]}),xt=function(t){var n,r,o=t.post,i=t.imageUrl,a=t.icon,s=void 0===a?wt:a,l=t.size,c=void 0===l?100:l,u=t.className,d=void 0===u?"":u,p=null!==(n=null==o?void 0:o.thumbnail)&&void 0!==n?n:i,f=null!==(r=null==o?void 0:o.title.rendered)&&void 0!==r?r:"";return(0,e.jsx)("div",{className:"parsely-thumbnail ".concat(d),style:{width:c,height:c},children:p?(0,e.jsx)("img",{src:p,alt:f,width:c,height:c,loading:"lazy","aria-hidden":""===f}):(0,e.jsx)("div",{className:"parsely-thumbnail-icon-container",children:(0,e.jsx)(Xe.Icon,{icon:s,size:c})})})},kt={month:"short",day:"numeric",year:"numeric"},_t={month:"short",day:"numeric"},St=(0,Be.__)("Date N/A","wp-parsely");var Et,Pt=function(t){var n=t.post,r=n.date?function(e){if(!1===function(e){return!isNaN(+e)&&0!==e.getTime()}(e))return St;var t=kt;return e.getUTCFullYear()===(new Date).getUTCFullYear()&&(t=_t),Intl.DateTimeFormat(document.documentElement.lang||"en",t).format(e)}(new Date(n.date)):"",o=n.title.rendered;return""!==o&&o.length>80&&(o=o.substring(0,80)+"&hellip;"),(0,e.jsxs)("div",{className:"posts-table-post-info",children:[(0,e.jsx)(xt,{post:n,size:45,className:"posts-table-thumbnail"}),(0,e.jsxs)("div",{className:"post-details",children:[(0,e.jsx)("div",{className:"post-title",children:""!==o?(0,e.jsx)("span",{title:n.title.rendered,dangerouslySetInnerHTML:{__html:o}}):(0,Be.__)("(no title)","wp-parsely")}),(0,e.jsxs)("div",{className:"post-meta",children:[(0,e.jsx)("span",{className:"post-date",children:r}),n.author&&(0,e.jsx)("span",{className:"post-author",children:n.author.name}),(0,e.jsx)("div",{className:"post-categories",children:n.categories&&n.categories.length>0&&n.categories.map((function(t){return(0,e.jsx)("span",{children:t.name},t.id)}))})]})]})]})},Lt=function(t){var n=t.post;return(0,e.jsx)(Xe.DropdownMenu,{icon:bt,label:(0,Be.__)("Actions","wp-parsely"),children:function(t){var r=t.onClose;return(0,e.jsxs)(Xe.MenuGroup,{children:[(0,e.jsx)(Xe.MenuItem,{onClick:function(){window.open(n.link,"_blank","noopener,noreferrer"),r()},children:(0,Be.__)("View","wp-parsely")}),(0,e.jsx)(Xe.MenuItem,{onClick:function(){var e;window.open((e=n.id,"/wp-admin/post.php?post=".concat(e,"&action=edit")),"_blank","noopener,noreferrer"),r()},children:(0,Be.__)("Edit","wp-parsely")})]})}})},jt=function(t){var n,r,o,i=t.post,a=t.index,s=t.onPostClick,l=t.stats,c=t.compact,u=t.isLoadingStats,d=t.showStats,p=void 0===d||d,f=t.showActions,h=void 0===f||f,g=t.onErrorLoadingStats,v=(0,Ge.useState)(u),m=v[0],y=v[1],b=null===(n=null==l?void 0:l.views)||void 0===n?void 0:n.replace(/\D/g,""),w=parseInt(null!=b?b:"0",10),x=Number(null!==(o=null===(r=null==l?void 0:l.campaign)||void 0===r?void 0:r.views)&&void 0!==o?o:0),k=w-x,_=k>0?x/k*100:0;return(0,Ge.useEffect)((function(){void 0!==l||u?void 0!==l&&y(!1):(null==g||g(i),y(!0))}),[i,u,l,g]),(0,e.jsxs)("tr",{className:a%2==0?"row-even":"row-odd",onClick:function(){return null==s?void 0:s(i)},children:[(0,e.jsx)("td",{className:"post-info",children:(0,e.jsx)(Pt,{post:i})}),!c&&(0,e.jsxs)(e.Fragment,{children:[p&&(0,e.jsx)("td",{className:"metrics",children:(0,e.jsxs)("div",{className:"metrics-container",children:[m&&(0,e.jsx)(Xe.Spinner,{}),!m&&w>0&&(0,e.jsxs)("div",{className:"metric-views",children:[w.toLocaleString(),x>0&&(0,e.jsxs)("span",{className:"metric-change metric-change-positive",children:["+",x.toLocaleString()]})]}),!m&&_>0&&(0,e.jsx)("div",{className:"metric-boost-percentage",children:/* translators: %f is the boost percentage */ /* translators: %f is the boost percentage */
(0,Be.sprintf)((0,Be.__)("%f%% BOOSTED","wp-parsely"),_.toFixed(1))})]})}),h&&(0,e.jsxs)("td",{className:"actions",children:[(0,e.jsx)("div",{className:"boost-link-container",children:(0,e.jsx)(Ce,{to:{pathname:"/traffic-boost/".concat(i.id)},state:{post:i},children:(0,Be.__)("Boost Traffic","wp-parsely")})}),(0,e.jsx)(Lt,{post:i})]})]})]},i.id)},Tt=function(){return Tt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Tt.apply(this,arguments)},Nt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ct=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},It=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},At=function(t){var n=t.isLoading,r=t.currentPage,o=t.setCurrentPage,i=t.totalPages,a=t.onPrevious,s=t.onNext;return(0,e.jsxs)("div",{className:"posts-table-pagination-controls",children:[n&&(0,e.jsx)(Xe.Spinner,{}),(0,e.jsxs)("div",{className:"page-selector",children:[(0,e.jsx)("span",{children:(0,Be.__)("Page","wp-parsely")}),(0,e.jsx)(Xe.__experimentalNumberControl,{disabled:n,value:r,onChange:function(e){var t=parseInt(null!=e?e:"1",10);t>i?t=i:t<1&&(t=1),o(t)},min:1,max:i,dragDirection:"e"}),(0,e.jsxs)("span",{children:[(0,Be.__)("of","wp-parsely")," ",i]})]}),(0,e.jsxs)("div",{className:"page-navigation",children:[(0,e.jsx)(Xe.Button,{icon:tt,onClick:a,disabled:1===r||n}),(0,e.jsx)(Xe.Button,{icon:nt,onClick:s,disabled:r>=i||n})]})]})},Rt=function(t){var n,r=t.query,o=void 0===r?{}:r,i=t.currentPage,a=t.setCurrentPage,s=t.hideHeader,l=void 0!==s&&s,c=t.hidePagination,u=void 0!==c&&c,d=t.hideLoading,p=void 0!==d&&d,f=t.hideStats,h=void 0!==f&&f,g=t.hideActions,v=void 0!==g&&g,m=t.compact,y=void 0!==m&&m,b=t.noResultsMessage,w=void 0===b?(0,Be.__)("No posts found.","wp-parsely"):b,x=t.className,k=t.onPostClick,_=(0,Ge.useState)([]),S=_[0],E=_[1],P=(0,Ge.useState)([]),L=P[0],j=P[1],T=(0,Ge.useState)(1),N=T[0],C=T[1],I=(0,Ge.useState)(null!==(n=o.per_page)&&void 0!==n?n:10)[0],A=(0,Ge.useState)(!0),R=A[0],O=A[1],D=(0,Ge.useState)(!0),G=D[0],B=D[1],M=(0,Ge.useState)(),F=M[0],U=M[1],H=(0,Ge.useRef)(!1);(0,Ge.useEffect)((function(){O(!0),B(!0),Nt(void 0,void 0,void 0,(function(){var e,t,n;return Ct(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,5,6]),[4,yt.getInstance().getPosts(Tt(Tt({context:"embed"},o),{per_page:I,page:i}))];case 1:return e=r.sent(),h?[3,3]:[4,dt.getInstance().getStatsForPosts(e.data,{limit:e.data.length,period_start:"30d",page:1,campaign_id:"wp-parsely",campaign_medium:"smart-link"})];case 2:t=r.sent(),j(t),r.label=3;case 3:return E(e.data),C(e.total_pages),H.current=!0,[3,6];case 4:return n=r.sent(),console.error(n),n instanceof ot&&U(n),n instanceof Error&&U(new ot(n.message,qe.UnknownError)),[3,6];case 5:return O(!1),B(!1),[7];case 6:return[2]}}))}))}),[i,I,o,h]);var V=(0,Ge.useCallback)((function(e){return Nt(void 0,void 0,void 0,(function(){var t,n;return Ct(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,dt.getInstance().getStatsForPosts([e],{limit:1,period_start:"30d",page:1,campaign_id:"wp-parsely",campaign_medium:"smart-link",use_wp_permalink:!0})];case 1:return t=r.sent(),j((function(e){return It(It([],e,!0),[t[0]],!1)})),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}}))}))}),[]),$=(0,Ge.useCallback)((function(e){return L.find((function(t){return t.postId===e.id}))}),[L]),W=["parsely-table-container"];return x&&W.push(x),R&&p&&!H.current?(0,e.jsx)(e.Fragment,{}):R&&!p&&0===S.length?(W.push("is-loading"),(0,e.jsx)("div",{className:W.join(" "),children:(0,e.jsx)(Xe.Spinner,{})})):F&&F.code!==qe.ParselyApiReturnedNoData?(0,e.jsx)("div",{className:"parsely-table-container no-results",children:F.Message()}):0===S.length?(0,e.jsx)("div",{className:"parsely-table-container no-results",children:w}):(l&&W.push("hide-header"),u&&W.push("hide-pagination"),y&&W.push("compact"),(0,e.jsxs)("div",{className:W.join(" "),children:[(0,e.jsxs)("table",{className:W.join(" "),children:[!l&&(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{scope:"col",className:"post-info-header",children:(0,Be.__)("POST","wp-parsely")}),!y&&(0,e.jsxs)("th",{scope:"col",className:"views-header",children:[(0,Be.__)("VIEWS","wp-parsely"),(0,e.jsx)("span",{className:"views-header-period",children:(0,Be.__)("(30 days)","wp-parsely")})]})]})}),(0,e.jsx)("tbody",{children:S.map((function(t,n){return(0,e.jsx)(jt,{post:t,stats:$(t),isLoadingStats:G,index:n,onPostClick:k,compact:y,showStats:!h,showActions:!v,onErrorLoadingStats:V},t.id)}))})]}),!u&&(0,e.jsx)(At,{isLoading:R,currentPage:i,setCurrentPage:a,totalPages:N,onPrevious:function(){a((function(e){return Math.max(e-1,1)}))},onNext:function(){a((function(e){return e+1}))}})]}))},Ot=window.wp.compose,Dt=function(){var t=(0,Ge.useState)(""),n=t[0],r=t[1],o=(0,Ot.useDebounce)((function(e){r(e),s(1)}),300),i=(0,Ge.useState)(1),a=i[0],s=i[1];return(0,e.jsxs)(Je,{name:"traffic-boost",children:[(0,e.jsx)(Qe,{children:(0,e.jsx)("h1",{children:(0,Be.__)("Manage Traffic Boost (beta)","wp-parsely")})}),(0,e.jsxs)(Ze,{children:[(0,e.jsx)("div",{className:"traffic-boost-search-container",children:(0,e.jsx)(Xe.SearchControl,{value:n,onChange:o,label:(0,Be.__)("Search","wp-parsely"),placeholder:(0,Be.__)("Search","wp-parsely"),__nextHasNoMarginBottom:!0})}),(0,e.jsx)(Rt,{currentPage:a,setCurrentPage:s,query:{status:"publish",per_page:10,search:n,search_columns:["post_title","post_excerpt"]}})]})]})},Gt=function(){return(0,e.jsxs)(Je,{name:"settings",children:[(0,e.jsx)(Qe,{children:(0,e.jsx)("h1",{children:"Parse.ly Settings"})}),(0,e.jsx)(Ze,{children:(0,e.jsx)("p",{children:"This is a page for settings."})})]})},Bt=(0,e.jsx)(et.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,e.jsx)(et.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12.218 5.377a.25.25 0 0 0-.436 0l-7.29 12.96a.25.25 0 0 0 .218.373h14.58a.25.25 0 0 0 .218-.372l-7.29-12.96Zm-1.743-.735c.669-1.19 2.381-1.19 3.05 0l7.29 12.96a1.75 1.75 0 0 1-1.525 2.608H4.71a1.75 1.75 0 0 1-1.525-2.608l7.29-12.96ZM12.75 17.46h-1.5v-1.5h1.5v1.5Zm-1.5-3h1.5v-5h-1.5v5Z"})}),Mt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})}),Ft=window.wp.notices,Ut=function(){return Ut=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ut.apply(this,arguments)},Ht=function(t){var n=t.className,r=(0,Me.useSelect)((function(e){return e(Ft.store).getNotices().filter((function(e){return"snackbar"===e.type})).map((function(e){var t;return Ut(Ut({},e),{actions:null===(t=e.actions)||void 0===t?void 0:t.map((function(e){var t,n;return Ut(Ut({},e),{url:null!==(t=e.url)&&void 0!==t?t:void 0,onClick:null!==(n=e.onClick)&&void 0!==n?n:void 0})}))})}))}),[]),o=(0,Me.useDispatch)(Ft.store).removeNotice,i=["wp-parsely-snackbar-notices"];return n&&i.push(n),(0,e.jsx)("div",{className:i.join(" "),children:(0,e.jsx)(Xe.SnackbarList,{notices:r,onRemove:function(e){return o(e)}})})},Vt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})}),$t=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M17.031 4.703 15.576 4l-1.56 3H14v.03l-2.324 4.47H9.5V13h1.396l-1.502 2.889h-.95a3.694 3.694 0 0 1 0-7.389H10V7H8.444a5.194 5.194 0 1 0 0 10.389h.17L7.5 19.53l1.416.719L15.049 8.5h.507a3.694 3.694 0 0 1 0 7.39H14v1.5h1.556a5.194 5.194 0 0 0 .273-10.383l1.202-2.304Z"})}),Wt=function(){return Wt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Wt.apply(this,arguments)},zt=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};!function(e){e.SUGGESTIONS="suggestions",e.INBOUND_LINKS="inbound-links",e.SETTINGS="settings"}(Et||(Et={}));var qt={loading:[],error:null,currentPost:null,selectedTab:Et.SUGGESTIONS,selectedLink:null,preview:{selectedLinkType:null,frontendPreview:!1},suggestionsTab:{suggestions:[],suggestionsToGenerate:0},inboundLinksTab:{links:[],currentPage:1,itemsPerPage:0},acceptingLinks:[],removingLinks:[],generatingLinks:[],isGeneratingSuggestions:!1,settings:{maxItems:10}},Kt=(0,Me.createReduxStore)("wp-parsely/traffic-boost",{initialState:qt,reducer:function(e,t){var n,r,o,i,a,s,l,c;switch(void 0===e&&(e=qt),t.type){case"SET_LOADING":return t.loadingType||(t.loadingType="default"),Wt(Wt({},e),{loading:t.isLoading?zt(zt([],e.loading,!0),[t.loadingType],!1):e.loading.filter((function(e){return e!==t.loadingType}))});case"SET_ERROR":return Wt(Wt({},e),{error:t.error});case"SET_CURRENT_HYDRATED_POST":return Wt(Wt({},e),{currentPost:t.post});case"SET_SELECTED_TAB":return Wt(Wt({},e),{selectedTab:t.tab});case"SET_SUGGESTIONS":return Wt(Wt({},e),{suggestionsTab:Wt(Wt({},e.suggestionsTab),{suggestions:t.discardPrevious?t.suggestions:zt(zt([],e.suggestionsTab.suggestions,!0),t.suggestions,!0)})});case"SET_INBOUND_LINKS":return Wt(Wt({},e),{inboundLinksTab:Wt(Wt({},e.inboundLinksTab),{links:t.links})});case"SET_INBOUND_LINKS_PAGE":return Wt(Wt({},e),{inboundLinksTab:Wt(Wt({},e.inboundLinksTab),{currentPage:t.page})});case"SET_INBOUND_LINKS_ITEMS_PER_PAGE":return Wt(Wt({},e),{inboundLinksTab:Wt(Wt({},e.inboundLinksTab),{itemsPerPage:t.itemsPerPage})});case"SET_SELECTED_LINK":return Wt(Wt({},e),{selectedLink:t.link});case"SET_PREVIEW_LINK_TYPE":return Wt(Wt({},e),{preview:Wt(Wt({},e.preview),{selectedLinkType:t.linkType})});case"SET_FRONTEND_PREVIEW":return Wt(Wt({},e),{preview:Wt(Wt({},e.preview),{frontendPreview:t.enabled})});case"ADD_SUGGESTION":return Wt(Wt({},e),{suggestionsTab:Wt(Wt({},e.suggestionsTab),{suggestions:zt([t.suggestion],e.suggestionsTab.suggestions,!0)}),selectedLink:t.select?t.suggestion:e.selectedLink});case"REMOVE_SUGGESTION":var u=e.suggestionsTab.suggestions.filter((function(e){return e.uid!==t.suggestion.uid}));return Wt(Wt({},e),{suggestionsTab:Wt(Wt({},e.suggestionsTab),{suggestions:u}),selectedLink:t.updateSelectedLink&&(null===(n=e.selectedLink)||void 0===n?void 0:n.uid)===t.suggestion.uid?null!==(r=u[0])&&void 0!==r?r:null:e.selectedLink});case"ADD_INBOUND_LINK":return Wt(Wt({},e),{inboundLinksTab:Wt(Wt({},e.inboundLinksTab),{links:zt([t.link],e.inboundLinksTab.links,!0)}),selectedLink:t.select?t.link:e.selectedLink});case"REMOVE_INBOUND_LINK":var d=e.inboundLinksTab.links.filter((function(e){return e.uid!==t.link.uid}));return Wt(Wt({},e),{inboundLinksTab:Wt(Wt({},e.inboundLinksTab),{links:d}),selectedLink:t.updateSelectedLink&&(null===(o=e.selectedLink)||void 0===o?void 0:o.uid)===t.link.uid?null!==(i=d[0])&&void 0!==i?i:null:e.selectedLink});case"UPDATE_SUGGESTION":var p=null!==(a=t.uid)&&void 0!==a?a:t.suggestion.uid,f=e.suggestionsTab.suggestions.map((function(e){return e.uid===p?t.suggestion:e})),h=(null===(s=e.selectedLink)||void 0===s?void 0:s.uid)===p?t.suggestion:e.selectedLink;return Wt(Wt({},e),{suggestionsTab:Wt(Wt({},e.suggestionsTab),{suggestions:f}),selectedLink:h});case"UPDATE_INBOUND_LINK":var g=null!==(l=t.uid)&&void 0!==l?l:t.link.uid,v=e.inboundLinksTab.links.map((function(e){return e.uid===g?t.link:e}));return h=(null===(c=e.selectedLink)||void 0===c?void 0:c.uid)===g?t.link:e.selectedLink,Wt(Wt({},e),{inboundLinksTab:Wt(Wt({},e.inboundLinksTab),{links:v}),selectedLink:h});case"SET_IS_ACCEPTING":return Wt(Wt({},e),{acceptingLinks:t.value?zt(zt([],e.acceptingLinks,!0),[t.link.uid],!1):e.acceptingLinks.filter((function(e){return e!==t.link.uid}))});case"SET_IS_REMOVING":return Wt(Wt({},e),{removingLinks:t.value?zt(zt([],e.removingLinks,!0),[t.link.uid],!1):e.removingLinks.filter((function(e){return e!==t.link.uid}))});case"SET_IS_GENERATING_SUGGESTIONS":return Wt(Wt({},e),{isGeneratingSuggestions:t.value});case"SET_IS_GENERATING":return Wt(Wt({},e),{generatingLinks:t.value?zt(zt([],e.generatingLinks,!0),[t.link.uid],!1):e.generatingLinks.filter((function(e){return e!==t.link.uid}))});case"SET_SETTINGS":return Wt(Wt({},e),{settings:Wt(Wt({},e.settings),t.settings)});case"SET_SUGGESTIONS_TO_GENERATE":return Wt(Wt({},e),{suggestionsTab:Wt(Wt({},e.suggestionsTab),{suggestionsToGenerate:"function"==typeof t.count?t.count(e.suggestionsTab.suggestionsToGenerate):t.count})});default:return e}},actions:{setLoading:function(e,t){return void 0===t&&(t="default"),{type:"SET_LOADING",isLoading:e,loadingType:t}},setError:function(e){return{type:"SET_ERROR",error:e}},setCurrentPost:function(e){return{type:"SET_CURRENT_HYDRATED_POST",post:e}},setSelectedTab:function(e){return{type:"SET_SELECTED_TAB",tab:e}},setSuggestions:function(e,t){return void 0===t&&(t=!0),{type:"SET_SUGGESTIONS",suggestions:e,discardPrevious:t}},setInboundLinks:function(e){return{type:"SET_INBOUND_LINKS",links:e}},setInboundLinksPage:function(e){return{type:"SET_INBOUND_LINKS_PAGE",page:e}},setInboundLinksItemsPerPage:function(e){return{type:"SET_INBOUND_LINKS_ITEMS_PER_PAGE",itemsPerPage:e}},setSelectedLink:function(e){return{type:"SET_SELECTED_LINK",link:e}},setPreviewLinkType:function(e){return{type:"SET_PREVIEW_LINK_TYPE",linkType:e}},setFrontendPreview:function(e){return{type:"SET_FRONTEND_PREVIEW",enabled:e}},addSuggestion:function(e,t){return void 0===t&&(t=!0),{type:"ADD_SUGGESTION",suggestion:e,select:t}},removeSuggestion:function(e,t){return void 0===t&&(t=!0),{type:"REMOVE_SUGGESTION",suggestion:e,updateSelectedLink:t}},addInboundLink:function(e,t){return void 0===t&&(t=!0),{type:"ADD_INBOUND_LINK",link:e,select:t}},removeInboundLink:function(e,t){return void 0===t&&(t=!0),{type:"REMOVE_INBOUND_LINK",link:e,updateSelectedLink:t}},updateSuggestion:function(e,t){return{type:"UPDATE_SUGGESTION",suggestion:e,uid:t}},updateInboundLink:function(e,t){return{type:"UPDATE_INBOUND_LINK",link:e,uid:t}},setIsAccepting:function(e,t){return{type:"SET_IS_ACCEPTING",link:e,value:t}},setIsRemoving:function(e,t){return{type:"SET_IS_REMOVING",link:e,value:t}},setIsGeneratingSuggestions:function(e){return{type:"SET_IS_GENERATING_SUGGESTIONS",value:e}},setIsGenerating:function(e,t){return{type:"SET_IS_GENERATING",link:e,value:t}},setSettings:function(e){return{type:"SET_SETTINGS",settings:e}},setSuggestionsToGenerate:function(e){return{type:"SET_SUGGESTIONS_TO_GENERATE",count:e}}},selectors:{isLoading:function(e){return e.loading.length>0},isLoadingSuggestions:function(e){return e.loading.includes("suggestions")},isLoadingInboundLinks:function(e){return e.loading.includes("inbound-links")},isLoadingPost:function(e){return e.loading.includes("post")},getError:function(e){return e.error},getCurrentPost:function(e){return e.currentPost},getSelectedTab:function(e){return e.selectedTab},getSuggestions:function(e){return e.suggestionsTab.suggestions},getInboundLinks:function(e){return e.inboundLinksTab.links},getInboundLinksPage:function(e){return e.inboundLinksTab.currentPage},getInboundLinksItemsPerPage:function(e){return e.inboundLinksTab.itemsPerPage},isSuggestionsLoading:function(e){return e.loading.includes("suggestions")},getSelectedLink:function(e){return e.selectedLink},getPreviewLinkType:function(e){return e.preview.selectedLinkType},isFrontendPreview:function(e){return e.preview.frontendPreview},isAccepting:function(e,t){return e.acceptingLinks.includes(t.uid)},isRemoving:function(e,t){return e.removingLinks.includes(t.uid)},isGeneratingSuggestions:function(e){return e.isGeneratingSuggestions},isGenerating:function(e,t){return e.generatingLinks.includes(t.uid)},getSettings:function(e){return e.settings},getSuggestionsToGenerate:function(e){return e.suggestionsTab.suggestionsToGenerate},hasSuggestions:function(e){return e.suggestionsTab.suggestions.length>0}}});(0,Me.register)(Kt);var Zt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),Yt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),Jt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"})}),Qt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M18.3 11.7c-.6-.6-1.4-.9-2.3-.9H6.7l2.9-3.3-1.1-1-4.5 5L8.5 16l1-1-2.7-2.7H16c.5 0 .9.2 1.3.5 1 1 1 3.4 1 4.5v.3h1.5v-.2c0-1.5 0-4.3-1.5-5.7z"})}),Xt=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"m14.5 6.5-1 1 3.7 3.7H4v1.6h13.2l-3.7 3.7 1 1 5.6-5.5z"})}),en=function(t){var n=t.size,r=void 0===n?40:n;return(0,e.jsx)(Xe.SVG,{xmlns:"http://www.w3.org/2000/svg",width:"1",height:r,viewBox:"0 0 1 ".concat(r),fill:"none",children:(0,e.jsx)(Xe.Rect,{width:"1",height:r,fill:"#cccccc"})})},tn=function(t){var n,r,o=t.activeLink,i=t.onAccept,a=t.onUpdateLink,s=t.onDiscard,l=t.onNext,c=t.onPrevious,u=t.onRemove,d=t.totalItems,p=t.itemIndex,f=t.onRestoreOriginal,h=t.selectedText,g=!(null==o?void 0:o.isSuggestion),v=p<d,m=p>1,y=(0,Ge.useState)(!0),b=y[0],w=y[1],x=(0,Me.useSelect)((function(e){return{isAccepting:!!o&&e(Kt).isAccepting(o),isRemoving:!!o&&e(Kt).isRemoving(o),isGenerating:!!o&&e(Kt).isGenerating(o)}}),[o]),k=x.isAccepting,_=x.isRemoving,S=x.isGenerating;return o?(0,e.jsxs)("div",{className:"traffic-boost-preview-footer",children:[(0,e.jsx)("div",{className:"traffic-boost-preview-footer-previous",children:m&&(0,e.jsx)(Xe.Button,{variant:"tertiary",onClick:c,icon:Zt,showTooltip:!0,label:(0,Be.__)("Previous Suggested Source","wp-parsely")})}),!S&&(0,e.jsxs)("div",{className:"traffic-boost-preview-footer-actions",children:[!g&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Xe.Button,{variant:"primary",onClick:function(){return i(o)},isBusy:k,disabled:k,icon:k?null:Yt,children:k?(0,Be.__)("Accepting…","wp-parsely"):(0,Be.__)("Accept","wp-parsely")}),(0,e.jsx)(Xe.Button,{variant:"tertiary",onClick:function(){return s(o)},icon:Jt,children:(0,Be.__)("Reject","wp-parsely")}),h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(en,{size:36}),(0,e.jsx)(Xe.Button,{variant:"tertiary",onClick:f,icon:Qt,children:(0,Be.__)("Clear changes","wp-parsely")})]})]}),g&&(0,e.jsx)(e.Fragment,{children:h?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Xe.Button,{variant:"primary",onClick:function(){return a(o,b)},isBusy:k,disabled:k,icon:k?null:Yt,children:k?(0,Be.__)("Updating…","wp-parsely"):(0,Be.__)("Update Link","wp-parsely")}),(null===(n=o.smartLink)||void 0===n?void 0:n.is_link_replacement)&&(0,e.jsx)(Xe.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,Be.__)("Restore original link?","wp-parsely"),checked:b,onChange:function(e){w(e)}}),(0,e.jsx)(en,{size:36}),(0,e.jsx)(Xe.Button,{variant:"tertiary",onClick:f,icon:Qt,children:(0,Be.__)("Clear changes","wp-parsely")})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Xe.Button,{variant:_?"primary":"tertiary",icon:_?null:Jt,onClick:function(){return u(o,b)},isBusy:_,disabled:_,isDestructive:!0,children:_?(0,Be.__)("Removing…","wp-parsely"):(0,Be.__)("Remove Link","wp-parsely")}),(null===(r=o.smartLink)||void 0===r?void 0:r.is_link_replacement)&&(0,e.jsx)(Xe.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,Be.__)("Restore original link?","wp-parsely"),checked:b,onChange:function(e){w(e)}})]})})]}),(0,e.jsx)("div",{className:"traffic-boost-preview-footer-next",children:v&&(0,e.jsx)(Xe.Button,{variant:"tertiary",onClick:l,icon:Xt,showTooltip:!0,label:(0,Be.__)("Next Suggested Source","wp-parsely")})})]}):(0,e.jsx)(e.Fragment,{})},nn=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),rn=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),on=function(t){var n=t.size,r=void 0===n?24:n,o=t.className,i=void 0===o?"wp-parsely-icon":o;return(0,e.jsxs)(Xe.SVG,{className:i,height:r,viewBox:"0 0 60 65",width:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,e.jsx)(Xe.Path,{fill:"#5ba745",d:"M23.72,51.53c0-.18,0-.34-.06-.52a13.11,13.11,0,0,0-2.1-5.53A14.74,14.74,0,0,0,19.12,43c-.27-.21-.5-.11-.51.22l-.24,3.42c0,.33-.38.35-.49,0l-1.5-4.8a1.4,1.4,0,0,0-.77-.78,23.91,23.91,0,0,0-3.1-.84c-1.38-.24-3.39-.39-3.39-.39-.34,0-.45.21-.25.49l2.06,3.76c.2.27,0,.54-.29.33l-4.51-3.6a3.68,3.68,0,0,0-2.86-.48c-1,.16-2.44.46-2.44.46a.68.68,0,0,0-.39.25.73.73,0,0,0-.14.45S.41,43,.54,44a3.63,3.63,0,0,0,1.25,2.62L6.48,50c.28.2.09.49-.23.37l-4.18-.94c-.32-.12-.5,0-.4.37,0,0,.69,1.89,1.31,3.16a24,24,0,0,0,1.66,2.74,1.34,1.34,0,0,0,1,.52l5,.13c.33,0,.41.38.1.48L7.51,58c-.31.1-.34.35-.07.55a14.29,14.29,0,0,0,3.05,1.66,13.09,13.09,0,0,0,5.9.5,25.13,25.13,0,0,0,4.34-1,9.55,9.55,0,0,1-.08-1.2,9.32,9.32,0,0,1,3.07-6.91"}),(0,e.jsx)(Xe.Path,{fill:"#5ba745",d:"M59.7,41.53a.73.73,0,0,0-.14-.45.68.68,0,0,0-.39-.25s-1.43-.3-2.44-.46a3.64,3.64,0,0,0-2.86.48l-4.51,3.6c-.26.21-.49-.06-.29-.33l2.06-3.76c.2-.28.09-.49-.25-.49,0,0-2,.15-3.39.39a23.91,23.91,0,0,0-3.1.84,1.4,1.4,0,0,0-.77.78l-1.5,4.8c-.11.32-.48.3-.49,0l-.24-3.42c0-.33-.24-.43-.51-.22a14.74,14.74,0,0,0-2.44,2.47A13.11,13.11,0,0,0,36.34,51c0,.18,0,.34-.06.52a9.26,9.26,0,0,1,3,8.1,24.1,24.1,0,0,0,4.34,1,13.09,13.09,0,0,0,5.9-.5,14.29,14.29,0,0,0,3.05-1.66c.27-.2.24-.45-.07-.55l-3.22-1.17c-.31-.1-.23-.47.1-.48l5-.13a1.38,1.38,0,0,0,1-.52A24.6,24.6,0,0,0,57,52.92c.61-1.27,1.31-3.16,1.31-3.16.1-.33-.08-.49-.4-.37l-4.18.94c-.32.12-.51-.17-.23-.37l4.69-3.34A3.63,3.63,0,0,0,59.46,44c.13-1,.24-2.47.24-2.47"}),(0,e.jsx)(Xe.Path,{fill:"#5ba745",d:"M46.5,25.61c0-.53-.35-.72-.8-.43l-4.86,2.66c-.45.28-.56-.27-.23-.69l4.66-6.23a2,2,0,0,0,.28-1.68,36.51,36.51,0,0,0-2.19-4.89,34,34,0,0,0-2.81-3.94c-.33-.41-.74-.35-.91.16l-2.28,5.68c-.16.5-.6.48-.59-.05l.28-8.93a2.54,2.54,0,0,0-.66-1.64S35,4.27,33.88,3.27,30.78.69,30.78.69a1.29,1.29,0,0,0-1.54,0s-1.88,1.49-3.12,2.59-2.48,2.35-2.48,2.35A2.5,2.5,0,0,0,23,7.27l.27,8.93c0,.53-.41.55-.58.05l-2.29-5.69c-.17-.5-.57-.56-.91-.14a35.77,35.77,0,0,0-3,4.2,35.55,35.55,0,0,0-2,4.62,2,2,0,0,0,.27,1.67l4.67,6.24c.33.42.23,1-.22.69l-4.87-2.66c-.45-.29-.82-.1-.82.43a18.6,18.6,0,0,0,.83,5.07,20.16,20.16,0,0,0,5.37,7.77c3.19,3,5.93,7.8,7.45,11.08A9.6,9.6,0,0,1,30,49.09a9.31,9.31,0,0,1,2.86.45c1.52-3.28,4.26-8.11,7.44-11.09a20.46,20.46,0,0,0,5.09-7,19,19,0,0,0,1.11-5.82"}),(0,e.jsx)(Xe.Path,{fill:"#5ba745",d:"M36.12,58.44A6.12,6.12,0,1,1,30,52.32a6.11,6.11,0,0,1,6.12,6.12"})]})},an=function(e){try{var t=new URL(e.targetPost.link),n=new URL(window.location.href);return t.hostname!==n.hostname}catch(e){return!0}},sn=function(e){var t=e.querySelector(".".concat("wp-parsely-preview-marker"));return t&&t.parentElement||null},ln=function(t){var n=t.post,r=t.onLinkTypeClick,o=t.selectedLinkType,i=(0,Ge.useState)(o),a=i[0],s=i[1],l=(0,Ge.useState)({external:0,internal:0,smart:0}),c=l[0],u=l[1],d=(0,Me.useDispatch)(Kt).setPreviewLinkType;(0,Ge.useEffect)((function(){var e=n.content.raw,t=new URL(n.link).hostname,r=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("a"),o=Array.from(r).filter((function(e){var t;return""!==(null===(t=e.textContent)||void 0===t?void 0:t.trim())})),i=o.filter((function(e){return e.hasAttribute("data-smartlink")})),a=o.filter((function(e){return e.href.includes(t)})),s=o.filter((function(e){return!e.href.includes(t)}));u({external:s.length,internal:a.length,smart:i.length})}),[n]),(0,Ge.useEffect)((function(){s(o),d(o)}),[o,d]);var p=function(e){var t=e;a===e&&(t=null),s(t),d(t),null==r||r(t)},f=function(e){return a===e},h=c.external+c.internal+c.smart;return(0,e.jsxs)("div",{className:"traffic-boost-preview-info-links",children:[(0,e.jsx)("div",{className:"traffic-boost-preview-info-links-summary",children:h>0?(0,e.jsx)(e.Fragment,{children:(0,Be.sprintf)(/* translators: %d: number of outbound links */ /* translators: %d: number of outbound links */
(0,Be.__)("Contains %d outbound links:","wp-parsely"),h)}):(0,e.jsx)(e.Fragment,{children:(0,Be.__)("This post has no outbound links.","wp-parsely")})}),(0,e.jsxs)("div",{className:"traffic-boost-preview-info-links-counter",children:[c.external>0&&(0,e.jsx)(Xe.Button,{variant:"secondary",isPressed:f("external"),onClick:function(){return p("external")},children:(0,Be.sprintf)(/* translators: %d: number of outbound links */ /* translators: %d: number of outbound links */
(0,Be.__)("%d external","wp-parsely"),c.external)}),c.internal>0&&(0,e.jsx)(Xe.Button,{variant:"secondary",isPressed:f("internal"),onClick:function(){return p("internal")},children:(0,Be.sprintf)(/* translators: %d: number of internal links */ /* translators: %d: number of internal links */
(0,Be.__)("%d internal","wp-parsely"),c.internal)}),c.smart>0&&(0,e.jsx)(Xe.Button,{variant:"secondary",isPressed:f("smart"),onClick:function(){return p("smart")},children:(0,Be.sprintf)(/* translators: %d: number of smart links */ /* translators: %d: number of smart links */
(0,Be.__)("%d Smart Links","wp-parsely"),c.smart)})]})]})},cn=function(t){var n=t.post,r=t.onEditClick,o=t.onViewInNewTabClick,i=t.onViewInParseLyClick,a=function(e,t){switch(e){case"edit":r(n);break;case"view-in-new-tab":o(n);break;case"view-in-parse-ly":i(n)}t()};return(0,e.jsx)(Xe.DropdownMenu,{icon:bt,iconSize:24,label:(0,Be.__)("Actions","wp-parsely"),children:function(t){var n=t.onClose;return(0,e.jsxs)(Xe.MenuGroup,{children:[(0,e.jsx)(Xe.MenuItem,{icon:nn,onClick:function(){return a("edit",n)},children:(0,Be.__)("Edit Post","wp-parsely")}),(0,e.jsx)(Xe.MenuItem,{icon:rn,onClick:function(){return a("view-in-new-tab",n)},children:(0,Be.__)("View post in a new tab","wp-parsely")}),(0,e.jsx)(Xe.MenuItem,{icon:(0,e.jsx)(on,{}),onClick:function(){return a("view-in-parse-ly",n)},children:(0,Be.__)("View in Parse.ly","wp-parsely")})]})}})},un=function(t){t.isLoading;var n,r=t.activeLink,o=(t.isFrontendPreview,t.setIsFrontendPreview),i=t.onOpenPostEditor,a=t.onOpenPostInNewTab,s=t.onOpenParselyDashboard;return(0,Ge.useEffect)((function(){r&&an(r)&&o(!1)}),[r,o]),r?(0,e.jsxs)("div",{className:"traffic-boost-preview-header",children:[(0,e.jsxs)("div",{className:"traffic-boost-preview-info",children:[(0,e.jsx)("div",{className:"traffic-boost-preview-info-title",children:(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:null===(n=null==r?void 0:r.targetPost)||void 0===n?void 0:n.title.rendered}})}),(0,e.jsx)(ln,{post:r.targetPost,selectedLinkType:null})]}),(0,e.jsxs)("div",{className:"traffic-boost-preview-actions",children:[!an(r)&&!1,(0,e.jsx)(cn,{post:r.targetPost,onEditClick:i,onViewInNewTabClick:a,onViewInParseLyClick:s})]})]}):(0,e.jsx)(e.Fragment,{})},dn=function(t){var n=t.message,r=(0,Ge.useState)(""),o=r[0],i=r[1],a=(0,Ge.useState)(0),s=a[0],l=a[1],c=(0,Ge.useState)(!0),u=c[0],d=c[1];return(0,Ge.useEffect)((function(){i(""),l(0),d(!0)}),[n]),(0,Ge.useEffect)((function(){if(u&&s<n.length){var e=setTimeout((function(){i((function(e){return e+n.charAt(s)})),l((function(e){return e+1}))}),50);return function(){return clearTimeout(e)}}}),[s,u,n]),(0,e.jsx)("div",{className:"wp-parsely-typewriter-text",children:o})},pn=function(t){var n=t.className,r=void 0===n?"":n,o=t.loading,i=void 0===o||o,a=t.showSpinner,s=void 0===a||a,l=t.randomOrder,c=void 0!==l&&l,u=t.messages,d=void 0===u?[(0,Be.__)("Loading…","wp-parsely")]:u,p=t.children,f=t.typewriter,h=void 0!==f&&f,g=(0,Ge.useState)(""),v=g[0],m=g[1],y=(0,Ge.useState)(0),b=y[0],w=y[1];return(0,Ge.useEffect)((function(){if(i){""===v&&m(d[c?Math.floor(Math.random()*d.length):0]);var e=100*v.length,t=setInterval((function(){if(c){var e=void 0;do{e=Math.floor(Math.random()*d.length)}while(d.length>1&&e===b);w(e),m(d[e])}else e=(b+1)%d.length,w(e),m(d[e])}),e);return function(){return clearInterval(t)}}}),[i,d,b,v,c]),(0,e.jsxs)("div",{className:"wp-parsely-loading ".concat(r),children:[s&&(0,e.jsx)(Xe.Spinner,{}),(0,e.jsx)("div",{className:"wp-parsely-loading-message",children:p||(0,e.jsx)(e.Fragment,{children:h?(0,e.jsx)(dn,{message:v}):v})})]})},fn=function(){return(0,e.jsx)(et.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48","aria-hidden":"true",focusable:"false",children:(0,e.jsx)(et.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12.218 5.377a.25.25 0 0 0-.436 0l-7.29 12.96a.25.25 0 0 0 .218.373h14.58a.25.25 0 0 0 .218-.372l-7.29-12.96Zm-1.743-.735c.669-1.19 2.381-1.19 3.05 0l7.29 12.96a1.75 1.75 0 0 1-1.525 2.608H4.71a1.75 1.75 0 0 1-1.525-2.608l7.29-12.96ZM12.75 17.46h-1.5v-1.5h1.5v1.5Zm-1.5-3h1.5v-5h-1.5v5Z"})})},hn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),gn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},vn=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},mn=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},yn=[(0,Be.__)("Analyzing your content…","wp-parsely"),(0,Be.__)("Searching for posts with related topics…","wp-parsely"),(0,Be.__)("Detecting and removing low relevancy suggestions…","wp-parsely"),(0,Be.__)("Performing additional filtering…","wp-parsely"),(0,Be.__)("Checking if extra processing is needed…","wp-parsely")],bn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hn(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getExistingSuggestions=function(e){return gn(this,void 0,void 0,(function(){var t,n;return vn(this,(function(r){switch(r.label){case 0:return[4,this.fetch({method:"GET",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/get-suggestions")})];case 1:return t=r.sent(),n=t.data.map((function(e){var t;return null===(t=e.source)||void 0===t?void 0:t.post_id})),0===n.length?[2,[]]:[2,this.createTrafficBoostLinks(t.data)]}}))}))},t.prototype.generateBatchSuggestions=function(e,t,n){return gn(this,void 0,void 0,(function(){var r,o,i,a,s,l,c,u,d,p,f,h,g,v,m;return vn(this,(function(y){switch(y.label){case 0:r=null!==(f=null==n?void 0:n.maxItemsPerBatch)&&void 0!==f?f:Math.min(t,5),o=null!==(h=null==n?void 0:n.maxRetries)&&void 0!==h?h:3,i=0,a=[],s=null!==(g=null==n?void 0:n.urlExclusionList)&&void 0!==g?g:[],y.label=1;case 1:if(!(i<t))return[3,6];if(l=0===i&&(null==n?void 0:n.discardPrevious),0===o)return[3,6];y.label=2;case 2:return y.trys.push([2,4,,5]),[4,this.generateSuggestions(e,{discardPrevious:l,urlExclusionList:s,maxItems:Math.min(t-i,r),save:null!==(v=null==n?void 0:n.save)&&void 0!==v&&v})];case 3:return 0===(c=y.sent()).length?(o--,[3,1]):(u=c.filter((function(e){var t,n,r;return!s.includes(null!==(r=null===(n=null===(t=e.smartLink)||void 0===t?void 0:t.post_data)||void 0===n?void 0:n.parsely_canonical_url)&&void 0!==r?r:"")})),s=mn(mn([],s,!0),u.map((function(e){var t,n,r;return null!==(r=null===(n=null===(t=e.smartLink)||void 0===t?void 0:t.post_data)||void 0===n?void 0:n.parsely_canonical_url)&&void 0!==r?r:""})),!0),d=0===i,null===(m=null==n?void 0:n.onNewSuggestions)||void 0===m||m.call(n,u,d),a=mn(mn([],a,!0),u,!0),i+=u.length,[3,5]);case 4:if((p=y.sent())instanceof DOMException&&"AbortError"===p.name||p instanceof ot&&p.code===qe.ParselyAborted||p instanceof ot&&!p.retryFetch)throw p;return console.error(p),o--,[3,5];case 5:return[3,1];case 6:return[2,a]}}))}))},t.prototype.generateSuggestions=function(e,t){return gn(this,void 0,void 0,(function(){var n,r,o,i,a,s;return vn(this,(function(l){switch(l.label){case 0:return[4,this.fetch({method:"POST",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/generate"),data:{max_items:null!==(o=null==t?void 0:t.maxItems)&&void 0!==o?o:10,save:null!==(i=null==t?void 0:t.save)&&void 0!==i&&i,discard_previous:null===(a=null==t?void 0:t.discardPrevious)||void 0===a||a,url_exclusion_list:null==t?void 0:t.urlExclusionList,performance_blending_weight:null!==(s=null==t?void 0:t.performanceBlendingWeight)&&void 0!==s?s:.5}})];case 1:return n=l.sent(),r=n.data.filter((function(e){var t;return null===(t=e.validation)||void 0===t?void 0:t.valid})),[2,this.createTrafficBoostLinks(r)]}}))}))},t.prototype.generateSuggestionForPost=function(e,t,n,r){return gn(this,void 0,void 0,(function(){var o,i,a,s,l;return vn(this,(function(c){switch(c.label){case 0:return o="/wp-parsely/v2/content-helper/traffic-boost/".concat(e.id,"/generate-placement/").concat(t.id),[4,this.fetch({method:"POST",path:o,data:{keyword_exclusion_list:null==r?void 0:r.ignoreKeywords,performance_blending_weight:null!==(a=null==r?void 0:r.performanceBlendingWeight)&&void 0!==a?a:.5,save:null===(s=null==r?void 0:r.save)||void 0===s||s,allow_duplicate_links:null!==(l=null==r?void 0:r.allowDuplicateLinks)&&void 0!==l&&l}})];case 1:if(!(i=c.sent()).data)throw new ot((0,Be.__)("Couldn't find a good link placement.","wp-parsely"),qe.UnknownError,"");return n.smartLink=i.data,[2,n]}}))}))},t.prototype.removeInboundLink=function(e,t,n){return gn(this,void 0,void 0,(function(){var r;return vn(this,(function(o){switch(o.label){case 0:return r="/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/delete-inbound/").concat(t),[4,this.fetch({method:"DELETE",path:r,data:{restore_original:n}})];case 1:return[2,o.sent().data.success]}}))}))},t.prototype.updateInboundLink=function(e,t,n){return gn(this,void 0,void 0,(function(){var r;return vn(this,(function(o){switch(o.label){case 0:return r="/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/update-inbound/").concat(t),[4,this.fetch({method:"POST",path:r,data:n})];case 1:return[2,o.sent()]}}))}))},t.prototype.getInboundSmartLinks=function(e){return gn(this,void 0,void 0,(function(){var t;return vn(this,(function(n){switch(n.label){case 0:return t="/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/get-inbound"),[4,this.fetch({path:t})];case 1:return[2,n.sent().data]}}))}))},t.prototype.getInboundLinks=function(e){return gn(this,void 0,void 0,(function(){var t;return vn(this,(function(n){switch(n.label){case 0:return[4,this.getInboundSmartLinks(e)];case 1:return 0===(t=n.sent()).length?[2,[]]:[2,this.createTrafficBoostLinks(t)]}}))}))},t.prototype.acceptSuggestion=function(e,t,n){return gn(this,void 0,void 0,(function(){var r,o,i,a;return vn(this,(function(s){switch(s.label){case 0:return[4,this.fetch({method:"POST",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/accept-suggestion/").concat(t),data:{text:null==n?void 0:n.text,offset:null==n?void 0:n.offset}})];case 1:if((r=s.sent()).data.success)return[2,{success:!0,didReplaceLink:null!==(o=r.data.did_replace_link)&&void 0!==o&&o,postContent:r.data.post_content}];throw new ot(null!==(i=r.message)&&void 0!==i?i:(0,Be.__)("Unknown error.","wp-parsely"),null!==(a=r.error)&&void 0!==a?a:qe.UnknownError,"")}}))}))},t.prototype.discardSuggestions=function(e){return gn(this,void 0,void 0,(function(){return vn(this,(function(t){switch(t.label){case 0:return[4,this.fetch({method:"DELETE",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/discard-suggestions")})];case 1:return[2,t.sent().data]}}))}))},t.prototype.discardSuggestion=function(e,t){return gn(this,void 0,void 0,(function(){return vn(this,(function(n){switch(n.label){case 0:return[4,this.fetch({method:"DELETE",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(e,"/discard-suggestion/").concat(t)})];case 1:return[2,n.sent().data]}}))}))},t.prototype.createSuggestion=function(e){return{uid:"suggestion-".concat(e.id,"-").concat(Date.now()),targetPost:e,isSuggestion:!0}},t.prototype.createTrafficBoostLinks=function(e){return gn(this,void 0,void 0,(function(){var t,n,r,o,i=this;return vn(this,(function(a){switch(a.label){case 0:return t=e.reduce((function(e,t){var n,r=null===(n=t.post_data)||void 0===n?void 0:n.type.rest;return r?(e[r]||(e[r]=[]),e[r].push(t),e):e}),{}),n=Object.entries(t).map((function(e){return gn(i,[e],void 0,(function(e){var t,n=e[0],r=e[1];return vn(this,(function(e){switch(e.label){case 0:return t=r.map((function(e){var t;return null===(t=e.source)||void 0===t?void 0:t.post_id})),[4,this.getPosts({include:t,posts_per_page:100,status:"any",context:"edit",rest_endpoint:n})];case 1:return[2,e.sent().data]}}))}))})),[4,Promise.all(n)];case 1:return r=a.sent(),o=e.map((function(e){var t=r.flat().find((function(t){var n;return t.id===(null===(n=e.source)||void 0===n?void 0:n.post_id)}));return!!t&&i.createTrafficBoostLink(e,t)})).filter((function(e){return!1!==e})),[2,o]}}))}))},t.prototype.createTrafficBoostLink=function(e,t){return{uid:e.uid+"-"+Date.now(),targetPost:t,smartLink:e,isSuggestion:!e.applied}},t}(vt),wn=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM12.75 8V13H11.25V8H12.75ZM12.75 14.5V16H11.25V14.5H12.75Z"})}),xn=function(t){var n=t.onSelect,r=t.iframeDocument,o=t.selection,i=t.onErrorClick;!function(e){(0,Ge.useEffect)((function(){var t=window.getComputedStyle(document.documentElement).getPropertyValue("--wp-admin-theme-color").trim(),n=e.createElement("link");n.rel="stylesheet",n.href="/wp-includes/css/dist/components/style.css",e.head.appendChild(n);var r=e.createElement("style");return r.textContent="\n\t\t\t/* Highlight styles */\n\t\t\t.parsely-traffic-boost-highlight {\n\t\t\t\tposition: absolute;\n\t\t\t\tpointer-events: none;\n\t\t\t\tz-index: 1000;\n\t\t\t\ttransition: all 0.15s ease-out;\n\t\t\t}\n\n\t\t\t/* Popover container styles */\n\t\t\t.parsely-traffic-boost-popover-container {\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 50%;\n\t\t\t\tbottom: 100%;\n\t\t\t\ttransform: translateX(-50%);\n\t\t\t\tmargin-bottom: 12px;\n\t\t\t\tz-index: 1001;\n\t\t\t\topacity: 0;\n\t\t\t\tanimation: slideUp 0.2s ease-out forwards;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-popover-container .components-button.is-primary:focus:not(:disabled) {\n\t\t\t\tbox-shadow:none;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-popover-container.closing {\n\t\t\t\tanimation: slideDown 0.2s ease-out forwards;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-iframe-popover {\n\t\t\t\tpadding: 0;\n\t\t\t\tpointer-events: auto;\n\t\t\t\twhite-space: nowrap;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-iframe-popover-button {\n\t\t\t\tbox-shadow: 0px 2px 3px 0px rgba(0, 0, 0, 0.05),\n\t\t\t\t\t0px 4px 5px 0px rgba(0, 0, 0, 0.04),\n\t\t\t\t\t0px 4px 5px 0px rgba(0, 0, 0, 0.03),\n\t\t\t\t\t0px 16px 16px 0px rgba(0, 0, 0, 0.02);\n\t\t\t\tpadding: 6px 12px;\n\t\t\t\tbackground: var(--wp-admin-theme-color, ".concat(t,");\n\t\t\t\tborder-radius: 2px;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-iframe-popover-error {\n\t\t\t\tbackground: #000 !important;\n\t\t\t\tcolor: #fff !important;\n\t\t\t}\n\n\t\t\t/* Animation styles */\n\t\t\t@keyframes slideUp {\n\t\t\t\tfrom {\n\t\t\t\t\topacity: 0;\n\t\t\t\t\ttransform: translate(-50%, 10px);\n\t\t\t\t}\n\t\t\t\tto {\n\t\t\t\t\topacity: 1;\n\t\t\t\t\ttransform: translate(-50%, 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t@keyframes slideDown {\n\t\t\t\tfrom {\n\t\t\t\t\topacity: 1;\n\t\t\t\t\ttransform: translate(-50%, 0);\n\t\t\t\t}\n\t\t\t\tto {\n\t\t\t\t\topacity: 0;\n\t\t\t\t\ttransform: translate(-50%, 10px);\n\t\t\t\t}\n\t\t\t}\n\t\t"),e.head.appendChild(r),function(){n.remove(),r.remove()}}),[e])}(r);var a=(0,Ge.useState)(null),s=a[0],l=a[1],c=(0,Ge.useState)(!1),u=c[0],d=c[1],p=(0,Ge.useCallback)((function(e){for(var t=e.startContainer,n=e.endContainer;null!==t;){if(t.nodeType===Node.ELEMENT_NODE&&"A"===t.tagName)return!0;t=Sn(t,!1,n)}return!1}),[]),f=(0,Ge.useCallback)((function(){var e,t,n=o.getRangeAt(0).commonAncestorContainer,r=n.nodeType===Node.ELEMENT_NODE?n.closest("a"):null===(e=n.parentElement)||void 0===e?void 0:e.closest("a");return!(!r||o.isCollapsed)&&o.toString().trim()===(null===(t=r.textContent)||void 0===t?void 0:t.trim())}),[o]);return(0,Ge.useEffect)((function(){if(f())d(!0);else{var e=o.getRangeAt(0);p(e)?l((0,Be.__)("Select text without existing links.","wp-parsely")):l(null)}}),[p,f,o]),s?(0,e.jsx)("div",{className:"parsely-traffic-boost-iframe-popover",children:(0,e.jsx)(Xe.Button,{variant:"primary",className:"parsely-traffic-boost-iframe-popover-error",icon:wn,onClick:i,children:s})}):(0,e.jsx)("div",{className:"parsely-traffic-boost-iframe-popover",children:(0,e.jsx)(Xe.Button,{variant:"primary",icon:Vt,className:"parsely-traffic-boost-iframe-popover-button",onClick:n,children:u?(0,Be.__)("Replace Link","wp-parsely"):(0,Be.__)("Use as Link Text","wp-parsely")})})},kn=function(t){var n=t.iframeRef,r=t.onTextSelected,o=(0,Ge.useCallback)((function(){var t,o,i,a=null===(t=n.current)||void 0===t?void 0:t.contentDocument;if(a){var s=a.getSelection(),l=a.querySelector(".parsely-traffic-boost-highlight");if(l){if(!s||s.isCollapsed){var c=l.querySelector(".parsely-traffic-boost-popover-container");return void(c?(c.classList.add("closing"),setTimeout((function(){l.remove()}),200)):l.remove())}l.remove()}if(s&&!s.isCollapsed){var u=sn(a);if(u){var d=s.getRangeAt(0);if(u.contains(d.commonAncestorContainer)){var p=null===(o=d.startContainer.parentElement)||void 0===o?void 0:o.closest("p, li"),f=null===(i=d.endContainer.parentElement)||void 0===i?void 0:i.closest("p, li");if(p&&f&&p===f){(function(e,t){var n,r=t.commonAncestorContainer,o=r.nodeType===Node.ELEMENT_NODE?r.closest("a"):null===(n=r.parentElement)||void 0===n?void 0:n.closest("a");if(e.toString()===(null==o?void 0:o.textContent))return!0;if(o){var i=t.cloneRange();return i.selectNodeContents(o),e.removeAllRanges(),e.addRange(i),!0}return!1})(s,d)||function(e,t){for(var n,r,o=t.startContainer,i=t.endContainer,a=null!==(n=o.textContent)&&void 0!==n?n:"",s=null!==(r=i.textContent)&&void 0!==r?r:"",l=t.startOffset,c=t.endOffset,u=t.startOffset;u>0&&/[^\s.,!?;:'")\]}]/g.test(a[u-1]);)u--;for(var d=t.endOffset;d<s.length&&/[^\s.,!?;:'"([{]/g.test(s[d]);)d++;u===l&&d===c||(t.setStart(o,u),t.setEnd(i,d),e.removeAllRanges(),e.addRange(t))}(s,d);var h=a.createElement("div");h.className="parsely-traffic-boost-highlight";var g=a.createElement("div");g.className="parsely-traffic-boost-popover-container",h.appendChild(g);var v=(0,Ge.createRoot)(g);v.render((0,e.jsx)(xn,{iframeDocument:a,selection:s,onErrorClick:function(){g.classList.add("closing"),s.removeAllRanges(),setTimeout((function(){b()}),200)},onSelect:function(){g.classList.add("closing");var e=function(e,t,n){var r=t.toString().trim();if(!r)return 0;var o=t.getRangeAt(0),i=e.createRange();i.setStart(n,0),i.setEnd(o.startContainer,o.startOffset);var a=i.toString(),s=new RegExp(r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),l=a.match(s);return l?l.length:0}(a,s,u);r(s.toString().trim(),e),s.removeAllRanges(),setTimeout((function(){b()}),200)}}));var m=function(){var e,t,n=d.getBoundingClientRect(),r=null!==(t=null===(e=a.defaultView)||void 0===e?void 0:e.scrollY)&&void 0!==t?t:0;h.style.top="".concat(n.top+r,"px"),h.style.left="".concat(n.left,"px"),h.style.width="".concat(n.width,"px"),h.style.height="".concat(n.height,"px")};m(),u.appendChild(h);var y=function(){requestAnimationFrame(m)};a.addEventListener("scroll",y,{passive:!0}),window.addEventListener("scroll",y,{passive:!0});var b=function(){a.removeEventListener("scroll",y),window.removeEventListener("scroll",y),v.unmount(),h.remove()}}}}}}}),[n,r]);return(0,Ge.useEffect)((function(){var e,t=null===(e=n.current)||void 0===e?void 0:e.contentDocument;if(t){var r=(0,Ot.debounce)((function(){o()}),300,{leading:!0,trailing:!0});return t.addEventListener("selectionchange",r),function(){t.removeEventListener("selectionchange",r)}}}),[o,n]),null},Sn=function(e,t,n){return n===e?null:e.firstChild&&!t?e.firstChild:e.parentNode?e.nextSibling?e.nextSibling:Sn(e.parentNode,!0,n):null},En=function(t){var n=t.previewUrl,r=t.isLoading,o=t.onTextSelected,i=t.isFrontendPreview,a=t.activeLink,s=t.selectedText,l=t.onLoadingChange,c=t.onRestoreOriginal,u=(0,Ge.useRef)(null),d=(0,Ge.useRef)(null),p=!(null==a?void 0:a.isSuggestion),f=(0,Me.useSelect)((function(e){return{selectedLinkType:e(Kt).getPreviewLinkType(),isGenerating:!!a&&e(Kt).isGenerating(a)}}),[a]),h=f.selectedLinkType,g=f.isGenerating,v=(0,Ot.usePrevious)(g),m=(0,Ge.useMemo)((function(){if(!n)return n;var e=new URL(n);return e.searchParams.set("customize_changeset_uuid",crypto.randomUUID()),e.toString()}),[n]),y=function(e){var t=e.iframeRef,n=e.contentAreaRef,r=e.activeLink,o=e.selectedText,i=e.isInboundLink,a=e.onRestoreOriginal,s=(0,Ge.useCallback)((function(e){var t,n,r=null!==(t=e.contentDocument)&&void 0!==t?t:null===(n=e.contentWindow)||void 0===n?void 0:n.document;if(r){var o=r.createElement("style");o.textContent="\n\t\t\t/** Smart link highlight styles. */\n\t\t\t.smart-link-highlight {\n\t\t\t\toutline: 2px solid #3858E9;\n\t\t\t\tborder-radius: 2px;\n\t\t\t\tbackground-color: #3858E9;\n\t\t\t\tcolor: #ffffff;\n\t\t\t}\n\n\t\t\t.smart-link-highlight *:hover,\n\t\t\t.smart-link-highlight *:focus {\n\t\t\t\tcolor: #ffffff;\n\t\t\t\ttext-decoration: revert;\n\t\t\t}\n\n\t\t\t.smart-link-highlight * {\n\t\t\t\tcolor: #ffffff;\n\t\t\t}\n\n\t\t\t.smart-link-highlight.previous-suggestion {\n\t\t\t\toutline: 2px solid rgba(56, 88, 233, 0.2);\n\t\t\t\tbackground-color: rgba(56, 88, 233, 0.2);\n\t\t\t\ttext-decoration: line-through;\n\t\t\t\tcolor: inherit;\n\t\t\t}\n\n\t\t\t.smart-link-highlight.previous-suggestion * {\n\t\t\t\tcolor: inherit;\n\t\t\t}\n\n\t\t\t/** Link type highlight styles. */\n\t\t\t.link-type-highlight {\n\t\t\t\tborder-radius: 2px;\n\t\t\t\tbackground-color: transparent;\n\t\t\t\toutline: 0 solid transparent;\n\t\t\t\tanimation: highlight-fade-in 0.2s ease-in-out forwards;\n\t\t\t\toutline-width: 0;\n\t\t\t}\n\n\t\t\t.link-type-highlight * {\n\t\t\t\tcolor: white !important;\n\t\t\t\tmix-blend-mode: difference;\n\t\t\t}\n\n\t\t\t.link-type-highlight.removing {\n\t\t\t\tanimation: highlight-fade-out 0.2s ease-in-out forwards;\n\t\t\t}\n\n\t\t\t.link-type-highlight a {\n\t\t\t\ttext-decoration: underline;\n\t\t\t\ttext-decoration-color: currentColor;\n\t\t\t\ttransition: all 0.2s ease-in-out;\n\t\t\t}\n\n\t\t\t.link-type-highlight:not(.removing) a {\n\t\t\t\ttext-decoration-color: transparent;\n\t\t\t}\n\n\t\t\t@keyframes highlight-fade-in {\n\t\t\t\t0% {\n\t\t\t\t\toutline-width: 0;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t}\n\t\t\t\t1% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t}\n\t\t\t\t100% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: currentColor;\n\t\t\t\t\tbackground-color: currentColor;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t@keyframes highlight-fade-out {\n\t\t\t\t0% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: currentColor;\n\t\t\t\t\tbackground-color: currentColor;\n\t\t\t\t}\n\t\t\t\t99% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tcolor: inherit;\n\t\t\t\t}\n\t\t\t\t100% {\n\t\t\t\t\toutline-width: 0;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tcolor: inherit;\n\t\t\t\t}\n\t\t\t}\n\t\t",r.head.appendChild(o)}}),[]),l=(0,Ge.useCallback)((function(e,t,n){for(var r,o,i,a=[],s=n.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),l=s.nextNode(),c="",u=[];l;){var d=null!==(r=l.textContent)&&void 0!==r?r:"",p=null===(o=l.parentElement)||void 0===o?void 0:o.closest("article, aside, blockquote, details, dialog, dd, div, dl, dt, fieldset, figcaption, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hgroup, hr, li, main, nav, ol, p, pre, section, table, ul");u.push({node:l,start:c.length,end:c.length+d.length,blockParent:null!=p?p:null}),c+=d,l=s.nextNode()}for(var f=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),h=function(){var t=i.index,r=t+e.length,o=u.find((function(e){return t>=e.start&&t<e.end})),s=u.find((function(e){return r>e.start&&r<=e.end}));if(o&&s&&o.blockParent&&s.blockParent&&o.blockParent===s.blockParent){var l=n.createRange();l.setStart(o.node,t-o.start),l.setEnd(s.node,r-s.start),a.push(l)}};null!==(i=f.exec(c));)h();return a}),[]),c=(0,Ge.useCallback)((function(e,n,r,o){var i,a,s,l,c,u,d;void 0===o&&(o=!1);try{var p=null!==(a=null===(i=t.current)||void 0===i?void 0:i.contentDocument)&&void 0!==a?a:null===(l=null===(s=t.current)||void 0===s?void 0:s.contentWindow)||void 0===l?void 0:l.document;if(!p)return;var f=e.cloneContents(),h=p.createElement("span");h.className=o?"".concat(n," previous-suggestion"):n,h.setAttribute("aria-label",r),h.setAttribute("role","mark"),o&&h.setAttribute("aria-roledescription",(0,Be.__)("Previous suggestion","wp-parsely"));var g=e.commonAncestorContainer,v=g.nodeType===Node.ELEMENT_NODE?g.closest("a"):null===(c=g.parentElement)||void 0===c?void 0:c.closest("a");return v&&e.toString().trim()===(null===(u=v.textContent)||void 0===u?void 0:u.trim())&&v?(null===(d=v.parentNode)||void 0===d||d.insertBefore(h,v),h.appendChild(v)):(e.deleteContents(),h.appendChild(f),e.insertNode(h)),h}catch(e){console.error("WP Parsely: Error highlighting range",e)}}),[t]),u=(0,Ge.useCallback)((function(e,t,n){var r,o;void 0===n&&(n=!1);try{var i=null!==(r=e.contentDocument)&&void 0!==r?r:null===(o=e.contentWindow)||void 0===o?void 0:o.document;if(!i)return;var a=function(e,t){for(var n=i.createDocumentFragment();e.firstChild;)n.appendChild(e.firstChild);t.insertBefore(n,e),t.removeChild(e),t.normalize(),Array.from(t.querySelectorAll("a")).forEach((function(e){var n,r;if(null===(n=e.textContent)||void 0===n?void 0:n.trim()){var o=e.nextElementSibling;o&&"A"===o.tagName&&(e.href===o.href||e.getAttribute("data-smartlink")===o.getAttribute("data-smartlink")&&null!==e.getAttribute("data-smartlink"))&&(e.nextSibling&&e.nextSibling.nodeType===Node.TEXT_NODE||null===(r=e.parentNode)||void 0===r||r.insertBefore(i.createTextNode(" "),o))}else t.removeChild(e)}))},s=function(e){e.querySelectorAll(t).forEach((function(e){return s(e)}));var r=e.parentNode;r&&(n?(e.classList.add("removing"),setTimeout((function(){a(e,r)}),200)):a(e,r))};i.querySelectorAll(t).forEach((function(e){var n;(null===(n=e.parentElement)||void 0===n?void 0:n.closest(t))||s(e)}))}catch(e){}}),[]),d=(0,Ge.useCallback)((function(e){u(e,".smart-link-highlight")}),[u]),p=(0,Ge.useCallback)((function(e,t,n){var r,o=!(e.compareBoundaryPoints(Range.END_TO_START,t)>0||e.compareBoundaryPoints(Range.START_TO_END,t)<0),i=(0,Be.__)("Suggested link","wp-parsely");if(o){if(t.compareBoundaryPoints(Range.START_TO_START,e)<0){var a=t.cloneRange();a.setEnd(e.startContainer,e.startOffset),c(a,n,i,!0),e.setStart(a.endContainer,a.endOffset)}if(t.compareBoundaryPoints(Range.END_TO_END,e)>0){var s=t.cloneRange();s.setStart(e.endContainer,e.endOffset),c(s,n,i,!0)}r=c(e,n,i)}else c(t,n,i,!0),r=c(e,n,i);return r}),[c]),f=(0,Ge.useCallback)((function(e,t,r){if(void 0===r&&(r=0),n.current){var i=l(t,n.current,e)[r];if(i)if(null==o?void 0:o.text){var s=l(o.text,n.current,e)[o.offset];if(s){var u=p(s,i,"smart-link-highlight");u&&(u.style.cursor="pointer",u.addEventListener("click",(function(){a()})))}}else c(i,"smart-link-highlight",(0,Be.__)("Suggested link","wp-parsely"))}}),[n,l,p,c,o,a]),h=(0,Ge.useCallback)((function(e,t){var i,a,s=e.querySelector('a[data-smartlink="'.concat(t,'"]'));if(s){var u=e.createRange();if(u.selectNode(s),(null==o?void 0:o.text)&&n.current){var d=l(o.text,n.current,e);if(d[o.offset]){var h=d[o.offset];return void p(h,u,"smart-link-highlight")}}c(u,"smart-link-highlight",(0,Be.__)("Inbound link","wp-parsely"),!!o)}else(null===(i=null==r?void 0:r.smartLink)||void 0===i?void 0:i.text)&&f(e,r.smartLink.text,null!==(a=r.smartLink.offset)&&void 0!==a?a:0)}),[r,o,n,c,l,p,f]),g=(0,Ge.useCallback)((function(e){var t,n,o,a;try{var s=null!==(t=e.contentDocument)&&void 0!==t?t:null===(n=e.contentWindow)||void 0===n?void 0:n.document;if(!s||!(null===(o=null==r?void 0:r.smartLink)||void 0===o?void 0:o.text))return;i?h(s,r.smartLink.uid):f(s,r.smartLink.text,null!==(a=r.smartLink.offset)&&void 0!==a?a:0)}catch(e){console.error("WP Parsely: Error highlighting Smart Link text",e)}}),[r,h,f,i]),v=(0,Ge.useCallback)((function(e,t){var o,i,a=n.current,s=null!==(o=e.contentDocument)&&void 0!==o?o:null===(i=e.contentWindow)||void 0===i?void 0:i.document;if(a&&s&&(u(e,".link-type-highlight",!0),r&&t)){var l=new URL(r.targetPost.link).hostname,d=Array.from(a.querySelectorAll("a"));d=d.filter((function(e){var t;return""!==(null===(t=e.textContent)||void 0===t?void 0:t.trim())}));var p=(0,Be.__)("Highlighted link","wp-parsely");switch(t){case"external":d=d.filter((function(e){return!e.href.includes(l)})),p=(0,Be.__)("External link","wp-parsely");break;case"internal":d=d.filter((function(e){return e.href.includes(l)})),p=(0,Be.__)("Internal link","wp-parsely");break;case"smart":d=d.filter((function(e){return e.hasAttribute("data-smartlink")})),p=(0,Be.__)("Smart Link","wp-parsely")}(null==d?void 0:d.length)&&d.forEach((function(e){var t=s.createRange();t.selectNode(e),c(t,"link-type-highlight",p)}))}}),[r,n,c,u]);return{injectHighlightStyles:s,highlightSmartLink:g,highlightLinkType:v,removeSmartLinkHighlights:d,removeHighlights:u}}({iframeRef:d,contentAreaRef:u,activeLink:a,selectedText:s,isInboundLink:p,onRestoreOriginal:c}),b=y.injectHighlightStyles,w=y.highlightSmartLink,x=y.highlightLinkType,k=y.removeSmartLinkHighlights,_=(0,Ge.useCallback)((function(e){var t,n;if(i){var r=null===(t=e.contentWindow)||void 0===t?void 0:t.document.getElementById("wpadminbar");r&&(r.style.display="none");var o=null===(n=e.contentWindow)||void 0===n?void 0:n.document.documentElement;o&&o.style.setProperty("margin-top","0","important")}}),[i]),S=(0,Ge.useCallback)((function(e){var t,n,r,o,i=null!==(t=null==e?void 0:e.contentDocument)&&void 0!==t?t:null===(n=e.contentWindow)||void 0===n?void 0:n.document;if(i){i.addEventListener("click",(function(e){var t,n,r,o,i,a=e.target;if(!(null===(t=u.current)||void 0===t?void 0:t.contains(a)))return e.preventDefault(),void e.stopPropagation();var s="A"===a.tagName?a:a.closest("a");if(s){if(e.preventDefault(),e.stopPropagation(),!["P","A"].includes(null!==(r=null===(n=a.parentElement)||void 0===n?void 0:n.tagName)&&void 0!==r?r:""))return;s.blur(),null===(i=null===(o=s.ownerDocument.defaultView)||void 0===o?void 0:o.getSelection())||void 0===i||i.selectAllChildren(s)}}),!0),i.addEventListener("submit",(function(e){e.preventDefault(),e.stopPropagation()}),!0),e.contentWindow&&Object.defineProperty(e.contentWindow,"open",{value:function(){return null},writable:!1}),i.addEventListener("contextmenu",(function(e){e.preventDefault(),e.stopPropagation()}),!0);try{(null===(r=e.contentWindow)||void 0===r?void 0:r.history)&&(e.contentWindow.history.pushState=function(){},e.contentWindow.history.replaceState=function(){})}catch(e){}null===(o=e.contentWindow)||void 0===o||o.addEventListener("popstate",(function(e){e.preventDefault(),e.stopPropagation()}),!0)}}),[u]),E=(0,Ge.useCallback)((function(e){var t,n,r=null!==(t=e.contentDocument)&&void 0!==t?t:null===(n=e.contentWindow)||void 0===n?void 0:n.document;if(r){var o=function(){return e=void 0,t=void 0,o=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}(this,(function(t){switch(t.label){case 0:return(e=r.querySelector(".smart-link-highlight:not(.previous-suggestion)"))?[4,new Promise((function(e){return setTimeout(e,100)}))]:[3,2];case 1:t.sent(),e.scrollIntoView({behavior:"smooth",block:"center"}),t.label=2;case 2:return[2]}}))},new((n=void 0)||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}));var e,t,n,o},i=new MutationObserver((function(){r.querySelector(".smart-link-highlight:not(.previous-suggestion)")&&o()})),a=sn(r);a&&(i.observe(a,{childList:!0,subtree:!0}),o(),setTimeout((function(){return i.disconnect()}),1e3))}}),[]),P=(0,Ge.useCallback)((function(e){if(null==e?void 0:e.contentDocument){b(e);var t=sn(e.contentDocument);t&&(u.current=t),_(e),x(e,h),S(e),l(!1),E(e)}}),[u,S,_,x,b,E,l,h]);return(0,Ge.useEffect)((function(){if(!g){var e=d.current;if(e){var t=function(){P(e)};return e.src!==m&&l(!0),e.addEventListener("load",t),function(){e.removeEventListener("load",t)}}}}),[g,m,P,l]),(0,Ge.useEffect)((function(){u.current=null}),[a,u]),(0,Ge.useEffect)((function(){var e=d.current;(null==e?void 0:e.contentDocument)&&null!==u.current&&!r&&(k(e),w(e),E(e))}),[u,w,r,E,k,s]),(0,Ge.useEffect)((function(){var e=d.current;(null==e?void 0:e.contentDocument)&&null!==u.current&&!r&&x(e,h)}),[u,x,r,h]),(0,e.jsx)("div",{className:"wp-parsely-preview",children:(0,e.jsxs)("div",{className:"preview-iframe-wrapper",children:[(0,e.jsx)("div",{className:"wp-parsely-preview-loading ".concat(r?"is-loading":""),children:i&&a&&an(a)?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(fn,{}),(0,Be.__)("This link is not available in the preview.","wp-parsely")]}):(0,e.jsx)(e.Fragment,{children:r&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Xe.Spinner,{}),(g||v)&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(pn,{showSpinner:!1,messages:yn,typewriter:!0,randomOrder:!1})})]})})}),a&&!g&&(!i||!an(a))&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("iframe",{ref:d,src:m,title:(0,Be.__)("Post Preview","wp-parsely"),className:"wp-parsely-preview-iframe ".concat(r?"is-loading":""),sandbox:"allow-same-origin allow-scripts"}),(0,e.jsx)(kn,{iframeRef:d,onTextSelected:function(e,t){o(e,t)}})]})]})})},Pn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ln=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},jn=function(t){var n=t.activeLink,r=t.onAccept,o=t.onDiscard,i=t.onRemoveInboundLink,a=t.onUpdateInboundLink,s=(0,Ge.useState)(!1),l=s[0],c=s[1],u=(0,Ge.useState)(!1),d=u[0],p=u[1],f=(0,Ge.useState)(!0),h=f[0],g=f[1],v=(0,Ge.useState)(n),m=v[0],y=v[1],b=(0,Ge.useState)(n.targetPost),w=b[0],x=b[1],k=(0,Ge.useState)(null),_=k[0],S=k[1],E=(0,Ge.useState)(""),P=E[0],L=E[1],j=(0,Ge.useState)(0),T=j[0],N=j[1],C=(0,Ge.useState)(0),I=C[0],A=C[1],R=(0,Me.useDispatch)("core/notices"),O=R.createSuccessNotice,D=R.createErrorNotice,G=(0,Me.useSelect)((function(e){return{post:e(Kt).getCurrentPost(),suggestions:e(Kt).getSuggestions(),inboundLinks:e(Kt).getInboundLinks()}}),[]),B=G.post,M=G.suggestions,F=G.inboundLinks,U=(0,Me.useDispatch)(Kt),H=U.setSelectedLink,V=U.removeSuggestion,$=U.removeInboundLink,W=U.addInboundLink,z=U.setSelectedTab,q=U.setIsAccepting,K=U.setIsRemoving;(0,Ge.useEffect)((function(){y(n)}),[n]),(0,Ge.useEffect)((function(){x(m.targetPost),p(!m.isSuggestion),S(null)}),[m]),(0,Ge.useEffect)((function(){var e,t;m.isSuggestion?(N(null!==(e=null==M?void 0:M.length)&&void 0!==e?e:0),A((null==M?void 0:M.indexOf(m))+1)):(N(null!==(t=null==F?void 0:F.length)&&void 0!==t?t:0),A((null==F?void 0:F.indexOf(m))+1))}),[m,F,M]),(0,Ge.useEffect)((function(){var e,t,n,r;if(w){var o=l?(0,it.addQueryArgs)(w.link,{parsely_preview:"true",_wpnonce:null!==(n=window._parsely_traffic_boost_preview_nonce)&&void 0!==n?n:"",smart_link_id:null===(r=m.smartLink)||void 0===r?void 0:r.smart_link_id}):(0,it.addQueryArgs)("".concat(window.location.origin,"/wp-admin/admin-ajax.php"),{action:"parsely_post_preview",post_id:w.id,_wpnonce:null!==(e=window._parsely_traffic_boost_preview_nonce)&&void 0!==e?e:"",smart_link_id:null===(t=m.smartLink)||void 0===t?void 0:t.smart_link_id});o!==P&&(g(!0),L(o))}}),[w,l,P]);var Z=function(){var e;(e=d?null==F?void 0:F[I]:null==M?void 0:M[I])&&(A(I+1),H(e))},Y=function(){var e;(e=d?null==F?void 0:F[I-2]:null==M?void 0:M[I-2])&&(A(I-1),H(e))};return w&&B?(0,e.jsxs)("div",{className:"traffic-boost-preview",children:[(0,e.jsx)(un,{isLoading:h,activeLink:m,onOpenPostInNewTab:function(){(null==w?void 0:w.link)&&window.open(w.link,"_blank","noopener")},onOpenPostEditor:function(){(null==w?void 0:w.id)&&window.open("".concat(window.location.origin,"/wp-admin/post.php?post=").concat(w.id,"&action=edit"),"_blank","noopener")},onOpenParselyDashboard:function(){if(null==w?void 0:w.link){var e="https://dash.parsely.com/".concat(window.wpParselySiteId,"/find?url=").concat(encodeURIComponent(w.link));window.open(e,"_blank","noopener")}},isFrontendPreview:l,setIsFrontendPreview:c}),(0,e.jsx)(En,{activeLink:m,previewUrl:P,isLoading:h,selectedText:_,onTextSelected:function(e,t){S({text:e,offset:t})},onRestoreOriginal:function(){S(null)},isFrontendPreview:l,onLoadingChange:g}),(0,e.jsx)(tn,{activeLink:m,totalItems:T,itemIndex:I,onNext:Z,onPrevious:Y,onAccept:function(t){return Pn(void 0,void 0,void 0,(function(){var n,o;return Ln(this,(function(i){switch(i.label){case 0:q(t,!0),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r(t,_)];case 2:if(!i.sent())throw new ot((0,Be.__)("Failed to accept suggestion.","wp-parsely"),qe.UnknownError,"");return[3,4];case 3:return n=i.sent(),o=(0,Be.__)("Failed to accept suggestion.","wp-parsely"),n instanceof ot&&n.message&&n.code!==qe.UnknownError&&(o+=" ".concat(n.message)),D(o,{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Bt})}),q(t,!1),[2];case 4:return V(t),t.isSuggestion=!1,W(t),q(t,!1),O((0,Be.__)("Link planted","wp-parsely"),{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Vt})}),I===T&&1===T?(z(Et.INBOUND_LINKS),H(t),L(P+"?cache-bust="+Date.now())):I===T?Y():Z(),[2]}}))}))},onDiscard:function(e){return Pn(void 0,void 0,void 0,(function(){return Ln(this,(function(t){switch(t.label){case 0:return[4,o(e)];case 1:return t.sent(),V(e),I===T&&1===T?H(null):I===T?Y():Z(),[2]}}))}))},onUpdateLink:function(t,n){return Pn(void 0,void 0,void 0,(function(){var r,o;return Ln(this,(function(i){switch(i.label){case 0:if(!_)return[2];q(t,!0),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a(t,_.text,_.offset,n)];case 2:if(!i.sent())throw new ot((0,Be.__)("Failed to update link.","wp-parsely"),qe.UnknownError,"");return[3,4];case 3:return r=i.sent(),o=(0,Be.__)("Failed to update link.","wp-parsely"),r instanceof ot&&r.message&&r.code!==qe.UnknownError&&(o+=" ".concat(r.message)),D(o,{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Bt})}),q(t,!1),[2];case 4:return q(t,!1),O((0,Be.__)("Link updated","wp-parsely"),{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Vt})}),L(P+"?cache-bust="+Date.now()),S(null),[2]}}))}))},onRemove:function(t,n){return Pn(void 0,void 0,void 0,(function(){var r,o;return Ln(this,(function(a){switch(a.label){case 0:K(t,!0),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i(t,n)];case 2:if(!a.sent())throw new ot((0,Be.__)("Failed to remove link.","wp-parsely"),qe.UnknownError,"");return[3,4];case 3:return r=a.sent(),o=(0,Be.__)("Failed to remove link.","wp-parsely"),r instanceof ot&&r.message&&r.code!==qe.UnknownError&&(o+=" ".concat(r.message)),D(o,{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Bt})}),K(t,!1),[2];case 4:return $(t),K(t,!1),O((0,Be.__)("Link removed","wp-parsely"),{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:$t})}),I===T&&1===T?H(null):I===T?Y():Z(),[2]}}))}))},onRestoreOriginal:function(){S(null)},selectedText:_})]}):(0,e.jsx)(e.Fragment,{})},Tn=function(t){var n,r=t.post,o=t.isLoading;return(0,e.jsxs)("div",{className:"traffic-boost-post-details",children:[(0,e.jsx)("div",{className:"traffic-boost-post-details-label",children:(0,Be.__)("Target Post:","wp-parsely")}),(0,e.jsxs)("div",{className:"traffic-boost-post-details-content",children:[(0,e.jsx)(xt,{post:r,size:52,className:"traffic-boost-thumbnail"}),o&&(0,e.jsx)(Xe.Spinner,{}),!o&&(0,e.jsx)("div",{className:"post-title",dangerouslySetInnerHTML:{__html:null!==(n=null==r?void 0:r.title.rendered)&&void 0!==n?n:(0,Be.__)("(no title)","wp-parsely")}})]}),(0,e.jsx)("div",{className:"traffic-boost-post-details-divider"}),(0,e.jsx)("div",{className:"traffic-boost-post-details-description",children:(0,Be.__)("Use Parse.ly data to increase your post's traffic. Plant links to this post in high-performing related source posts.","wp-parsely")})]})},Nn=function(t){var n=t.onBackClick,r=t.isLoading,o=t.post;return(0,e.jsxs)("div",{className:"traffic-boost-sidebar-header",children:[(0,e.jsx)("div",{className:"traffic-boost-sidebar-header-nav",children:(0,e.jsx)(Xe.Button,{icon:tt,onClick:n,children:(0,Be.__)("Back","wp-parsely")})}),(0,e.jsx)("div",{className:"traffic-boost-sidebar-inner",children:(0,e.jsx)(Tn,{post:o,isLoading:r})})]})},Cn=window.wp.escapeHtml,In=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})}),An=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),Rn=(0,Ge.forwardRef)((function(t,n){var r=t.suggestion,o=t.isActive,i=t.onClick,a=r.targetPost,s=function(){null==i||i(r)};return(0,e.jsxs)("div",{className:"traffic-boost-single-link ".concat(o?"active":""),ref:n,onClick:function(e){e.preventDefault(),s()},onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),s())},role:"button",tabIndex:0,"aria-label":(0,Be.sprintf)(/* translators: %s: Post title */ /* translators: %s: Post title */
(0,Be.__)("Traffic boost link for %s","wp-parsely"),a.title.rendered),"aria-pressed":o,children:[(0,e.jsx)("div",{className:"single-link-thumbnail",children:(0,e.jsx)(xt,{post:a,size:52,className:"traffic-boost-preview-thumbnail"})}),(0,e.jsx)("div",{className:"single-link-details",children:(0,e.jsx)("div",{className:"single-link-title",dangerouslySetInnerHTML:{__html:a.title.rendered}})})]})})),On=function(t){var n,r=t.isLoading,o=t.useScrollbar,i=void 0!==o&&o,a=t.children,s=t.links,l=t.onClick,c=t.activeLink,u=t.minItemsPerPage,d=void 0===u?3:u,p=t.currentPage,f=void 0===p?1:p,h=t.itemsPerPage,g=void 0===h?3:h,v=t.onPageChange,m=t.onItemsPerPageChange,y=t.renderEmptyState,b=t.showPagination,w=void 0===b||b,x=(0,Ge.useState)(r),k=x[0],_=x[1],S=(0,Ge.useState)([]),E=S[0],P=S[1],L=(0,Ge.useState)(1),j=L[0],T=L[1],N=(0,Ge.useState)(null!==(n=null==c?void 0:c.uid)&&void 0!==n?n:null),C=N[0],I=N[1],A=(0,Ge.useRef)(null),R=(0,Ge.useRef)(0),O=(0,Ge.useRef)([]),D=(0,Ge.useCallback)((function(){if(!k&&!i)if(A.current){var e=A.current.clientHeight;if(e!==R.current){R.current=e;var t=e-60,n=Math.floor(t/85),r=Math.max(d,n);null==m||m(r),_(!1)}}else null==m||m(d)}),[k,d,m,i]);(0,Ge.useEffect)((function(){_(r)}),[r]),(0,Ge.useEffect)((function(){var e;I(null!==(e=null==c?void 0:c.uid)&&void 0!==e?e:null)}),[c]),(0,Ge.useEffect)((function(){if(i&&c&&A.current){var e=s.findIndex((function(e){return e.uid===c.uid}));if(-1!==e&&O.current[e]){var t=A.current,n=O.current[e];if(n){if(0===e)return void(t.scrollTop=0);var r=t.getBoundingClientRect(),o=n.getBoundingClientRect();(o.top<r.top||o.bottom>r.bottom)&&n.scrollIntoView({behavior:"smooth",block:"start"})}}}}),[c,s,i]),(0,Ge.useEffect)((function(){if(!i){D();var e=new ResizeObserver(D);return A.current&&e.observe(A.current),function(){e.disconnect()}}}),[D,i]),(0,Ge.useEffect)((function(){if(0!==g&&!i){var e=Math.max(1,Math.ceil(s.length/g));T(e||1);var t=(f-1)*g,n=t+g;P(s.slice(t,n)),e<f&&e>0&&(null==v||v(e))}}),[f,g,s,v,i]),(0,Ge.useEffect)((function(){if(!i&&c&&s){var e=s.findIndex((function(e){return e.uid===c.uid}));if(-1!==e){var t=Math.floor(e/g)+1;null==v||v(t)}}}),[c,s,g,v,i]);var G=function(e){I(e.uid),null==l||l(e)};return(0,e.jsxs)("div",{ref:A,className:"traffic-boost-links".concat(i?" scrollbar":""),children:[function(){if(k&&0===E.length)return(0,e.jsx)("div",{className:"traffic-boost-links-list-loading",children:(0,e.jsx)(Xe.Spinner,{})});var t=E;return i&&(t=s),s.length>0&&0===t.length&&!i?null:0===t.length?y?y():(0,e.jsx)("p",{children:(0,Be.__)("No posts found.","wp-parsely")}):(0,e.jsx)("div",{className:"traffic-boost-links-list",children:t.map((function(t,n){var r;return(0,e.jsx)(Rn,{suggestion:t,isActive:t.uid===C,onClick:G,ref:function(e){O.current[n]=e}},t.targetPost.id+(null!==(r=t.uid)&&void 0!==r?r:""))}))})}(),(0,e.jsxs)("div",{className:"links-pagination",children:[(0,e.jsx)("div",{className:"links-pagination-children",children:a}),!i&&!k&&s.length>g&&j>0&&(0,e.jsxs)(e.Fragment,{children:[w&&(0,e.jsxs)("div",{className:"page-selector",children:[(0,e.jsx)("span",{children:(0,Be.__)("Page","wp-parsely")}),(0,e.jsx)("select",{value:f,onChange:function(e){return function(e){if(i&&e){var t=parseInt(e,10);t>j?t=j:t<1&&(t=1),null==v||v(t)}}(e.target.value)},children:Array.from({length:Math.max(1,j)},(function(e,t){return t+1})).map((function(t){return(0,e.jsx)("option",{value:t,children:t},t)}))}),(0,e.jsxs)("span",{children:[(0,Be.__)("of","wp-parsely")," ",j]})]}),(0,e.jsxs)("div",{className:"page-navigation",children:[(0,e.jsx)(Xe.Button,{icon:In,onClick:function(){i||null==v||v(Math.max(f-1,1))},disabled:f<=1}),(0,e.jsx)(Xe.Button,{icon:An,onClick:function(){i||null==v||v(Math.min(f+1,j))},disabled:f>=j})]})]})]})]})},Dn=function(t){var n=t.onInboundLinkClick,r=(0,Me.useSelect)((function(e){return{selectedLink:e(Kt).getSelectedLink(),inboundLinks:e(Kt).getInboundLinks(),currentPage:e(Kt).getInboundLinksPage(),itemsPerPage:e(Kt).getInboundLinksItemsPerPage(),isLoadingInboundLinks:e(Kt).isLoadingInboundLinks()}}),[]),o=r.selectedLink,i=r.inboundLinks,a=r.currentPage,s=r.itemsPerPage,l=r.isLoadingInboundLinks,c=(0,Me.useDispatch)(Kt),u=c.setInboundLinksItemsPerPage,d=c.setInboundLinksPage;return(0,e.jsx)(On,{isLoading:l,links:i,onClick:n,activeLink:(null==o?void 0:o.isSuggestion)?null:o,currentPage:a,itemsPerPage:s,onPageChange:d,onItemsPerPageChange:u,renderEmptyState:function(){return(0,e.jsx)("div",{className:"traffic-boost-suggestions-empty-state",children:(0,e.jsx)("p",{children:(0,Be.__)("This post has no inbound links.","wp-parsely")})})}})},Gn=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M7 7.2h8.2L13.5 9l1.1 1.1 3.6-3.6-3.5-4-1.1 1 1.9 2.3H7c-.9 0-1.7.3-2.3.9-1.4 1.5-1.4 4.2-1.4 5.6v.2h1.5v-.3c0-1.1 0-3.5 1-4.5.3-.3.7-.5 1.2-.5zm13.8 4V11h-1.5v.3c0 1.1 0 3.5-1 4.5-.3.3-.7.5-1.3.5H8.8l1.7-1.7-1.1-1.1L5.9 17l3.5 4 1.1-1-1.9-2.3H17c.9 0 1.7-.3 2.3-.9 1.5-1.4 1.5-4.2 1.5-5.6z"})}),Bn=(0,e.jsx)(et.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,e.jsx)(et.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),Mn=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Fn=function(t){var n=t.disabled,r=t.onPostClick,o=t.suggestions,i=(0,Ge.useState)(""),a=i[0],s=i[1],l=(0,Ge.useRef)(null),c=(0,Ot.useDebounce)(s,300),u=(0,Ge.useState)([]),d=u[0],p=u[1],f=(0,Me.useSelect)((function(e){return e(Kt).getCurrentPost()}),[]);return(0,Ge.useEffect)((function(){var e,t=[null!==(e=null==f?void 0:f.id)&&void 0!==e?e:0];o.length>0&&(t=Mn(Mn([],t,!0),o.map((function(e){return e.targetPost.id})),!0)),p(t)}),[o,f]),(0,e.jsx)(Xe.Dropdown,{contentClassName:"wp-parsely-traffic-boost-add-new-link-popover",onClose:function(){s("")},renderToggle:function(t){var r=t.isOpen,o=t.onToggle;return(0,e.jsx)(Xe.Button,{icon:Bn,variant:"secondary",className:"traffic-boost-add-suggestion",onClick:o,isPressed:r,disabled:n,children:(0,Be.__)("Add Source Post","wp-parsely")})},popoverProps:{placement:"bottom-start"},renderContent:function(t){var n=t.onClose;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:(0,Be.__)("Manually add a post where you would like Parse.ly to plant a link.","wp-parsely")}),(0,e.jsx)("div",{children:(0,e.jsx)(Xe.SearchControl,{__nextHasNoMarginBottom:!0,ref:l,value:a,onChange:c})}),a&&(0,e.jsx)(Rt,{currentPage:1,setCurrentPage:function(){},className:"traffic-boost-add-link-table",query:{status:"publish",per_page:5,search:a,search_columns:["post_title","post_excerpt"],exclude:d,context:"edit"},hideHeader:!0,hidePagination:!0,compact:!0,noResultsMessage:(0,Be.__)("No posts found.","wp-parsely"),onPostClick:function(e){r(e),n()}})]})}})},Un=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Hn=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Vn=function(t){var n=t.variant,r=t.isGeneratingSuggestions,o=t.handleGenerateSuggestions;return(0,e.jsx)(Xe.Button,{icon:Gn,variant:n,isBusy:r,disabled:r,className:"traffic-boost-add-suggestion",onClick:o,children:r?(0,Be.__)("Generating…","wp-parsely"):(0,Be.__)("Generate","wp-parsely")})},$n=function(t){var n=t.onSuggestionClick,r=bn.getInstance(),o=(0,Me.useSelect)((function(e){return{currentPost:e(Kt).getCurrentPost(),selectedLink:e(Kt).getSelectedLink(),suggestions:e(Kt).getSuggestions(),inboundLinks:e(Kt).getInboundLinks(),isGeneratingSuggestions:e(Kt).isGeneratingSuggestions(),isLoadingSuggestions:e(Kt).isLoadingSuggestions(),settings:e(Kt).getSettings(),suggestionsToGenerate:e(Kt).getSuggestionsToGenerate()}}),[]),i=o.currentPost,a=o.selectedLink,s=o.suggestions,l=o.inboundLinks,c=o.settings,u=o.isGeneratingSuggestions,d=o.isLoadingSuggestions,p=o.suggestionsToGenerate,f=(0,Me.useDispatch)(Kt),h=f.setSelectedLink,g=f.addSuggestion,v=f.setSuggestions,m=f.updateSuggestion,y=f.setIsGeneratingSuggestions,b=f.setIsGenerating,w=f.removeSuggestion,x=f.setSuggestionsToGenerate,k=(0,Me.useDispatch)("core/notices"),_=k.createSuccessNotice,S=k.createErrorNotice,E=function(){return Un(void 0,void 0,void 0,(function(){var t,n,o;return Hn(this,(function(a){switch(a.label){case 0:if(!i)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),y(!0),t=l.map((function(e){var t,n,r,o;return[null===(n=null===(t=e.smartLink)||void 0===t?void 0:t.post_data)||void 0===n?void 0:n.parsely_canonical_url,null===(o=null===(r=e.smartLink)||void 0===r?void 0:r.post_data)||void 0===o?void 0:o.permalink]})).flat().filter((function(e){return void 0!==e})),v([]),x(c.maxItems),[4,r.generateBatchSuggestions(i.id,c.maxItems,{urlExclusionList:t,discardPrevious:!0,save:!0,onNewSuggestions:function(e,t){v(e,!1),t&&h(e[0]),x((function(t){return Math.max(0,t-e.length)}))}})];case 2:return a.sent(),_((0,Be.__)("Finished generating suggestions.","wp-parsely"),{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Gn})}),y(!1),[3,4];case 3:return n=a.sent(),o=(0,Be.__)("Failed to generate suggestions.","wp-parsely"),n instanceof ot&&n.message&&n.code!==qe.UnknownError&&(o+=" ".concat(n.message)),S(o,{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Bt})}),y(!1),[3,4];case 4:return[2]}}))}))};return d&&u?(0,e.jsx)("div",{className:"traffic-boost-suggestions-loading-generating",children:(0,e.jsx)(pn,{messages:yn,typewriter:!0,randomOrder:!1})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(On,{isLoading:d,links:s,useScrollbar:!0,onClick:n,activeLink:(null==a?void 0:a.isSuggestion)?a:null,renderEmptyState:function(){return u?(0,e.jsx)("div",{className:"traffic-boost-suggestions-loading-generating",children:(0,e.jsx)(pn,{messages:yn,typewriter:!0,randomOrder:!1})}):(0,e.jsxs)("div",{className:"traffic-boost-suggestions-empty-state",children:[(0,e.jsx)("p",{children:(0,Be.__)("This post has no suggestions. Do you want to generate some?","wp-parsely")}),(0,e.jsx)(Vn,{variant:"primary",isGeneratingSuggestions:u,handleGenerateSuggestions:E})]})},children:[!d&&!u&&(0,e.jsx)(Fn,{disabled:u,suggestions:s,onPostClick:function(t){return Un(void 0,void 0,void 0,(function(){var n,o,s,l,c;return Hn(this,(function(u){switch(u.label){case 0:return i?(n=a,o=r.createSuggestion(t),[4,g(o)]):[2];case 1:return u.sent(),[4,b(o,!0)];case 2:u.sent(),u.label=3;case 3:return u.trys.push([3,6,,7]),[4,r.generateSuggestionForPost(i,t,o)];case 4:return s=u.sent(),[4,m(s,o.uid)];case 5:return u.sent(),b(o,!1),[3,7];case 6:return l=u.sent(),c=(0,Be.__)("Failed to find a link placement.","wp-parsely"),l instanceof ot&&l.message&&l.code!==qe.UnknownError&&(c+=" ".concat(l.message)),S(c,{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Bt})}),b(o,!1),w(o),h(n),[3,7];case 7:return[2]}}))}))}}),u&&s.length>0&&(0,e.jsxs)("div",{className:"traffic-boost-suggestions-generating-footer",children:[(0,e.jsx)(Xe.Spinner,{}),(0,e.jsx)("span",{children:(0,Be.sprintf)(/* translators: %d: number of suggestions generated */ /* translators: %d: number of suggestions generated */
(0,Be._n)("Generating %d last suggestion…","Generating %d more suggestions…",p,"wp-parsely"),p)})]})]})})},Wn=function(t){var n=t.activeTab,r=t.onSuggestionClick,o=t.onInboundLinkClick,i=t.hardError,a=(0,Me.useSelect)((function(e){return{selectedLink:e(Kt).getSelectedLink(),selectedTab:e(Kt).getSelectedTab()}}),[]),s=a.selectedLink,l=a.selectedTab,c=(0,Me.useDispatch)(Kt).setSelectedTab;if((0,Ge.useEffect)((function(){c(n.name)}),[n,c]),(0,Ge.useEffect)((function(){(null==s?void 0:s.isSuggestion)?c(Et.SUGGESTIONS):s&&!s.isSuggestion&&c(Et.INBOUND_LINKS)}),[s,c]),i){var u=i.Message();if(qe.ParselySuggestionsApiNoAuthorization===i.code){var d=(0,Be.sprintf)('<a href="%1$s" target="_blank" rel="noopener">%2$s</a>',"https://lobby.vip.wordpress.com/2025/05/19/introducing-traffic-boost-a-smarter-way-to-recirculate-your-content/",(0,Be.__)("Traffic Boost","wp-parsely")),p=(0,Be.sprintf)('<a href="%1$s" target="_blank" rel="noopener">%2$s</a>',"https://docs.wpvip.com/parse-ly/wp-parsely-features/traffic-boost/#Access",(0,Be.__)("here","wp-parsely")),f=(0,Be.sprintf)((0,Cn.escapeHTML)(/* translators: %1$s: Lobby Post link, %2$s: VIP Documentation link */ /* translators: %1$s: Lobby Post link, %2$s: VIP Documentation link */
(0,Be.__)("%1$s is currently not enabled for your Site ID. Information about requesting access to Traffic Boost can be found %2$s.","wp-parsely")),d,p);u=(0,e.jsx)(Ke,{children:f})}return(0,e.jsx)("div",{className:"traffic-boost-suggestions-empty-state",children:u})}switch(l){case Et.SUGGESTIONS:return(0,e.jsx)($n,{onSuggestionClick:r});case Et.INBOUND_LINKS:return(0,e.jsx)(Dn,{onInboundLinkClick:o});default:return(0,e.jsx)("div",{children:(0,Be.__)("Select a tab","wp-parsely")})}},zn=function(t){var n=t.onLinkClick,r=t.hardError,o=q(),i=(0,Me.useSelect)((function(e){return{post:e(Kt).getCurrentPost(),selectedTab:e(Kt).getSelectedTab(),suggestions:e(Kt).getSuggestions(),inboundLinks:e(Kt).getInboundLinks(),isLoadingPost:e(Kt).isLoadingPost()}}),[]),a=i.post,s=i.isLoadingPost,l=i.selectedTab,c=i.suggestions,u=i.inboundLinks,d=(0,Me.useDispatch)(Kt).setSelectedTab;return(0,Ge.useEffect)((function(){var e=function(e,t){var n=document.querySelector(e);if(n)if(t<=0){var r=n.querySelector(".tab-count");r&&r.remove()}else{var o=n.querySelector(".tab-count");o||((o=document.createElement("span")).className="tab-count",n.appendChild(o)),o.textContent=t.toString()}};e(".components-tab-panel__tabs-item.suggestions-tab",c.length),e(".components-tab-panel__tabs-item.inbound-links-tab",u.length)}),[u,u.length,c.length]),(0,Ge.useEffect)((function(){var e=document.querySelector(".traffic-boost-sidebar-tabs .".concat(l,"-tab"));e&&e.click()}),[l]),(0,e.jsxs)("div",{className:"traffic-boost-sidebar",children:[(0,e.jsx)(Nn,{isLoading:s,onBackClick:function(){return o("/traffic-boost")},post:null!=a?a:void 0}),(0,e.jsx)("div",{className:"traffic-boost-sidebar-content",children:(0,e.jsx)(Xe.TabPanel,{className:"traffic-boost-sidebar-tabs",tabs:[{name:Et.SUGGESTIONS,title:(0,Be.__)("Suggested Sources","wp-parsely"),className:"traffic-boost-tab suggestions-tab"},{name:Et.INBOUND_LINKS,title:(0,Be.__)("Inbound Links","wp-parsely"),className:"traffic-boost-tab inbound-links-tab"}],onSelect:function(e){return d(e)},children:function(t){return(0,e.jsx)(Wn,{activeTab:t,onSuggestionClick:n,onInboundLinkClick:n,hardError:r})}})})]})},qn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Kn=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Zn=function(){var n=function(){let{matches:e}=t.useContext(U),n=e[e.length-1];return n?n.params:{}}().postId,r=$().state,o=q(),i=(0,Ge.useState)(),a=i[0],s=i[1],l=(0,Ge.useState)(160),c=l[0],u=l[1],d=(0,Ge.useState)(!1),p=d[0],f=d[1],h=(0,Me.useSelect)((function(e){var t;return{isLoadingPost:e(Kt).isLoadingPost(),error:e(Kt).getError(),inboundLinks:e(Kt).getInboundLinks(),currentPost:null!==(t=null==r?void 0:r.post)&&void 0!==t?t:e(Kt).getCurrentPost(),selectedLink:e(Kt).getSelectedLink(),settings:e(Kt).getSettings(),suggestions:e(Kt).getSuggestions()}}),[null==r?void 0:r.post]),g=h.isLoadingPost,v=h.error,m=h.currentPost,y=h.inboundLinks,b=h.selectedLink,w=h.settings,x=h.suggestions,k=(0,Me.useDispatch)(Kt),_=k.setError,S=k.setLoading,E=k.setCurrentPost,P=k.setSelectedLink,L=k.setInboundLinks,j=k.setSuggestions,T=k.setIsGeneratingSuggestions,N=k.setSelectedTab,C=k.updateInboundLink,I=k.setSuggestionsToGenerate,A=(0,Me.useDispatch)("core/notices"),R=A.createSuccessNotice,O=A.createErrorNotice,D=v instanceof ot&&!v.retryFetch;return(0,Ge.useEffect)((function(){var e=document.getElementById("adminmenuback");if(e){var t=window.getComputedStyle(e);s(t.backgroundColor);var n=document.querySelector("#wpwrap");n&&(n.style.backgroundColor=t.backgroundColor);var r=function(){var t=e.getBoundingClientRect().width;u(t)};r();var o=new ResizeObserver((function(){r()}));return o.observe(e),function(){bn.getInstance().cancelAll(),o.disconnect(),n.style.backgroundColor="",T(!1),S(!1),_(null),L([]),j([]),E(null),P(null),N(Et.SUGGESTIONS)}}}),[]),(0,Ge.useEffect)((function(){(null==r?void 0:r.post)?E(r.post):(S(!0,"post"),qn(void 0,void 0,void 0,(function(){var e,t;return Kn(this,(function(r){switch(r.label){case 0:if(!n)return[2];r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,bn.getInstance().getPost(parseInt(n))];case 2:return e=r.sent(),E(e||null),[3,5];case 3:return t=r.sent(),_(t),console.error(t),[3,5];case 4:return S(!1,"post"),f(!0),[7];case 5:return[2]}}))})))}),[n,S,E,_,r]),(0,Ge.useEffect)((function(){return function(){E(null),P(null)}}),[E,P]),(0,Ge.useEffect)((function(){(null==b?void 0:b.isSuggestion)&&0===x.length&&P(null)}),[P,x,b]),(0,Ge.useEffect)((function(){!p||g||m||o("/traffic-boost")}),[p,g,m,o]),(0,Ge.useEffect)((function(){if(v&&!D){var t=(0,Be.__)("There was an issue while fetching the data.","wp-parsely")+(v instanceof ot?" ".concat(v.message):"");O(t,{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Bt})}),_(null)}}),[v,O,_,D]),(0,Ge.useEffect)((function(){qn(void 0,void 0,void 0,(function(){var e,t,r;return Kn(this,(function(o){switch(o.label){case 0:if(!n)return[2];o.label=1;case 1:return o.trys.push([1,3,4,5]),S(!0,"inbound-links"),[4,bn.getInstance().getInboundLinks(parseInt(n))];case 2:return e=o.sent(),t=e.filter((function(e){var t;return(null===(t=e.targetPost)||void 0===t?void 0:t.id)!==parseInt(n)})),L(t),[3,5];case 3:return r=o.sent(),_(r instanceof ot?r:new ot((0,Be.__)("Failed to fetch inbound links","wp-parsely"),qe.FetchError)),console.error(r),[3,5];case 4:return S(!1,"inbound-links"),[7];case 5:return[2]}}))}))}),[n,L,_,S]),(0,Ge.useEffect)((function(){n&&qn(void 0,void 0,void 0,(function(){var t,r,o,i;return Kn(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,6,7]),_(null),S(!0,"suggestions"),[4,(t=bn.getInstance()).getExistingSuggestions(parseInt(n))];case 1:return 0!==(r=a.sent()).length?[3,3]:(T(!0),o=y.map((function(e){var t,n,r,o;return[null===(n=null===(t=e.smartLink)||void 0===t?void 0:t.post_data)||void 0===n?void 0:n.parsely_canonical_url,null===(o=null===(r=e.smartLink)||void 0===r?void 0:r.post_data)||void 0===o?void 0:o.permalink]})).flat().filter((function(e){return void 0!==e})),I(w.maxItems),[4,t.generateBatchSuggestions(parseInt(n),w.maxItems,{urlExclusionList:o,discardPrevious:!0,save:!0,onNewSuggestions:function(e,t){t&&S(!1,"suggestions"),j(e,!1),t&&P(e[0]),I((function(t){return Math.max(0,t-e.length)}))}})]);case 2:return a.sent(),R((0,Be.__)("Finished generating suggestions.","wp-parsely"),{type:"snackbar",icon:(0,e.jsx)(Xe.Icon,{icon:Mt})}),[3,4];case 3:j(r),r.length>0&&P(r[0]),a.label=4;case 4:return[3,7];case 5:return(i=a.sent())instanceof ot&&_(i),console.error(i),[3,7];case 6:return T(!1),S(!1,"suggestions"),[7];case 7:return[2]}}))}))}),[n]),(0,e.jsxs)(Je,{name:"traffic-boost-single-post",backgroundColor:a,className:"traffic-boost-single-post",style:{position:"fixed",left:c,width:"calc(100% - calc(".concat(c,"px + var(--grid-unit-20)))"),transition:"left 0.3s ease, width 0.3s ease"},children:[(0,e.jsx)("style",{children:"\n\t\t\t\t\t#wpfooter {\n\t\t\t\t\t\tdisplay: none;\n\t\t\t\t\t}\n\t\t\t\t\t#wpbody-content {\n\t\t\t\t\t\tpadding-bottom: 0 !important;\n\t\t\t\t\t}\n\t\t\t\t"}),(0,e.jsx)(zn,{onLinkClick:function(e){P(e)},hardError:D?v:void 0}),b&&(0,e.jsx)(jn,{activeLink:b,onAccept:function(e,t){return qn(void 0,void 0,void 0,(function(){var n,r,o,i;return Kn(this,(function(a){switch(a.label){case 0:return e.smartLink&&m&&0!==e.smartLink.smart_link_id?[4,bn.getInstance().acceptSuggestion(m.id,e.smartLink.smart_link_id,{text:null==t?void 0:t.text,offset:null==t?void 0:t.offset})]:[2,!1];case 1:return n=a.sent(),r=n.success,o=n.didReplaceLink,i=n.postContent,o&&(e.smartLink.is_link_replacement=!0),e.targetPost.content.raw=i,[2,r]}}))}))},onDiscard:function(e){return qn(void 0,void 0,void 0,(function(){return Kn(this,(function(t){return e.smartLink&&m&&0!==e.smartLink.smart_link_id?(bn.getInstance().discardSuggestion(m.id,e.smartLink.smart_link_id),[2]):[2]}))}))},onRemoveInboundLink:function(e,t){return qn(void 0,void 0,void 0,(function(){return Kn(this,(function(n){switch(n.label){case 0:return e.smartLink&&m&&0!==e.smartLink.smart_link_id?[4,bn.getInstance().removeInboundLink(m.id,e.smartLink.smart_link_id,t)]:[2,!1];case 1:return[2,n.sent()]}}))}))},onUpdateInboundLink:function(e,t,n,r){return qn(void 0,void 0,void 0,(function(){var o;return Kn(this,(function(i){switch(i.label){case 0:return e.smartLink&&m&&0!==e.smartLink.smart_link_id?[4,bn.getInstance().updateInboundLink(m.id,e.smartLink.smart_link_id,{text:t,offset:n,restore_original:r})]:[2,!1];case 1:return(o=i.sent())&&(e.smartLink=o.data.smart_link,e.targetPost.content.raw=o.data.post_content,C(e,e.smartLink.uid)),[2,!0]}}))}))}}),(0,e.jsx)(Ht,{className:b?"traffic-boost-snackbar-notices":""})]})};De()((function(){var t;null===(t=document.querySelector("#toplevel_page_parsely-dashboard-page .wp-submenu li.wp-first-item"))||void 0===t||t.classList.add("current"),(0,Ge.createRoot)(document.getElementById("parsely-dashboard-page")).render((0,e.jsx)(Te,{children:(0,e.jsx)(Yn,{})}))}));var Yn=function(){return(0,e.jsxs)(se,{children:[(0,e.jsx)(ie,{path:"/",element:(0,e.jsx)(oe,{to:"/traffic-boost",replace:!0})}),(0,e.jsx)(ie,{path:"/traffic-boost",element:(0,e.jsx)(Dt,{})}),(0,e.jsx)(ie,{path:"/traffic-boost/:postId",element:(0,e.jsx)(Zn,{})}),(0,e.jsx)(ie,{path:"/settings",element:(0,e.jsx)(Gt,{})})]})}}()}();