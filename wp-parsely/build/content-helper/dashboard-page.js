!function(){"use strict";var t={69:function(t,e){Object.prototype.toString},20:function(t,e,n){var r=n(609),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)a.call(e,r)&&!l.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===i[r]&&(i[r]=e[r]);return{$$typeof:o,type:t,key:c,ref:u,props:i,_owner:s.current}}e.Fragment=i,e.jsx=c,e.jsxs=c},848:function(t,e,n){t.exports=n(20)},609:function(t){t.exports=window.React}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t=n(848),e=n(609),r=(n(69),"popstate");function o(t={}){return function(t,e,n,o={}){let{window:a=document.defaultView,v5Compat:u=!1}=o,d=a.history,p="POP",f=null,h=g();function g(){return(d.state||{idx:null}).idx}function v(){p="POP";let t=g(),e=null==t?null:t-h;h=t,f&&f({action:p,location:y.location,delta:e})}function m(t){return function(t,e=!1){let n="http://localhost";"undefined"!=typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),i(n,"No window.location.(origin|href) available to create URL");let r="string"==typeof t?t:c(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}(t)}null==h&&(h=0,d.replaceState({...d.state,idx:h},""));let y={get action(){return p},get location(){return t(a,d)},listen(t){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(r,v),f=t,()=>{a.removeEventListener(r,v),f=null}},createHref(t){return e(a,t)},createURL:m,encodeLocation(t){let e=m(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,e){p="PUSH";let r=l(y.location,t,e);n&&n(r,t),h=g()+1;let o=s(r,h),i=y.createHref(r);try{d.pushState(o,"",i)}catch(t){if(t instanceof DOMException&&"DataCloneError"===t.name)throw t;a.location.assign(i)}u&&f&&f({action:p,location:y.location,delta:1})},replace:function(t,e){p="REPLACE";let r=l(y.location,t,e);n&&n(r,t),h=g();let o=s(r,h),i=y.createHref(r);d.replaceState(o,"",i),u&&f&&f({action:p,location:y.location,delta:0})},go(t){return d.go(t)}};return y}((function(t,e){let{pathname:n="/",search:r="",hash:o=""}=u(t.location.hash.substring(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),l("",{pathname:n,search:r,hash:o},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){let n=t.document.querySelector("base"),r="";if(n&&n.getAttribute("href")){let e=t.location.href,n=e.indexOf("#");r=-1===n?e:e.slice(0,n)}return r+"#"+("string"==typeof e?e:c(e))}),(function(t,e){a("/"===t.pathname.charAt(0),`relative pathnames are not supported in hash history.push(${JSON.stringify(e)})`)}),t)}function i(t,e){if(!1===t||null==t)throw new Error(e)}function a(t,e){if(!t){"undefined"!=typeof console&&console.warn(e);try{throw new Error(e)}catch(t){}}}function s(t,e){return{usr:t.state,key:t.key,idx:e}}function l(t,e,n=null,r){return{pathname:"string"==typeof t?t:t.pathname,search:"",hash:"",..."string"==typeof e?u(e):e,state:n,key:e&&e.key||r||Math.random().toString(36).substring(2,10)}}function c({pathname:t="/",search:e="",hash:n=""}){return e&&"?"!==e&&(t+="?"===e.charAt(0)?e:"?"+e),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function u(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function d(t,e,n="/"){return function(t,e,n,r){let o=E(("string"==typeof e?u(e):e).pathname||"/",n);if(null==o)return null;let i=p(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){return t.length===e.length&&t.slice(0,-1).every(((t,n)=>t===e[n]))?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(i);let a=null;for(let t=0;null==a&&t<i.length;++t){let e=S(o);a=k(i[t],e,r)}return a}(t,e,n,!1)}function p(t,e=[],n=[],r=""){let o=(t,o,a)=>{let s={relativePath:void 0===a?t.path||"":a,caseSensitive:!0===t.caseSensitive,childrenIndex:o,route:t};s.relativePath.startsWith("/")&&(i(s.relativePath.startsWith(r),`Absolute route path "${s.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),s.relativePath=s.relativePath.slice(r.length));let l=T([r,s.relativePath]),c=n.concat(s);t.children&&t.children.length>0&&(i(!0!==t.index,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),p(t.children,e,c,l)),(null!=t.path||t.index)&&e.push({path:l,score:x(l,t.index),routesMeta:c})};return t.forEach(((t,e)=>{if(""!==t.path&&t.path?.includes("?"))for(let n of f(t.path))o(t,e,n);else o(t,e)})),e}function f(t){let e=t.split("/");if(0===e.length)return[];let[n,...r]=e,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return o?[i,""]:[i];let a=f(r.join("/")),s=[];return s.push(...a.map((t=>""===t?i:[i,t].join("/")))),o&&s.push(...a),s.map((e=>t.startsWith("/")&&""===e?"/":e))}new WeakMap;var h=/^:[\w-]+$/,g=3,v=2,m=1,y=10,w=-2,b=t=>"*"===t;function x(t,e){let n=t.split("/"),r=n.length;return n.some(b)&&(r+=w),e&&(r+=v),n.filter((t=>!b(t))).reduce(((t,e)=>t+(h.test(e)?g:""===e?m:y)),r)}function k(t,e,n=!1){let{routesMeta:r}=t,o={},i="/",a=[];for(let t=0;t<r.length;++t){let s=r[t],l=t===r.length-1,c="/"===i?e:e.slice(i.length)||"/",u=_({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},c),d=s.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=_({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},c)),!u)return null;Object.assign(o,u.params),a.push({params:o,pathname:T([i,u.pathname]),pathnameBase:N(T([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=T([i,u.pathnameBase]))}return a}function _(t,e){"string"==typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=function(t,e=!1,n=!0){a("*"===t||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((t,e,n)=>(r.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));return t.endsWith("*")?(r.push({paramName:"*"}),o+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==t&&"/"!==t&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let i=o[0],s=i.replace(/(.)\/+$/,"$1"),l=o.slice(1);return{params:r.reduce(((t,{paramName:e,isOptional:n},r)=>{if("*"===e){let t=l[r]||"";s=i.slice(0,i.length-t.length).replace(/(.)\/+$/,"$1")}const o=l[r];return t[e]=n&&!o?void 0:(o||"").replace(/%2F/g,"/"),t}),{}),pathname:i,pathnameBase:s,pattern:t}}function S(t){try{return t.split("/").map((t=>decodeURIComponent(t).replace(/\//g,"%2F"))).join("/")}catch(e){return a(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function E(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&"/"!==r?null:t.slice(n)||"/"}function P(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function L(t){let e=function(t){return t.filter(((t,e)=>0===e||t.route.path&&t.route.path.length>0))}(t);return e.map(((t,n)=>n===e.length-1?t.pathname:t.pathnameBase))}function j(t,e,n,r=!1){let o;"string"==typeof t?o=u(t):(o={...t},i(!o.pathname||!o.pathname.includes("?"),P("?","pathname","search",o)),i(!o.pathname||!o.pathname.includes("#"),P("#","pathname","hash",o)),i(!o.search||!o.search.includes("#"),P("#","search","hash",o)));let a,s=""===t||""===o.pathname,l=s?"/":o.pathname;if(null==l)a=n;else{let t=e.length-1;if(!r&&l.startsWith("..")){let e=l.split("/");for(;".."===e[0];)e.shift(),t-=1;o.pathname=e.join("/")}a=t>=0?e[t]:"/"}let c=function(t,e="/"){let{pathname:n,search:r="",hash:o=""}="string"==typeof t?u(t):t,i=n?n.startsWith("/")?n:function(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach((t=>{".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)})),n.length>1?n.join("/"):"/"}(n,e):e;return{pathname:i,search:C(r),hash:I(o)}}(o,a),d=l&&"/"!==l&&l.endsWith("/"),p=(s||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!d&&!p||(c.pathname+="/"),c}var T=t=>t.join("/").replace(/\/\/+/g,"/"),N=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),C=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",I=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";function R(t){return null!=t&&"number"==typeof t.status&&"string"==typeof t.statusText&&"boolean"==typeof t.internal&&"data"in t}var A=["POST","PUT","PATCH","DELETE"],O=(new Set(A),["GET",...A]);new Set(O),Symbol("ResetLoaderData");var D=e.createContext(null);D.displayName="DataRouter";var B=e.createContext(null);B.displayName="DataRouterState";var M=e.createContext({isTransitioning:!1});M.displayName="ViewTransition",e.createContext(new Map).displayName="Fetchers",e.createContext(null).displayName="Await";var G=e.createContext(null);G.displayName="Navigation";var F=e.createContext(null);F.displayName="Location";var U=e.createContext({outlet:null,matches:[],isDataRoute:!1});U.displayName="Route";var H=e.createContext(null);function V(){return null!=e.useContext(F)}function $(){return i(V(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(F).location}H.displayName="RouteError";var W="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function z(t){e.useContext(G).static||e.useLayoutEffect(t)}function q(){let{isDataRoute:t}=e.useContext(U);return t?function(){let{router:t}=function(t){let n=e.useContext(D);return i(n,tt(t)),n}("useNavigate"),n=et("useNavigate"),r=e.useRef(!1);return z((()=>{r.current=!0})),e.useCallback((async(e,o={})=>{a(r.current,W),r.current&&("number"==typeof e?t.navigate(e):await t.navigate(e,{fromRouteId:n,...o}))}),[t,n])}():function(){i(V(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(D),{basename:n,navigator:r}=e.useContext(G),{matches:o}=e.useContext(U),{pathname:s}=$(),l=JSON.stringify(L(o)),c=e.useRef(!1);return z((()=>{c.current=!0})),e.useCallback(((e,o={})=>{if(a(c.current,W),!c.current)return;if("number"==typeof e)return void r.go(e);let i=j(e,JSON.parse(l),s,"path"===o.relative);null==t&&"/"!==n&&(i.pathname="/"===i.pathname?n:T([n,i.pathname])),(o.replace?r.replace:r.push)(i,o.state,o)}),[n,r,l,s,t])}()}function Z(t,{relative:n}={}){let{matches:r}=e.useContext(U),{pathname:o}=$(),i=JSON.stringify(L(r));return e.useMemo((()=>j(t,JSON.parse(i),o,"path"===n)),[t,i,o,n])}function K(t,n,r,o){i(V(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=e.useContext(G),{matches:l}=e.useContext(U),c=l[l.length-1],p=c?c.params:{},f=c?c.pathname:"/",h=c?c.pathnameBase:"/",g=c&&c.route;{let t=g&&g.path||"";rt(f,!g||t.endsWith("*")||t.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${t}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${t}"> to <Route path="${"/"===t?"*":`${t}/*`}">.`)}let v,m=$();if(n){let t="string"==typeof n?u(n):n;i("/"===h||t.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${t.pathname}" was given in the \`location\` prop.`),v=t}else v=m;let y=v.pathname||"/",w=y;if("/"!==h){let t=h.replace(/^\//,"").split("/");w="/"+y.replace(/^\//,"").split("/").slice(t.length).join("/")}let b=d(t,{pathname:w});a(g||null!=b,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),a(null==b||void 0!==b[b.length-1].route.element||void 0!==b[b.length-1].route.Component||void 0!==b[b.length-1].route.lazy,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=function(t,n=[],r=null){if(null==t){if(!r)return null;if(r.errors)t=r.matches;else{if(0!==n.length||r.initialized||!(r.matches.length>0))return null;t=r.matches}}let o=t,a=r?.errors;if(null!=a){let t=o.findIndex((t=>t.route.id&&void 0!==a?.[t.route.id]));i(t>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),o=o.slice(0,Math.min(o.length,t+1))}let s=!1,l=-1;if(r)for(let t=0;t<o.length;t++){let e=o[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=t),e.route.id){let{loaderData:t,errors:n}=r,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!n||void 0===n[e.route.id]);if(e.route.lazy||i){s=!0,o=l>=0?o.slice(0,l+1):[o[0]];break}}}return o.reduceRight(((t,i,c)=>{let u,d=!1,p=null,f=null;r&&(u=a&&i.route.id?a[i.route.id]:void 0,p=i.route.errorElement||J,s&&(l<0&&0===c?(rt("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,f=null):l===c&&(d=!0,f=i.route.hydrateFallbackElement||null)));let h=n.concat(o.slice(0,c+1)),g=()=>{let n;return n=u?p:d?f:i.route.Component?e.createElement(i.route.Component,null):i.route.element?i.route.element:t,e.createElement(Q,{match:i,routeContext:{outlet:t,matches:h,isDataRoute:null!=r},children:n})};return r&&(i.route.ErrorBoundary||i.route.errorElement||0===c)?e.createElement(X,{location:r.location,revalidation:r.revalidation,component:p,error:u,children:g(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):g()}),null)}(b&&b.map((t=>Object.assign({},t,{params:Object.assign({},p,t.params),pathname:T([h,s.encodeLocation?s.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?h:T([h,s.encodeLocation?s.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),l,r,o);return n&&x?e.createElement(F.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},x):x}function Y(){let t=function(){let t=e.useContext(H),n=function(t){let n=e.useContext(B);return i(n,tt(t)),n}("useRouteError"),r=et("useRouteError");return void 0!==t?t:n.errors?.[r]}(),n=R(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,o="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:o},s={padding:"2px 4px",backgroundColor:o},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=e.createElement(e.Fragment,null,e.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:s},"ErrorBoundary")," or"," ",e.createElement("code",{style:s},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),r?e.createElement("pre",{style:a},r):null,l)}e.createContext(null);var J=e.createElement(Y,null),X=class extends e.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return void 0!==this.state.error?e.createElement(U.Provider,{value:this.props.routeContext},e.createElement(H.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Q({routeContext:t,match:n,children:r}){let o=e.useContext(D);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),e.createElement(U.Provider,{value:t},r)}function tt(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function et(t){let n=function(t){let n=e.useContext(U);return i(n,tt(t)),n}(t),r=n.matches[n.matches.length-1];return i(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}var nt={};function rt(t,e,n){e||nt[t]||(nt[t]=!0,a(!1,n))}function ot({to:t,replace:n,state:r,relative:o}){i(V(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=e.useContext(G);a(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=e.useContext(U),{pathname:c}=$(),u=q(),d=j(t,L(l),c,"path"===o),p=JSON.stringify(d);return e.useEffect((()=>{u(JSON.parse(p),{replace:n,state:r,relative:o})}),[u,p,o,n,r]),null}function it(t){i(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function at({basename:t="/",children:n=null,location:r,navigationType:o="POP",navigator:s,static:l=!1}){i(!V(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),d=e.useMemo((()=>({basename:c,navigator:s,static:l,future:{}})),[c,s,l]);"string"==typeof r&&(r=u(r));let{pathname:p="/",search:f="",hash:h="",state:g=null,key:v="default"}=r,m=e.useMemo((()=>{let t=E(p,c);return null==t?null:{location:{pathname:t,search:f,hash:h,state:g,key:v},navigationType:o}}),[c,p,f,h,g,v,o]);return a(null!=m,`<Router basename="${c}"> is not able to match the URL "${p}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),null==m?null:e.createElement(G.Provider,{value:d},e.createElement(F.Provider,{children:n,value:m}))}function st({children:t,location:e}){return K(lt(t),e)}function lt(t,n=[]){let r=[];return e.Children.forEach(t,((t,o)=>{if(!e.isValidElement(t))return;let a=[...n,o];if(t.type===e.Fragment)return void r.push.apply(r,lt(t.props.children,a));i(t.type===it,`[${"string"==typeof t.type?t.type:t.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),i(!t.props.index||!t.props.children,"An index route cannot have child routes.");let s={id:t.props.id||a.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(s.children=lt(t.props.children,a)),r.push(s)})),r}e.memo((function({routes:t,future:e,state:n}){return K(t,void 0,n,e)})),e.Component;var ct="get",ut="application/x-www-form-urlencoded";function dt(t){return null!=t&&"string"==typeof t.tagName}var pt=null,ft=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ht(t){return null==t||ft.has(t)?t:(a(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ut}"`),null)}function gt(t,e){if(!1===t||null==t)throw new Error(e)}function vt(t){return null!=t&&(null==t.href?"preload"===t.rel&&"string"==typeof t.imageSrcSet&&"string"==typeof t.imageSizes:"string"==typeof t.rel&&"string"==typeof t.href)}function mt(t,e,n,r,o,i){let a=(t,e)=>!n[e]||t.route.id!==n[e].route.id,s=(t,e)=>n[e].pathname!==t.pathname||n[e].route.path?.endsWith("*")&&n[e].params["*"]!==t.params["*"];return"assets"===i?e.filter(((t,e)=>a(t,e)||s(t,e))):"data"===i?e.filter(((e,i)=>{let l=r.routes[e.route.id];if(!l||!l.hasLoader)return!1;if(a(e,i)||s(e,i))return!0;if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:e.params,defaultShouldRevalidate:!0});if("boolean"==typeof r)return r}return!0})):[]}function yt(t,e,{includeHydrateFallback:n}={}){return r=t.map((t=>{let r=e.routes[t.route.id];if(!r)return[];let o=[r.module];return r.clientActionModule&&(o=o.concat(r.clientActionModule)),r.clientLoaderModule&&(o=o.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(o=o.concat(r.hydrateFallbackModule)),r.imports&&(o=o.concat(r.imports)),o})).flat(1),[...new Set(r)];var r}Object.getOwnPropertyNames(Object.prototype).sort().join("\0"),"undefined"!=typeof window?window:"undefined"!=typeof globalThis&&globalThis,Symbol("SingleFetchRedirect");function wt(){let t=e.useContext(D);return gt(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function bt(){let t=e.useContext(B);return gt(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}e.Component;var xt=e.createContext(void 0);function kt(){let t=e.useContext(xt);return gt(t,"You must render this element inside a <HydratedRouter> element"),t}function _t(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function St({page:t,...n}){let{router:r}=wt(),o=e.useMemo((()=>d(r.routes,t,r.basename)),[r.routes,t,r.basename]);return o?e.createElement(Pt,{page:t,matches:o,...n}):null}function Et(t){let{manifest:n,routeModules:r}=kt(),[o,i]=e.useState([]);return e.useEffect((()=>{let e=!1;return async function(t,e,n){return function(t,e){let n=new Set,r=new Set(e);return t.reduce(((t,o)=>{if(e&&(null==(i=o)||"string"!=typeof i.page)&&"script"===o.as&&o.href&&r.has(o.href))return t;var i;let a=JSON.stringify(function(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}(o));return n.has(a)||(n.add(a),t.push({key:a,link:o})),t}),[])}((await Promise.all(t.map((async t=>{let r=e.routes[t.route.id];if(r){let t=await async function(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(e){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}(r,n);return t.links?t.links():[]}return[]})))).flat(1).filter(vt).filter((t=>"stylesheet"===t.rel||"preload"===t.rel)).map((t=>"stylesheet"===t.rel?{...t,rel:"prefetch",as:"style"}:{...t,rel:"prefetch"})))}(t,n,r).then((t=>{e||i(t)})),()=>{e=!0}}),[t,n,r]),o}function Pt({page:t,matches:n,...r}){let o=$(),{manifest:i,routeModules:a}=kt(),{basename:s}=wt(),{loaderData:l,matches:c}=bt(),u=e.useMemo((()=>mt(t,n,c,i,o,"data")),[t,n,c,i,o]),d=e.useMemo((()=>mt(t,n,c,i,o,"assets")),[t,n,c,i,o]),p=e.useMemo((()=>{if(t===o.pathname+o.search+o.hash)return[];let e=new Set,r=!1;if(n.forEach((t=>{let n=i.routes[t.route.id];n&&n.hasLoader&&(!u.some((e=>e.route.id===t.route.id))&&t.route.id in l&&a[t.route.id]?.shouldRevalidate||n.hasClientLoader?r=!0:e.add(t.route.id))})),0===e.size)return[];let c=function(t,e){let n="string"==typeof t?new URL(t,"undefined"==typeof window?"server://singlefetch/":window.location.origin):t;return"/"===n.pathname?n.pathname="_root.data":e&&"/"===E(n.pathname,e)?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}(t,s);return r&&e.size>0&&c.searchParams.set("_routes",n.filter((t=>e.has(t.route.id))).map((t=>t.route.id)).join(",")),[c.pathname+c.search]}),[s,l,o,i,u,n,t,a]),f=e.useMemo((()=>yt(d,i)),[d,i]),h=Et(d);return e.createElement(e.Fragment,null,p.map((t=>e.createElement("link",{key:t,rel:"prefetch",as:"fetch",href:t,...r}))),f.map((t=>e.createElement("link",{key:t,rel:"modulepreload",href:t,...r}))),h.map((({key:t,link:n})=>e.createElement("link",{key:t,...n}))))}xt.displayName="FrameworkContext";function Lt(...t){return e=>{t.forEach((t=>{"function"==typeof t?t(e):null!=t&&(t.current=e)}))}}var jt="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{jt&&(window.__reactRouterVersion="7.6.2")}catch(t){}function Tt({basename:t,children:n,window:r}){let i=e.useRef();null==i.current&&(i.current=o({window:r,v5Compat:!0}));let a=i.current,[s,l]=e.useState({action:a.action,location:a.location}),c=e.useCallback((t=>{e.startTransition((()=>l(t)))}),[l]);return e.useLayoutEffect((()=>a.listen(c)),[a,c]),e.createElement(at,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a})}var Nt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ct=e.forwardRef((function({onClick:t,discover:n="render",prefetch:r="none",relative:o,reloadDocument:s,replace:l,state:u,target:d,to:p,preventScrollReset:f,viewTransition:h,...g},v){let m,{basename:y}=e.useContext(G),w="string"==typeof p&&Nt.test(p),b=!1;if("string"==typeof p&&w&&(m=p,jt))try{let t=new URL(window.location.href),e=p.startsWith("//")?new URL(t.protocol+p):new URL(p),n=E(e.pathname,y);e.origin===t.origin&&null!=n?p=n+e.search+e.hash:b=!0}catch(t){a(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=function(t,{relative:n}={}){i(V(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:o}=e.useContext(G),{hash:a,pathname:s,search:l}=Z(t,{relative:n}),c=s;return"/"!==r&&(c="/"===s?r:T([r,s])),o.createHref({pathname:c,search:l,hash:a})}(p,{relative:o}),[k,_,S]=function(t,n){let r=e.useContext(xt),[o,i]=e.useState(!1),[a,s]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:p}=n,f=e.useRef(null);e.useEffect((()=>{if("render"===t&&s(!0),"viewport"===t){let t=new IntersectionObserver((t=>{t.forEach((t=>{s(t.isIntersecting)}))}),{threshold:.5});return f.current&&t.observe(f.current),()=>{t.disconnect()}}}),[t]),e.useEffect((()=>{if(o){let t=setTimeout((()=>{s(!0)}),100);return()=>{clearTimeout(t)}}}),[o]);let h=()=>{i(!0)},g=()=>{i(!1),s(!1)};return r?"intent"!==t?[a,f,{}]:[a,f,{onFocus:_t(l,h),onBlur:_t(c,g),onMouseEnter:_t(u,h),onMouseLeave:_t(d,g),onTouchStart:_t(p,h)}]:[!1,f,{}]}(r,g),P=function(t,{target:n,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}={}){let l=q(),u=$(),d=Z(t,{relative:a});return e.useCallback((e=>{if(function(t,e){return!(0!==t.button||e&&"_self"!==e||function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t))}(e,n)){e.preventDefault();let n=void 0!==r?r:c(u)===c(d);l(t,{replace:n,state:o,preventScrollReset:i,relative:a,viewTransition:s})}}),[u,l,d,r,o,n,t,i,a,s])}(p,{replace:l,state:u,target:d,preventScrollReset:f,relative:o,viewTransition:h}),L=e.createElement("a",{...g,...S,href:m||x,onClick:b||s?t:function(e){t&&t(e),e.defaultPrevented||P(e)},ref:Lt(v,_),target:d,"data-discover":w||"render"!==n?void 0:"true"});return k&&!w?e.createElement(e.Fragment,null,L,e.createElement(St,{page:x})):L}));function It(t){let n=e.useContext(D);return i(n,function(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(t)),n}Ct.displayName="Link",e.forwardRef((function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:o=!1,style:a,to:s,viewTransition:l,children:c,...u},d){let p=Z(s,{relative:u.relative}),f=$(),h=e.useContext(B),{navigator:g,basename:v}=e.useContext(G),m=null!=h&&function(t,n={}){let r=e.useContext(M);i(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=It("useViewTransitionState"),a=Z(t,{relative:n.relative});if(!r.isTransitioning)return!1;let s=E(r.currentLocation.pathname,o)||r.currentLocation.pathname,l=E(r.nextLocation.pathname,o)||r.nextLocation.pathname;return null!=_(a.pathname,l)||null!=_(a.pathname,s)}(p)&&!0===l,y=g.encodeLocation?g.encodeLocation(p).pathname:p.pathname,w=f.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;n||(w=w.toLowerCase(),b=b?b.toLowerCase():null,y=y.toLowerCase()),b&&v&&(b=E(b,v)||b);const x="/"!==y&&y.endsWith("/")?y.length-1:y.length;let k,S=w===y||!o&&w.startsWith(y)&&"/"===w.charAt(x),P=null!=b&&(b===y||!o&&b.startsWith(y)&&"/"===b.charAt(y.length)),L={isActive:S,isPending:P,isTransitioning:m},j=S?t:void 0;k="function"==typeof r?r(L):[r,S?"active":null,P?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let T="function"==typeof a?a(L):a;return e.createElement(Ct,{...u,"aria-current":j,className:k,ref:d,style:T,to:s,viewTransition:l},"function"==typeof c?c(L):c)})).displayName="NavLink",e.forwardRef((({discover:t="render",fetcherKey:n,navigate:r,reloadDocument:o,replace:a,state:s,method:l=ct,action:u,onSubmit:d,relative:p,preventScrollReset:f,viewTransition:h,...g},v)=>{let m=function(){let{router:t}=It("useSubmit"),{basename:n}=e.useContext(G),r=et("useRouteId");return e.useCallback((async(e,o={})=>{let{action:i,method:a,encType:s,formData:l,body:c}=function(t,e){let n,r,o,i,a;if(dt(s=t)&&"form"===s.tagName.toLowerCase()){let a=t.getAttribute("action");r=a?E(a,e):null,n=t.getAttribute("method")||ct,o=ht(t.getAttribute("enctype"))||ut,i=new FormData(t)}else if(function(t){return dt(t)&&"button"===t.tagName.toLowerCase()}(t)||function(t){return dt(t)&&"input"===t.tagName.toLowerCase()}(t)&&("submit"===t.type||"image"===t.type)){let a=t.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=t.getAttribute("formaction")||a.getAttribute("action");if(r=s?E(s,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||ct,o=ht(t.getAttribute("formenctype"))||ht(a.getAttribute("enctype"))||ut,i=new FormData(a,t),!function(){if(null===pt)try{new FormData(document.createElement("form"),0),pt=!1}catch(t){pt=!0}return pt}()){let{name:e,type:n,value:r}=t;if("image"===n){let t=e?`${e}.`:"";i.append(`${t}x`,"0"),i.append(`${t}y`,"0")}else e&&i.append(e,r)}}else{if(dt(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ct,r=null,o=ut,a=t}var s;return i&&"text/plain"===o&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:i,body:a}}(e,n);if(!1===o.navigate){let e=o.fetcherKey||At();await t.fetch(e,r,o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||a,formEncType:o.encType||s,flushSync:o.flushSync})}else await t.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:l,body:c,formMethod:o.method||a,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})}),[t,n,r])}(),y=function(t,{relative:n}={}){let{basename:r}=e.useContext(G),o=e.useContext(U);i(o,"useFormAction must be used inside a RouteContext");let[a]=o.matches.slice(-1),s={...Z(t||".",{relative:n})},l=$();if(null==t){s.search=l.search;let t=new URLSearchParams(s.search),e=t.getAll("index");if(e.some((t=>""===t))){t.delete("index"),e.filter((t=>t)).forEach((e=>t.append("index",e)));let n=t.toString();s.search=n?`?${n}`:""}}return t&&"."!==t||!a.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),"/"!==r&&(s.pathname="/"===s.pathname?r:T([r,s.pathname])),c(s)}(u,{relative:p}),w="get"===l.toLowerCase()?"get":"post",b="string"==typeof u&&Nt.test(u);return e.createElement("form",{ref:v,method:w,action:y,onSubmit:o?d:t=>{if(d&&d(t),t.defaultPrevented)return;t.preventDefault();let e=t.nativeEvent.submitter,o=e?.getAttribute("formmethod")||l;m(e||t.currentTarget,{fetcherKey:n,method:o,navigate:r,replace:a,state:s,relative:p,preventScrollReset:f,viewTransition:h})},...g,"data-discover":b||"render"!==t?void 0:"true"})})).displayName="Form";var Rt=0,At=()=>`__${String(++Rt)}__`;var Ot=window.wp.domReady,Dt=n.n(Ot),Bt=window.wp.element,Mt=window.wp.i18n,Gt=window.wp.data,Ft=function(){return Ft=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Ft.apply(this,arguments)},Ut={},Ht="wp-parsely/settings",Vt=(0,Gt.createReduxStore)(Ht,{initialState:Ut,reducer:function(t,e){var n,r;switch(void 0===t&&(t=Ut),e.type){case"SET_SETTINGS":return Ft(Ft({},t),((n={})[e.endpoint]=e.settings,n));case"SET_PARTIAL_SETTINGS":var o=t[e.endpoint]||{},i=Ft(Ft({},o),e.partialSettings);return Ft(Ft({},t),((r={})[e.endpoint]=i,r));default:return t}},actions:{setSettings:function(t,e){return{type:"SET_SETTINGS",endpoint:t,settings:e}},setPartialSettings:function(t,e){return{type:"SET_PARTIAL_SETTINGS",endpoint:t,partialSettings:e}}},selectors:{getSettings:function(t,e){return t[e]}}}),$t=window.wp.apiFetch,Wt=n.n($t);(0,Bt.createContext)({settings:{},setSettings:function(){console.error("WP Parse.ly: setSettings not implemented")}}),void 0!==(0,Gt.select)(Ht)||(0,Gt.register)(Vt);var zt,qt,Zt=function(e){void 0===e&&(e=null);var n="";(null==e?void 0:e.children)&&(n=e.children);var r="content-helper-error-message";return(null==e?void 0:e.className)&&(r+=" "+e.className),(0,t.jsx)("div",{className:r,"data-testid":null==e?void 0:e.testId,dangerouslySetInnerHTML:{__html:n}})},Kt=function(e){var n=e.className,r=e.children;return(0,t.jsx)("main",{className:"parsely-dashboard-page-body"+(n?" "+n:""),children:r})},Yt=function(){return Yt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Yt.apply(this,arguments)},Jt=function(e){var n=e.className,r=e.name,o=e.children,i=e.backgroundColor,a=e.style;return(0,t.jsx)("div",{className:"parsely-menu-page parsely-menu-page-"+r+(n?" "+n:""),style:Yt(Yt({},i?{backgroundColor:i}:{}),a),children:o})},Xt=function(e){var n=e.className,r=e.children;return(0,t.jsx)("header",{className:"parsely-dashboard-page-header"+(n?" "+n:""),children:r})},Qt=window.wp.components,te=window.wp.primitives,ee=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})}),ne=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M10.6 6L9.4 7l4.6 5-4.6 5 1.2 1 5.4-6z"})}),re=(zt=function(t,e){return zt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},zt(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function __(){this.constructor=t}zt(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){t.AccessToFeatureDisabled="ch_access_to_feature_disabled",t.CannotFormulateApiQuery="ch_cannot_formulate_api_query",t.FetchError="fetch_error",t.HttpRequestFailed="http_request_failed",t.ParselyAborted="ch_parsely_aborted",t[t.ParselyApiForbidden=403]="ParselyApiForbidden",t.ParselyApiResponseContainsError="ch_response_contains_error",t.ParselyApiReturnedNoData="ch_parsely_api_returned_no_data",t.ParselyApiReturnedTooManyResults="ch_parsely_api_returned_too_many_results",t.PluginCredentialsNotSetMessageDetected="parsely_credentials_not_set_message_detected",t.PluginSettingsApiSecretNotSet="parsely_api_secret_not_set",t.PluginSettingsSiteIdNotSet="parsely_site_id_not_set",t.PostIsNotPublished="ch_post_not_published",t.UnknownError="ch_unknown_error",t.ParselySuggestionsApiAuthUnavailable="AUTH_UNAVAILABLE",t.ParselySuggestionsApiNoAuthentication="NO_AUTHENTICATION",t.ParselySuggestionsApiNoAuthorization="NO_AUTHORIZATION",t.ParselySuggestionsApiNoData="NO_DATA",t.ParselySuggestionsApiOpenAiError="OPENAI_ERROR",t.ParselySuggestionsApiOpenAiSchema="OPENAI_SCHEMA",t.ParselySuggestionsApiOpenAiUnavailable="OPENAI_UNAVAILABLE",t.ParselySuggestionsApiSchemaError="SCHEMA_ERROR",t.TrafficBoostInboundLinkNotFound="tb_inbound_link_not_found"}(qt||(qt={}));var oe=function(e){function n(t,r,o){void 0===o&&(o=(0,Mt.__)("Error:","wp-parsely"));var i=this;t.startsWith(o)&&(o=""),(i=e.call(this,o.length>0?"".concat(o," ").concat(t):t)||this).hint=null,i.name=i.constructor.name,i.code=r;var a=[qt.AccessToFeatureDisabled,qt.ParselyApiForbidden,qt.ParselyApiResponseContainsError,qt.ParselyApiReturnedNoData,qt.ParselyApiReturnedTooManyResults,qt.PluginCredentialsNotSetMessageDetected,qt.PluginSettingsApiSecretNotSet,qt.PluginSettingsSiteIdNotSet,qt.PostIsNotPublished,qt.UnknownError,qt.ParselySuggestionsApiAuthUnavailable,qt.ParselySuggestionsApiNoAuthentication,qt.ParselySuggestionsApiNoAuthorization,qt.ParselySuggestionsApiNoData,qt.ParselySuggestionsApiSchemaError];return i.retryFetch=!a.includes(i.code),Object.setPrototypeOf(i,n.prototype),i.code===qt.AccessToFeatureDisabled?i.message=(0,Mt.__)("Access to this feature is disabled by the site's administration.","wp-parsely"):i.code===qt.ParselySuggestionsApiNoAuthorization?i.message=(0,Mt.__)('This AI-powered feature is opt-in. To gain access, please submit a request <a href="https://wpvip.com/content-helper/#content-helper-form" target="_blank" rel="noopener">here</a>.',"wp-parsely"):i.code===qt.ParselySuggestionsApiOpenAiError||i.code===qt.ParselySuggestionsApiOpenAiUnavailable?i.message=(0,Mt.__)("The Parse.ly API returned an internal server error. Please retry with a different input, or try again later.","wp-parsely"):i.code===qt.HttpRequestFailed&&i.message.includes("cURL error 28")?i.message=(0,Mt.__)("The Parse.ly API did not respond in a timely manner. Please try again later.","wp-parsely"):i.code===qt.ParselySuggestionsApiSchemaError?i.message=(0,Mt.__)("The Parse.ly API returned a validation error. Please try again with different parameters.","wp-parsely"):i.code===qt.ParselySuggestionsApiNoData?i.message=(0,Mt.__)("The Parse.ly API couldn't find any relevant data to fulfill the request. Please retry with a different input.","wp-parsely"):i.code===qt.ParselySuggestionsApiOpenAiSchema?i.message=(0,Mt.__)("The Parse.ly API returned an incorrect response. Please try again later.","wp-parsely"):i.code===qt.ParselySuggestionsApiAuthUnavailable&&(i.message=(0,Mt.__)("The Parse.ly API is currently unavailable. Please try again later.","wp-parsely")),i}return re(n,e),n.prototype.Message=function(e){return void 0===e&&(e=null),[qt.PluginCredentialsNotSetMessageDetected,qt.PluginSettingsSiteIdNotSet,qt.PluginSettingsApiSecretNotSet].includes(this.code)?function(e){var n;return void 0===e&&(e=null),(0,t.jsx)(Zt,{className:null==e?void 0:e.className,testId:"empty-credentials-message",children:null!==(n=window.wpParselyEmptyCredentialsMessage)&&void 0!==n?n:(0,Mt.__)("Please ensure that the Site ID and API Secret given in the plugin's settings are correct.","wp-parsely")})}(e):(this.code===qt.FetchError&&(this.hint=this.Hint((0,Mt.__)("This error can sometimes be caused by ad-blockers or browser tracking protections. Please add this site to any applicable allow lists and try again.","wp-parsely"))),this.code!==qt.ParselyApiForbidden&&this.code!==qt.ParselySuggestionsApiNoAuthentication||(this.hint=this.Hint((0,Mt.__)("Please ensure that the Site ID and API Secret given in the plugin's settings are correct.","wp-parsely"))),this.code===qt.HttpRequestFailed&&(this.hint=this.Hint((0,Mt.__)("The Parse.ly API cannot be reached. Please verify that you are online.","wp-parsely"))),(0,t.jsx)(Zt,{className:null==e?void 0:e.className,testId:"error",children:"<p>".concat(this.message,"</p>").concat(this.hint?this.hint:"")}))},n.prototype.Hint=function(t){return'<p className="content-helper-error-message-hint" data-testid="content-helper-error-message-hint"><strong>'.concat((0,Mt.__)("Hint:","wp-parsely"),"</strong> ").concat(t,"</p>")},n.prototype.createErrorSnackbar=function(){/<a.*?>/.test(this.message)||(0,Gt.dispatch)("core/notices").createNotice("error",this.message,{type:"snackbar"})},n}(Error),ie=window.wp.url,ae=function(){function t(){this.abortControllers=new Map}return t.prototype.cancelRequest=function(t){if(t)(e=this.abortControllers.get(t))&&(e.abort(),this.abortControllers.delete(t));else{var e,n=Array.from(this.abortControllers.keys()).pop();n&&(e=this.abortControllers.get(n))&&(e.abort(),this.abortControllers.delete(n))}},t.prototype.cancelAll=function(){this.abortControllers.forEach((function(t){return t.abort()})),this.abortControllers.clear()},t.prototype.getOrCreateController=function(t){if(t&&this.abortControllers.has(t))return{abortController:this.abortControllers.get(t),abortId:t};var e=null!=t?t:"auto-"+Date.now(),n=new AbortController;return this.abortControllers.set(e,n),{abortController:n,abortId:e}},t.prototype.fetch=function(t,e){return n=this,r=void 0,i=function(){var n,r,o,i,a,s;return function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}(this,(function(l){switch(l.label){case 0:n=this.getOrCreateController(e),r=n.abortController,o=n.abortId,t.signal=r.signal,l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,Wt()(t)];case 2:return(i=l.sent()).error?[2,Promise.reject(new oe(i.error.message,qt.ParselyApiResponseContainsError))]:[2,i.data];case 3:return"AbortError"===(a=l.sent()).name?[2,Promise.reject(new oe((0,Mt.__)("The operation was aborted.","wp-parsely"),qt.ParselyAborted))]:(s=a.message,"object"==typeof a.message&&a.message[0].msg&&(s=a.message[0].msg),[2,Promise.reject(new oe(s,a.code))]);case 4:return this.abortControllers.delete(o),[7];case 5:return[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function a(t){try{l(i.next(t))}catch(t){e(t)}}function s(t){try{l(i.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,s)}l((i=i.apply(n,r||[])).next())}));var n,r,o,i},t}(),se=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),le=function(){return le=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},le.apply(this,arguments)},ce=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},ue=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},de=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return se(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.getStats=function(t){return ce(this,void 0,void 0,(function(){var e,n;return ue(this,(function(r){switch(r.label){case 0:e=[],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.fetch({path:(0,ie.addQueryArgs)("/wp-parsely/v2/stats/posts",le({},t))})];case 2:return e=r.sent(),[3,4];case 3:if((n=r.sent())instanceof oe)throw n;if(n instanceof Error)throw new oe(n.message,qt.UnknownError);return[3,4];case 4:if(0===e.length)throw new oe((0,Mt.__)("No data was returned by the Parse.ly API.","wp-parsely"),qt.ParselyApiReturnedNoData);return[2,e]}}))}))},e.prototype.getStatsForPosts=function(t,e){return ce(this,void 0,void 0,(function(){var n;return ue(this,(function(r){return n=t.map((function(t){var n,r;return e.use_wp_permalink?t.link:null!==(r=null===(n=t.parsely)||void 0===n?void 0:n.canonical_url)&&void 0!==r?r:t.link})),[2,this.getStats(le(le({},e),{urls:n}))]}))}))},e}(ae),pe=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),fe=function(){return fe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},fe.apply(this,arguments)},he=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},ge=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pe(e,t),e.prototype.apiFetch=function(t,e){return he(this,void 0,void 0,(function(){var n,r,o,i,a,s,l,c,u,d,p,f;return ge(this,(function(h){switch(h.label){case 0:n=this.getOrCreateController(e),r=n.abortController,o=n.abortId,t.signal=r.signal,t.parse=!1,h.label=1;case 1:return h.trys.push([1,4,6,7]),[4,Wt()(t)];case 2:return i=h.sent(),a=i.headers.get("X-WP-Total"),s=i.headers.get("X-WP-TotalPages"),l=a?parseInt(a,10):0,c=s?parseInt(s,10):0,[4,i.json()];case 3:return u=h.sent(),[2,{total_items:l,total_pages:c,data:u,response:i}];case 4:return"AbortError"===(d=h.sent()).name?[2,Promise.reject(new oe((0,Mt.__)("The operation was aborted.","wp-parsely"),qt.ParselyAborted))]:[4,d.json()];case 5:return p=h.sent(),[2,Promise.reject(new oe(null!==(f=p.message)&&void 0!==f?f:"",p.code,""))];case 6:return this.abortControllers.delete(o),[7];case 7:return[2]}}))}))},e.prototype.fetch=function(t,e){return he(this,void 0,void 0,(function(){return ge(this,(function(n){switch(n.label){case 0:return[4,this.apiFetch(t,e)];case 1:return[2,n.sent().data]}}))}))},e.prototype.hydratePosts=function(t){return he(this,void 0,void 0,(function(){var e;return ge(this,(function(n){return e=t.map((function(t){var e,n,r,o,i,a,s,l,c,u,d=[],p=[],f="",h=(null===(n=t._embedded)||void 0===n?void 0:n.author)?t._embedded.author[0]:null;if((null===(r=null==t?void 0:t._embedded)||void 0===r?void 0:r["wp:term"])&&(d=(e=t._embedded["wp:term"])[0],p=e[1]),null===(o=null==t?void 0:t._embedded)||void 0===o?void 0:o["wp:featuredmedia"]){var g=null===(i=t._embedded["wp:featuredmedia"])||void 0===i?void 0:i[0];(f=null===(l=null===(s=null===(a=null==g?void 0:g.media_details)||void 0===a?void 0:a.sizes)||void 0===s?void 0:s.thumbnail)||void 0===l?void 0:l.source_url)||(f=null!==(c=null==g?void 0:g.source_url)&&void 0!==c?c:void 0)}var v=null===(u=t.parsely)||void 0===u?void 0:u.canonical_url;return fe(fe({},t),{thumbnail:f,author:h,categories:d,tags:p,parsely_canonical_url:v})})),[2,e]}))}))},e.prototype.getPosts=function(){return he(this,arguments,void 0,(function(t,e){var n,r,o,i,a,s;return void 0===t&&(t={}),ge(this,(function(l){switch(l.label){case 0:return n=null!==(a=t.rest_endpoint)&&void 0!==a?a:"/wp/v2/posts",r=null!==(s=t.context)&&void 0!==s?s:"view",[4,this.apiFetch({path:(0,ie.addQueryArgs)(n,fe(fe({},t),{_embed:!0,context:r})),method:"GET"},e)];case 1:return o=l.sent(),[4,this.hydratePosts(o.data)];case 2:return i=l.sent(),[2,fe(fe({},o),{data:i})]}}))}))},e.prototype.getPages=function(){return he(this,arguments,void 0,(function(t,e){var n,r,o,i;return void 0===t&&(t={}),ge(this,(function(a){switch(a.label){case 0:return n=null!==(i=t.context)&&void 0!==i?i:"view",[4,this.apiFetch({path:(0,ie.addQueryArgs)("/wp/v2/pages",fe(fe({},t),{_embed:!0,context:n})),method:"GET"},e)];case 1:return r=a.sent(),[4,this.hydratePosts(r.data)];case 2:return o=a.sent(),[2,fe(fe({},r),{data:o})]}}))}))},e.prototype.getPost=function(t,e){return he(this,void 0,void 0,(function(){var n;return ge(this,(function(r){switch(r.label){case 0:return[4,this.apiFetch({path:"/wp/v2/posts/".concat(t,"?_embed&context=").concat("edit"),method:"GET"},e)];case 1:return n=r.sent(),[4,this.hydratePosts([n.data])];case 2:return[2,r.sent()[0]]}}))}))},e.prototype.fetchFromRestApi=function(t){return he(this,arguments,void 0,(function(t,e,n){var r;return void 0===e&&(e={}),ge(this,(function(o){return r=fe({path:t,method:"GET"},e),[2,this.apiFetch(r,n)]}))}))},e}(ae),me=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return me(e,t),e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e}(ve),we=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})}),be=(0,t.jsxs)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,t.jsx)(te.Path,{d:"M15.5 7.5h-7V9h7V7.5Zm-7 3.5h7v1.5h-7V11Zm7 3.5h-7V16h7v-1.5Z"}),(0,t.jsx)(te.Path,{d:"M17 4H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2ZM7 5.5h10a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V6a.5.5 0 0 1 .5-.5Z"})]}),xe=function(e){var n,r,o=e.post,i=e.imageUrl,a=e.icon,s=void 0===a?be:a,l=e.size,c=void 0===l?100:l,u=e.className,d=void 0===u?"":u,p=null!==(n=null==o?void 0:o.thumbnail)&&void 0!==n?n:i,f=null!==(r=null==o?void 0:o.title.rendered)&&void 0!==r?r:"";return(0,t.jsx)("div",{className:"parsely-thumbnail ".concat(d),style:{width:c,height:c},children:p?(0,t.jsx)("img",{src:p,alt:f,width:c,height:c,loading:"lazy","aria-hidden":""===f}):(0,t.jsx)("div",{className:"parsely-thumbnail-icon-container",children:(0,t.jsx)(Qt.Icon,{icon:s,size:c})})})},ke={month:"short",day:"numeric",year:"numeric"},_e={month:"short",day:"numeric"},Se=(0,Mt.__)("Date N/A","wp-parsely");var Ee,Pe=function(e){var n=e.post,r=n.date?function(t){if(!1===function(t){return!isNaN(+t)&&0!==t.getTime()}(t))return Se;var e=ke;return t.getUTCFullYear()===(new Date).getUTCFullYear()&&(e=_e),Intl.DateTimeFormat(document.documentElement.lang||"en",e).format(t)}(new Date(n.date)):"",o=n.title.rendered;return""!==o&&o.length>80&&(o=o.substring(0,80)+"&hellip;"),(0,t.jsxs)("div",{className:"posts-table-post-info",children:[(0,t.jsx)(xe,{post:n,size:45,className:"posts-table-thumbnail"}),(0,t.jsxs)("div",{className:"post-details",children:[(0,t.jsx)("div",{className:"post-title",children:""!==o?(0,t.jsx)("span",{title:n.title.rendered,dangerouslySetInnerHTML:{__html:o}}):(0,Mt.__)("(no title)","wp-parsely")}),(0,t.jsxs)("div",{className:"post-meta",children:[(0,t.jsx)("span",{className:"post-date",children:r}),n.author&&(0,t.jsx)("span",{className:"post-author",children:n.author.name}),(0,t.jsx)("div",{className:"post-categories",children:n.categories&&n.categories.length>0&&n.categories.map((function(e){return(0,t.jsx)("span",{children:e.name},e.id)}))})]})]})]})},Le=function(e){var n=e.post;return(0,t.jsx)(Qt.DropdownMenu,{icon:we,label:(0,Mt.__)("Actions","wp-parsely"),children:function(e){var r=e.onClose;return(0,t.jsxs)(Qt.MenuGroup,{children:[(0,t.jsx)(Qt.MenuItem,{onClick:function(){window.open(n.link,"_blank","noopener,noreferrer"),r()},children:(0,Mt.__)("View","wp-parsely")}),(0,t.jsx)(Qt.MenuItem,{onClick:function(){var t;window.open((t=n.id,"/wp-admin/post.php?post=".concat(t,"&action=edit")),"_blank","noopener,noreferrer"),r()},children:(0,Mt.__)("Edit","wp-parsely")})]})}})},je=function(e){var n,r,o,i=e.post,a=e.index,s=e.onPostClick,l=e.stats,c=e.compact,u=e.isLoadingStats,d=e.showStats,p=void 0===d||d,f=e.showActions,h=void 0===f||f,g=e.onErrorLoadingStats,v=(0,Bt.useState)(u),m=v[0],y=v[1],w=null===(n=null==l?void 0:l.views)||void 0===n?void 0:n.replace(/\D/g,""),b=parseInt(null!=w?w:"0",10),x=Number(null!==(o=null===(r=null==l?void 0:l.campaign)||void 0===r?void 0:r.views)&&void 0!==o?o:0),k=b-x,_=k>0?x/k*100:0;return(0,Bt.useEffect)((function(){void 0!==l||u?void 0!==l&&y(!1):(null==g||g(i),y(!0))}),[i,u,l,g]),(0,t.jsxs)("tr",{className:a%2==0?"row-even":"row-odd",onClick:function(){return null==s?void 0:s(i)},children:[(0,t.jsx)("td",{className:"post-info",children:(0,t.jsx)(Pe,{post:i})}),!c&&(0,t.jsxs)(t.Fragment,{children:[p&&(0,t.jsx)("td",{className:"metrics",children:(0,t.jsxs)("div",{className:"metrics-container",children:[m&&(0,t.jsx)(Qt.Spinner,{}),!m&&b>0&&(0,t.jsxs)("div",{className:"metric-views",children:[b.toLocaleString(),x>0&&(0,t.jsxs)("span",{className:"metric-change metric-change-positive",children:["+",x.toLocaleString()]})]}),!m&&_>0&&(0,t.jsx)("div",{className:"metric-boost-percentage",children:/* translators: %f is the boost percentage */ /* translators: %f is the boost percentage */
(0,Mt.sprintf)((0,Mt.__)("%f%% BOOSTED","wp-parsely"),_.toFixed(1))})]})}),h&&(0,t.jsxs)("td",{className:"actions",children:[(0,t.jsx)("div",{className:"boost-link-container",children:(0,t.jsx)(Ct,{to:{pathname:"/traffic-boost/".concat(i.id)},state:{post:i},children:(0,Mt.__)("Boost Traffic","wp-parsely")})}),(0,t.jsx)(Le,{post:i})]})]})]},i.id)},Te=function(){return Te=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Te.apply(this,arguments)},Ne=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},Ce=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ie=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},Re=function(e){var n=e.isLoading,r=e.currentPage,o=e.setCurrentPage,i=e.totalPages,a=e.onPrevious,s=e.onNext;return(0,t.jsxs)("div",{className:"posts-table-pagination-controls",children:[n&&(0,t.jsx)(Qt.Spinner,{}),(0,t.jsxs)("div",{className:"page-selector",children:[(0,t.jsx)("span",{children:(0,Mt.__)("Page","wp-parsely")}),(0,t.jsx)(Qt.__experimentalNumberControl,{disabled:n,value:r,onChange:function(t){var e=parseInt(null!=t?t:"1",10);e>i?e=i:e<1&&(e=1),o(e)},min:1,max:i,dragDirection:"e"}),(0,t.jsxs)("span",{children:[(0,Mt.__)("of","wp-parsely")," ",i]})]}),(0,t.jsxs)("div",{className:"page-navigation",children:[(0,t.jsx)(Qt.Button,{icon:ee,onClick:a,disabled:1===r||n}),(0,t.jsx)(Qt.Button,{icon:ne,onClick:s,disabled:r>=i||n})]})]})},Ae=function(e){var n,r=e.query,o=void 0===r?{}:r,i=e.currentPage,a=e.setCurrentPage,s=e.hideHeader,l=void 0!==s&&s,c=e.hidePagination,u=void 0!==c&&c,d=e.hideLoading,p=void 0!==d&&d,f=e.hideStats,h=void 0!==f&&f,g=e.hideActions,v=void 0!==g&&g,m=e.compact,y=void 0!==m&&m,w=e.noResultsMessage,b=void 0===w?(0,Mt.__)("No posts found.","wp-parsely"):w,x=e.className,k=e.onPostClick,_=(0,Bt.useState)([]),S=_[0],E=_[1],P=(0,Bt.useState)([]),L=P[0],j=P[1],T=(0,Bt.useState)(1),N=T[0],C=T[1],I=(0,Bt.useState)(null!==(n=o.per_page)&&void 0!==n?n:10)[0],R=(0,Bt.useState)(!0),A=R[0],O=R[1],D=(0,Bt.useState)(!0),B=D[0],M=D[1],G=(0,Bt.useState)(),F=G[0],U=G[1],H=(0,Bt.useRef)(!1);(0,Bt.useEffect)((function(){O(!0),M(!0),Ne(void 0,void 0,void 0,(function(){var t,e,n;return Ce(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,5,6]),[4,ye.getInstance().getPosts(Te(Te({context:"embed"},o),{per_page:I,page:i}))];case 1:return t=r.sent(),h?[3,3]:[4,de.getInstance().getStatsForPosts(t.data,{limit:t.data.length,period_start:"30d",page:1,campaign_id:"wp-parsely",campaign_medium:"smart-link"})];case 2:e=r.sent(),j(e),r.label=3;case 3:return E(t.data),C(t.total_pages),H.current=!0,[3,6];case 4:return n=r.sent(),console.error(n),n instanceof oe&&U(n),n instanceof Error&&U(new oe(n.message,qt.UnknownError)),[3,6];case 5:return O(!1),M(!1),[7];case 6:return[2]}}))}))}),[i,I,o,h]);var V=(0,Bt.useCallback)((function(t){return Ne(void 0,void 0,void 0,(function(){var e,n;return Ce(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,de.getInstance().getStatsForPosts([t],{limit:1,period_start:"30d",page:1,campaign_id:"wp-parsely",campaign_medium:"smart-link",use_wp_permalink:!0})];case 1:return e=r.sent(),j((function(t){return Ie(Ie([],t,!0),[e[0]],!1)})),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}}))}))}),[]),$=(0,Bt.useCallback)((function(t){return L.find((function(e){return e.postId===t.id}))}),[L]),W=["parsely-table-container"];return x&&W.push(x),A&&p&&!H.current?(0,t.jsx)(t.Fragment,{}):A&&!p&&0===S.length?(W.push("is-loading"),(0,t.jsx)("div",{className:W.join(" "),children:(0,t.jsx)(Qt.Spinner,{})})):F&&F.code!==qt.ParselyApiReturnedNoData?(0,t.jsx)("div",{className:"parsely-table-container no-results",children:F.Message()}):0===S.length?(0,t.jsx)("div",{className:"parsely-table-container no-results",children:b}):(l&&W.push("hide-header"),u&&W.push("hide-pagination"),y&&W.push("compact"),(0,t.jsxs)("div",{className:W.join(" "),children:[(0,t.jsxs)("table",{className:W.join(" "),children:[!l&&(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"post-info-header",children:(0,Mt.__)("POST","wp-parsely")}),!y&&(0,t.jsxs)("th",{scope:"col",className:"views-header",children:[(0,Mt.__)("VIEWS","wp-parsely"),(0,t.jsx)("span",{className:"views-header-period",children:(0,Mt.__)("(30 days)","wp-parsely")})]})]})}),(0,t.jsx)("tbody",{children:S.map((function(e,n){return(0,t.jsx)(je,{post:e,stats:$(e),isLoadingStats:B,index:n,onPostClick:k,compact:y,showStats:!h,showActions:!v,onErrorLoadingStats:V},e.id)}))})]}),!u&&(0,t.jsx)(Re,{isLoading:A,currentPage:i,setCurrentPage:a,totalPages:N,onPrevious:function(){a((function(t){return Math.max(t-1,1)}))},onNext:function(){a((function(t){return t+1}))}})]}))},Oe=window.wp.compose,De=function(){var e=(0,Bt.useState)(""),n=e[0],r=e[1],o=(0,Oe.useDebounce)((function(t){r(t),s(1)}),300),i=(0,Bt.useState)(1),a=i[0],s=i[1];return(0,t.jsxs)(Jt,{name:"traffic-boost",children:[(0,t.jsx)(Xt,{children:(0,t.jsx)("h1",{children:(0,Mt.__)("Manage Traffic Boost (beta)","wp-parsely")})}),(0,t.jsxs)(Kt,{children:[(0,t.jsx)("div",{className:"traffic-boost-search-container",children:(0,t.jsx)(Qt.SearchControl,{value:n,onChange:o,label:(0,Mt.__)("Search","wp-parsely"),placeholder:(0,Mt.__)("Search","wp-parsely"),__nextHasNoMarginBottom:!0})}),(0,t.jsx)(Ae,{currentPage:a,setCurrentPage:s,query:{status:"publish",per_page:10,search:n,search_columns:["post_title","post_excerpt"]}})]})]})},Be=function(){return(0,t.jsxs)(Jt,{name:"settings",children:[(0,t.jsx)(Xt,{children:(0,t.jsx)("h1",{children:"Parse.ly Settings"})}),(0,t.jsx)(Kt,{children:(0,t.jsx)("p",{children:"This is a page for settings."})})]})},Me=(0,t.jsx)(te.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)(te.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12.218 5.377a.25.25 0 0 0-.436 0l-7.29 12.96a.25.25 0 0 0 .218.373h14.58a.25.25 0 0 0 .218-.372l-7.29-12.96Zm-1.743-.735c.669-1.19 2.381-1.19 3.05 0l7.29 12.96a1.75 1.75 0 0 1-1.525 2.608H4.71a1.75 1.75 0 0 1-1.525-2.608l7.29-12.96ZM12.75 17.46h-1.5v-1.5h1.5v1.5Zm-1.5-3h1.5v-5h-1.5v5Z"})}),Ge=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})}),Fe=window.wp.notices,Ue=function(){return Ue=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Ue.apply(this,arguments)},He=function(e){var n=e.className,r=(0,Gt.useSelect)((function(t){return t(Fe.store).getNotices().filter((function(t){return"snackbar"===t.type})).map((function(t){var e;return Ue(Ue({},t),{actions:null===(e=t.actions)||void 0===e?void 0:e.map((function(t){var e,n;return Ue(Ue({},t),{url:null!==(e=t.url)&&void 0!==e?e:void 0,onClick:null!==(n=t.onClick)&&void 0!==n?n:void 0})}))})}))}),[]),o=(0,Gt.useDispatch)(Fe.store).removeNotice,i=["wp-parsely-snackbar-notices"];return n&&i.push(n),(0,t.jsx)("div",{className:i.join(" "),children:(0,t.jsx)(Qt.SnackbarList,{notices:r,onRemove:function(t){return o(t)}})})},Ve=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})}),$e=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M17.031 4.703 15.576 4l-1.56 3H14v.03l-2.324 4.47H9.5V13h1.396l-1.502 2.889h-.95a3.694 3.694 0 0 1 0-7.389H10V7H8.444a5.194 5.194 0 1 0 0 10.389h.17L7.5 19.53l1.416.719L15.049 8.5h.507a3.694 3.694 0 0 1 0 7.39H14v1.5h1.556a5.194 5.194 0 0 0 .273-10.383l1.202-2.304Z"})}),We=function(){return We=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},We.apply(this,arguments)},ze=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};!function(t){t.SUGGESTIONS="suggestions",t.INBOUND_LINKS="inbound-links",t.SETTINGS="settings"}(Ee||(Ee={}));var qe={loading:[],error:null,currentPost:null,selectedTab:Ee.SUGGESTIONS,selectedLink:null,preview:{selectedLinkType:null,frontendPreview:!1},suggestionsTab:{suggestions:[],suggestionsToGenerate:0},inboundLinksTab:{links:[],currentPage:1,itemsPerPage:0},acceptingLinks:[],removingLinks:[],generatingLinks:[],isGeneratingSuggestions:!1,settings:{maxItems:10}},Ze=(0,Gt.createReduxStore)("wp-parsely/traffic-boost",{initialState:qe,reducer:function(t,e){var n,r,o,i,a,s,l,c;switch(void 0===t&&(t=qe),e.type){case"SET_LOADING":return e.loadingType||(e.loadingType="default"),We(We({},t),{loading:e.isLoading?ze(ze([],t.loading,!0),[e.loadingType],!1):t.loading.filter((function(t){return t!==e.loadingType}))});case"SET_ERROR":return We(We({},t),{error:e.error});case"SET_CURRENT_HYDRATED_POST":return We(We({},t),{currentPost:e.post});case"SET_SELECTED_TAB":return We(We({},t),{selectedTab:e.tab});case"SET_SUGGESTIONS":return We(We({},t),{suggestionsTab:We(We({},t.suggestionsTab),{suggestions:e.discardPrevious?e.suggestions:ze(ze([],t.suggestionsTab.suggestions,!0),e.suggestions,!0)})});case"SET_INBOUND_LINKS":return We(We({},t),{inboundLinksTab:We(We({},t.inboundLinksTab),{links:e.links})});case"SET_INBOUND_LINKS_PAGE":return We(We({},t),{inboundLinksTab:We(We({},t.inboundLinksTab),{currentPage:e.page})});case"SET_INBOUND_LINKS_ITEMS_PER_PAGE":return We(We({},t),{inboundLinksTab:We(We({},t.inboundLinksTab),{itemsPerPage:e.itemsPerPage})});case"SET_SELECTED_LINK":return We(We({},t),{selectedLink:e.link});case"SET_PREVIEW_LINK_TYPE":return We(We({},t),{preview:We(We({},t.preview),{selectedLinkType:e.linkType})});case"SET_FRONTEND_PREVIEW":return We(We({},t),{preview:We(We({},t.preview),{frontendPreview:e.enabled})});case"ADD_SUGGESTION":return We(We({},t),{suggestionsTab:We(We({},t.suggestionsTab),{suggestions:ze([e.suggestion],t.suggestionsTab.suggestions,!0)}),selectedLink:e.select?e.suggestion:t.selectedLink});case"REMOVE_SUGGESTION":var u=t.suggestionsTab.suggestions.filter((function(t){return t.uid!==e.suggestion.uid}));return We(We({},t),{suggestionsTab:We(We({},t.suggestionsTab),{suggestions:u}),selectedLink:e.updateSelectedLink&&(null===(n=t.selectedLink)||void 0===n?void 0:n.uid)===e.suggestion.uid?null!==(r=u[0])&&void 0!==r?r:null:t.selectedLink});case"ADD_INBOUND_LINK":return We(We({},t),{inboundLinksTab:We(We({},t.inboundLinksTab),{links:ze([e.link],t.inboundLinksTab.links,!0)}),selectedLink:e.select?e.link:t.selectedLink});case"REMOVE_INBOUND_LINK":var d=t.inboundLinksTab.links.filter((function(t){return t.uid!==e.link.uid}));return We(We({},t),{inboundLinksTab:We(We({},t.inboundLinksTab),{links:d}),selectedLink:e.updateSelectedLink&&(null===(o=t.selectedLink)||void 0===o?void 0:o.uid)===e.link.uid?null!==(i=d[0])&&void 0!==i?i:null:t.selectedLink});case"UPDATE_SUGGESTION":var p=null!==(a=e.uid)&&void 0!==a?a:e.suggestion.uid,f=t.suggestionsTab.suggestions.map((function(t){return t.uid===p?e.suggestion:t})),h=(null===(s=t.selectedLink)||void 0===s?void 0:s.uid)===p?e.suggestion:t.selectedLink;return We(We({},t),{suggestionsTab:We(We({},t.suggestionsTab),{suggestions:f}),selectedLink:h});case"UPDATE_INBOUND_LINK":var g=null!==(l=e.uid)&&void 0!==l?l:e.link.uid,v=t.inboundLinksTab.links.map((function(t){return t.uid===g?e.link:t}));return h=(null===(c=t.selectedLink)||void 0===c?void 0:c.uid)===g?e.link:t.selectedLink,We(We({},t),{inboundLinksTab:We(We({},t.inboundLinksTab),{links:v}),selectedLink:h});case"SET_IS_ACCEPTING":return We(We({},t),{acceptingLinks:e.value?ze(ze([],t.acceptingLinks,!0),[e.link.uid],!1):t.acceptingLinks.filter((function(t){return t!==e.link.uid}))});case"SET_IS_REMOVING":return We(We({},t),{removingLinks:e.value?ze(ze([],t.removingLinks,!0),[e.link.uid],!1):t.removingLinks.filter((function(t){return t!==e.link.uid}))});case"SET_IS_GENERATING_SUGGESTIONS":return We(We({},t),{isGeneratingSuggestions:e.value});case"SET_IS_GENERATING":return We(We({},t),{generatingLinks:e.value?ze(ze([],t.generatingLinks,!0),[e.link.uid],!1):t.generatingLinks.filter((function(t){return t!==e.link.uid}))});case"SET_SETTINGS":return We(We({},t),{settings:We(We({},t.settings),e.settings)});case"SET_SUGGESTIONS_TO_GENERATE":return We(We({},t),{suggestionsTab:We(We({},t.suggestionsTab),{suggestionsToGenerate:"function"==typeof e.count?e.count(t.suggestionsTab.suggestionsToGenerate):e.count})});default:return t}},actions:{setLoading:function(t,e){return void 0===e&&(e="default"),{type:"SET_LOADING",isLoading:t,loadingType:e}},setError:function(t){return{type:"SET_ERROR",error:t}},setCurrentPost:function(t){return{type:"SET_CURRENT_HYDRATED_POST",post:t}},setSelectedTab:function(t){return{type:"SET_SELECTED_TAB",tab:t}},setSuggestions:function(t,e){return void 0===e&&(e=!0),{type:"SET_SUGGESTIONS",suggestions:t,discardPrevious:e}},setInboundLinks:function(t){return{type:"SET_INBOUND_LINKS",links:t}},setInboundLinksPage:function(t){return{type:"SET_INBOUND_LINKS_PAGE",page:t}},setInboundLinksItemsPerPage:function(t){return{type:"SET_INBOUND_LINKS_ITEMS_PER_PAGE",itemsPerPage:t}},setSelectedLink:function(t){return{type:"SET_SELECTED_LINK",link:t}},setPreviewLinkType:function(t){return{type:"SET_PREVIEW_LINK_TYPE",linkType:t}},setFrontendPreview:function(t){return{type:"SET_FRONTEND_PREVIEW",enabled:t}},addSuggestion:function(t,e){return void 0===e&&(e=!0),{type:"ADD_SUGGESTION",suggestion:t,select:e}},removeSuggestion:function(t,e){return void 0===e&&(e=!0),{type:"REMOVE_SUGGESTION",suggestion:t,updateSelectedLink:e}},addInboundLink:function(t,e){return void 0===e&&(e=!0),{type:"ADD_INBOUND_LINK",link:t,select:e}},removeInboundLink:function(t,e){return void 0===e&&(e=!0),{type:"REMOVE_INBOUND_LINK",link:t,updateSelectedLink:e}},updateSuggestion:function(t,e){return{type:"UPDATE_SUGGESTION",suggestion:t,uid:e}},updateInboundLink:function(t,e){return{type:"UPDATE_INBOUND_LINK",link:t,uid:e}},setIsAccepting:function(t,e){return{type:"SET_IS_ACCEPTING",link:t,value:e}},setIsRemoving:function(t,e){return{type:"SET_IS_REMOVING",link:t,value:e}},setIsGeneratingSuggestions:function(t){return{type:"SET_IS_GENERATING_SUGGESTIONS",value:t}},setIsGenerating:function(t,e){return{type:"SET_IS_GENERATING",link:t,value:e}},setSettings:function(t){return{type:"SET_SETTINGS",settings:t}},setSuggestionsToGenerate:function(t){return{type:"SET_SUGGESTIONS_TO_GENERATE",count:t}}},selectors:{isLoading:function(t){return t.loading.length>0},isLoadingSuggestions:function(t){return t.loading.includes("suggestions")},isLoadingInboundLinks:function(t){return t.loading.includes("inbound-links")},isLoadingPost:function(t){return t.loading.includes("post")},getError:function(t){return t.error},getCurrentPost:function(t){return t.currentPost},getSelectedTab:function(t){return t.selectedTab},getSuggestions:function(t){return t.suggestionsTab.suggestions},getInboundLinks:function(t){return t.inboundLinksTab.links},getInboundLinksPage:function(t){return t.inboundLinksTab.currentPage},getInboundLinksItemsPerPage:function(t){return t.inboundLinksTab.itemsPerPage},isSuggestionsLoading:function(t){return t.loading.includes("suggestions")},getSelectedLink:function(t){return t.selectedLink},getPreviewLinkType:function(t){return t.preview.selectedLinkType},isFrontendPreview:function(t){return t.preview.frontendPreview},isAccepting:function(t,e){return t.acceptingLinks.includes(e.uid)},isRemoving:function(t,e){return t.removingLinks.includes(e.uid)},isGeneratingSuggestions:function(t){return t.isGeneratingSuggestions},isGenerating:function(t,e){return t.generatingLinks.includes(e.uid)},getSettings:function(t){return t.settings},getSuggestionsToGenerate:function(t){return t.suggestionsTab.suggestionsToGenerate},hasSuggestions:function(t){return t.suggestionsTab.suggestions.length>0}}});(0,Gt.register)(Ze);var Ke=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),Ye=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"m14.5 6.5-1 1 3.7 3.7H4v1.6h13.2l-3.7 3.7 1 1 5.6-5.5z"})}),Je=function(e){var n=e.activeLink,r=e.onNext,o=e.onPrevious,i=e.totalItems,a=e.itemIndex,s=a<i,l=a>1;return n?(0,t.jsxs)("div",{className:"traffic-boost-preview-footer",children:[(0,t.jsx)("div",{className:"traffic-boost-preview-footer-previous",children:l&&(0,t.jsx)(Qt.Button,{variant:"tertiary",onClick:o,icon:Ke,showTooltip:!0,label:(0,Mt.__)("Previous Suggested Source","wp-parsely")})}),(0,t.jsx)("div",{className:"traffic-boost-preview-footer-next",children:s&&(0,t.jsx)(Qt.Button,{variant:"tertiary",onClick:r,icon:Ye,showTooltip:!0,label:(0,Mt.__)("Next Suggested Source","wp-parsely")})})]}):(0,t.jsx)(t.Fragment,{})},Xe=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),Qe=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),tn=function(e){var n=e.size,r=void 0===n?24:n,o=e.className,i=void 0===o?"wp-parsely-icon":o;return(0,t.jsxs)(Qt.SVG,{className:i,height:r,viewBox:"0 0 60 65",width:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)(Qt.Path,{fill:"#5ba745",d:"M23.72,51.53c0-.18,0-.34-.06-.52a13.11,13.11,0,0,0-2.1-5.53A14.74,14.74,0,0,0,19.12,43c-.27-.21-.5-.11-.51.22l-.24,3.42c0,.33-.38.35-.49,0l-1.5-4.8a1.4,1.4,0,0,0-.77-.78,23.91,23.91,0,0,0-3.1-.84c-1.38-.24-3.39-.39-3.39-.39-.34,0-.45.21-.25.49l2.06,3.76c.2.27,0,.54-.29.33l-4.51-3.6a3.68,3.68,0,0,0-2.86-.48c-1,.16-2.44.46-2.44.46a.68.68,0,0,0-.39.25.73.73,0,0,0-.14.45S.41,43,.54,44a3.63,3.63,0,0,0,1.25,2.62L6.48,50c.28.2.09.49-.23.37l-4.18-.94c-.32-.12-.5,0-.4.37,0,0,.69,1.89,1.31,3.16a24,24,0,0,0,1.66,2.74,1.34,1.34,0,0,0,1,.52l5,.13c.33,0,.41.38.1.48L7.51,58c-.31.1-.34.35-.07.55a14.29,14.29,0,0,0,3.05,1.66,13.09,13.09,0,0,0,5.9.5,25.13,25.13,0,0,0,4.34-1,9.55,9.55,0,0,1-.08-1.2,9.32,9.32,0,0,1,3.07-6.91"}),(0,t.jsx)(Qt.Path,{fill:"#5ba745",d:"M59.7,41.53a.73.73,0,0,0-.14-.45.68.68,0,0,0-.39-.25s-1.43-.3-2.44-.46a3.64,3.64,0,0,0-2.86.48l-4.51,3.6c-.26.21-.49-.06-.29-.33l2.06-3.76c.2-.28.09-.49-.25-.49,0,0-2,.15-3.39.39a23.91,23.91,0,0,0-3.1.84,1.4,1.4,0,0,0-.77.78l-1.5,4.8c-.11.32-.48.3-.49,0l-.24-3.42c0-.33-.24-.43-.51-.22a14.74,14.74,0,0,0-2.44,2.47A13.11,13.11,0,0,0,36.34,51c0,.18,0,.34-.06.52a9.26,9.26,0,0,1,3,8.1,24.1,24.1,0,0,0,4.34,1,13.09,13.09,0,0,0,5.9-.5,14.29,14.29,0,0,0,3.05-1.66c.27-.2.24-.45-.07-.55l-3.22-1.17c-.31-.1-.23-.47.1-.48l5-.13a1.38,1.38,0,0,0,1-.52A24.6,24.6,0,0,0,57,52.92c.61-1.27,1.31-3.16,1.31-3.16.1-.33-.08-.49-.4-.37l-4.18.94c-.32.12-.51-.17-.23-.37l4.69-3.34A3.63,3.63,0,0,0,59.46,44c.13-1,.24-2.47.24-2.47"}),(0,t.jsx)(Qt.Path,{fill:"#5ba745",d:"M46.5,25.61c0-.53-.35-.72-.8-.43l-4.86,2.66c-.45.28-.56-.27-.23-.69l4.66-6.23a2,2,0,0,0,.28-1.68,36.51,36.51,0,0,0-2.19-4.89,34,34,0,0,0-2.81-3.94c-.33-.41-.74-.35-.91.16l-2.28,5.68c-.16.5-.6.48-.59-.05l.28-8.93a2.54,2.54,0,0,0-.66-1.64S35,4.27,33.88,3.27,30.78.69,30.78.69a1.29,1.29,0,0,0-1.54,0s-1.88,1.49-3.12,2.59-2.48,2.35-2.48,2.35A2.5,2.5,0,0,0,23,7.27l.27,8.93c0,.53-.41.55-.58.05l-2.29-5.69c-.17-.5-.57-.56-.91-.14a35.77,35.77,0,0,0-3,4.2,35.55,35.55,0,0,0-2,4.62,2,2,0,0,0,.27,1.67l4.67,6.24c.33.42.23,1-.22.69l-4.87-2.66c-.45-.29-.82-.1-.82.43a18.6,18.6,0,0,0,.83,5.07,20.16,20.16,0,0,0,5.37,7.77c3.19,3,5.93,7.8,7.45,11.08A9.6,9.6,0,0,1,30,49.09a9.31,9.31,0,0,1,2.86.45c1.52-3.28,4.26-8.11,7.44-11.09a20.46,20.46,0,0,0,5.09-7,19,19,0,0,0,1.11-5.82"}),(0,t.jsx)(Qt.Path,{fill:"#5ba745",d:"M36.12,58.44A6.12,6.12,0,1,1,30,52.32a6.11,6.11,0,0,1,6.12,6.12"})]})},en=function(t){try{var e=new URL(t.targetPost.link),n=new URL(window.location.href);return e.hostname!==n.hostname}catch(t){return!0}},nn=function(t){var e=t.querySelector(".".concat("wp-parsely-preview-marker"));return e&&e.parentElement||null},rn=function(e){var n=e.post,r=e.onLinkTypeClick,o=e.selectedLinkType,i=(0,Bt.useState)(o),a=i[0],s=i[1],l=(0,Bt.useState)({external:0,internal:0,smart:0}),c=l[0],u=l[1],d=(0,Gt.useDispatch)(Ze).setPreviewLinkType;(0,Bt.useEffect)((function(){var t=n.content.raw,e=new URL(n.link).hostname,r=(new DOMParser).parseFromString(t,"text/html").querySelectorAll("a"),o=Array.from(r).filter((function(t){var e;return""!==(null===(e=t.textContent)||void 0===e?void 0:e.trim())})),i=o.filter((function(t){return t.hasAttribute("data-smartlink")})),a=o.filter((function(t){return t.href.includes(e)})),s=o.filter((function(t){return!t.href.includes(e)}));u({external:s.length,internal:a.length,smart:i.length})}),[n]),(0,Bt.useEffect)((function(){s(o),d(o)}),[o,d]);var p=function(t){var e=t;a===t&&(e=null),s(e),d(e),null==r||r(e)},f=function(t){return a===t},h=c.external+c.internal+c.smart;return(0,t.jsxs)("div",{className:"traffic-boost-preview-info-links",children:[(0,t.jsx)("div",{className:"traffic-boost-preview-info-links-summary",children:h>0?(0,t.jsx)(t.Fragment,{children:(0,Mt.sprintf)(/* translators: %d: number of outbound links */ /* translators: %d: number of outbound links */
(0,Mt.__)("Contains %d outbound links:","wp-parsely"),h)}):(0,t.jsx)(t.Fragment,{children:(0,Mt.__)("This post has no outbound links.","wp-parsely")})}),(0,t.jsxs)("div",{className:"traffic-boost-preview-info-links-counter",children:[c.external>0&&(0,t.jsx)(Qt.Button,{variant:"secondary",isPressed:f("external"),onClick:function(){return p("external")},children:(0,Mt.sprintf)(/* translators: %d: number of outbound links */ /* translators: %d: number of outbound links */
(0,Mt.__)("%d external","wp-parsely"),c.external)}),c.internal>0&&(0,t.jsx)(Qt.Button,{variant:"secondary",isPressed:f("internal"),onClick:function(){return p("internal")},children:(0,Mt.sprintf)(/* translators: %d: number of internal links */ /* translators: %d: number of internal links */
(0,Mt.__)("%d internal","wp-parsely"),c.internal)}),c.smart>0&&(0,t.jsx)(Qt.Button,{variant:"secondary",isPressed:f("smart"),onClick:function(){return p("smart")},children:(0,Mt.sprintf)(/* translators: %d: number of smart links */ /* translators: %d: number of smart links */
(0,Mt.__)("%d Smart Links","wp-parsely"),c.smart)})]})]})},on=function(e){var n=e.post,r=e.onEditClick,o=e.onViewInNewTabClick,i=e.onViewInParseLyClick,a=function(t,e){switch(t){case"edit":r(n);break;case"view-in-new-tab":o(n);break;case"view-in-parse-ly":i(n)}e()};return(0,t.jsx)(Qt.DropdownMenu,{icon:we,iconSize:24,label:(0,Mt.__)("Actions","wp-parsely"),children:function(e){var n=e.onClose;return(0,t.jsxs)(Qt.MenuGroup,{children:[(0,t.jsx)(Qt.MenuItem,{icon:Xe,onClick:function(){return a("edit",n)},children:(0,Mt.__)("Edit Post","wp-parsely")}),(0,t.jsx)(Qt.MenuItem,{icon:Qe,onClick:function(){return a("view-in-new-tab",n)},children:(0,Mt.__)("View post in a new tab","wp-parsely")}),(0,t.jsx)(Qt.MenuItem,{icon:(0,t.jsx)(tn,{}),onClick:function(){return a("view-in-parse-ly",n)},children:(0,Mt.__)("View in Parse.ly","wp-parsely")})]})}})},an=function(e){e.isLoading;var n,r=e.activeLink,o=(e.isFrontendPreview,e.setIsFrontendPreview),i=e.onOpenPostEditor,a=e.onOpenPostInNewTab,s=e.onOpenParselyDashboard;return(0,Bt.useEffect)((function(){r&&en(r)&&o(!1)}),[r,o]),r?(0,t.jsxs)("div",{className:"traffic-boost-preview-header",children:[(0,t.jsxs)("div",{className:"traffic-boost-preview-info",children:[(0,t.jsx)("div",{className:"traffic-boost-preview-info-title",children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:null===(n=null==r?void 0:r.targetPost)||void 0===n?void 0:n.title.rendered}})}),(0,t.jsx)(rn,{post:r.targetPost,selectedLinkType:null})]}),(0,t.jsxs)("div",{className:"traffic-boost-preview-header-actions",children:[!en(r)&&!1,(0,t.jsx)(on,{post:r.targetPost,onEditClick:i,onViewInNewTabClick:a,onViewInParseLyClick:s})]})]}):(0,t.jsx)(t.Fragment,{})},sn=function(e){var n=e.message,r=(0,Bt.useState)(""),o=r[0],i=r[1],a=(0,Bt.useState)(0),s=a[0],l=a[1],c=(0,Bt.useState)(!0),u=c[0],d=c[1];return(0,Bt.useEffect)((function(){i(""),l(0),d(!0)}),[n]),(0,Bt.useEffect)((function(){if(u&&s<n.length){var t=setTimeout((function(){i((function(t){return t+n.charAt(s)})),l((function(t){return t+1}))}),50);return function(){return clearTimeout(t)}}}),[s,u,n]),(0,t.jsx)("div",{className:"wp-parsely-typewriter-text",children:o})},ln=function(e){var n=e.className,r=void 0===n?"":n,o=e.loading,i=void 0===o||o,a=e.showSpinner,s=void 0===a||a,l=e.randomOrder,c=void 0!==l&&l,u=e.messages,d=void 0===u?[(0,Mt.__)("Loadingâ€¦","wp-parsely")]:u,p=e.children,f=e.typewriter,h=void 0!==f&&f,g=(0,Bt.useState)(""),v=g[0],m=g[1],y=(0,Bt.useState)(0),w=y[0],b=y[1];return(0,Bt.useEffect)((function(){if(i){""===v&&m(d[c?Math.floor(Math.random()*d.length):0]);var t=100*v.length,e=setInterval((function(){if(c){var t=void 0;do{t=Math.floor(Math.random()*d.length)}while(d.length>1&&t===w);b(t),m(d[t])}else t=(w+1)%d.length,b(t),m(d[t])}),t);return function(){return clearInterval(e)}}}),[i,d,w,v,c]),(0,t.jsxs)("div",{className:"wp-parsely-loading ".concat(r),children:[s&&(0,t.jsx)(Qt.Spinner,{}),(0,t.jsx)("div",{className:"wp-parsely-loading-message",children:p||(0,t.jsx)(t.Fragment,{children:h?(0,t.jsx)(sn,{message:v}):v})})]})},cn=function(){return(0,t.jsx)(te.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48","aria-hidden":"true",focusable:"false",children:(0,t.jsx)(te.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12.218 5.377a.25.25 0 0 0-.436 0l-7.29 12.96a.25.25 0 0 0 .218.373h14.58a.25.25 0 0 0 .218-.372l-7.29-12.96Zm-1.743-.735c.669-1.19 2.381-1.19 3.05 0l7.29 12.96a1.75 1.75 0 0 1-1.525 2.608H4.71a1.75 1.75 0 0 1-1.525-2.608l7.29-12.96ZM12.75 17.46h-1.5v-1.5h1.5v1.5Zm-1.5-3h1.5v-5h-1.5v5Z"})})},un=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),dn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},pn=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},fn=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},hn=[(0,Mt.__)("Analyzing your contentâ€¦","wp-parsely"),(0,Mt.__)("Searching for posts with related topicsâ€¦","wp-parsely"),(0,Mt.__)("Detecting and removing low relevancy suggestionsâ€¦","wp-parsely"),(0,Mt.__)("Performing additional filteringâ€¦","wp-parsely"),(0,Mt.__)("Checking if extra processing is neededâ€¦","wp-parsely")],gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return un(e,t),e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getExistingSuggestions=function(t){return dn(this,void 0,void 0,(function(){var e,n;return pn(this,(function(r){switch(r.label){case 0:return[4,this.fetch({method:"GET",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/get-suggestions")})];case 1:return e=r.sent(),n=e.data.map((function(t){var e;return null===(e=t.source)||void 0===e?void 0:e.post_id})),0===n.length?[2,[]]:[2,this.createTrafficBoostLinks(e.data)]}}))}))},e.prototype.generateBatchSuggestions=function(t,e,n){return dn(this,void 0,void 0,(function(){var r,o,i,a,s,l,c,u,d,p,f,h,g,v,m;return pn(this,(function(y){switch(y.label){case 0:r=null!==(f=null==n?void 0:n.maxItemsPerBatch)&&void 0!==f?f:Math.min(e,5),o=null!==(h=null==n?void 0:n.maxRetries)&&void 0!==h?h:3,i=0,a=[],s=null!==(g=null==n?void 0:n.urlExclusionList)&&void 0!==g?g:[],y.label=1;case 1:if(!(i<e))return[3,6];if(l=0===i&&(null==n?void 0:n.discardPrevious),0===o)return[3,6];y.label=2;case 2:return y.trys.push([2,4,,5]),[4,this.generateSuggestions(t,{discardPrevious:l,urlExclusionList:s,maxItems:Math.min(e-i,r),save:null!==(v=null==n?void 0:n.save)&&void 0!==v&&v})];case 3:return 0===(c=y.sent()).length?(o--,[3,1]):(u=c.filter((function(t){var e,n,r;return!s.includes(null!==(r=null===(n=null===(e=t.smartLink)||void 0===e?void 0:e.post_data)||void 0===n?void 0:n.parsely_canonical_url)&&void 0!==r?r:"")})),s=fn(fn([],s,!0),u.map((function(t){var e,n,r;return null!==(r=null===(n=null===(e=t.smartLink)||void 0===e?void 0:e.post_data)||void 0===n?void 0:n.parsely_canonical_url)&&void 0!==r?r:""})),!0),d=0===i,null===(m=null==n?void 0:n.onNewSuggestions)||void 0===m||m.call(n,u,d),a=fn(fn([],a,!0),u,!0),i+=u.length,[3,5]);case 4:if((p=y.sent())instanceof DOMException&&"AbortError"===p.name||p instanceof oe&&p.code===qt.ParselyAborted||p instanceof oe&&!p.retryFetch)throw p;return console.error(p),o--,[3,5];case 5:return[3,1];case 6:return[2,a]}}))}))},e.prototype.generateSuggestions=function(t,e){return dn(this,void 0,void 0,(function(){var n,r,o,i,a,s;return pn(this,(function(l){switch(l.label){case 0:return[4,this.fetch({method:"POST",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/generate"),data:{max_items:null!==(o=null==e?void 0:e.maxItems)&&void 0!==o?o:10,save:null!==(i=null==e?void 0:e.save)&&void 0!==i&&i,discard_previous:null===(a=null==e?void 0:e.discardPrevious)||void 0===a||a,url_exclusion_list:null==e?void 0:e.urlExclusionList,performance_blending_weight:null!==(s=null==e?void 0:e.performanceBlendingWeight)&&void 0!==s?s:.5}})];case 1:return n=l.sent(),r=n.data.filter((function(t){var e;return null===(e=t.validation)||void 0===e?void 0:e.valid})),[2,this.createTrafficBoostLinks(r)]}}))}))},e.prototype.generateSuggestionForPost=function(t,e,n,r){return dn(this,void 0,void 0,(function(){var o,i,a,s,l;return pn(this,(function(c){switch(c.label){case 0:return o="/wp-parsely/v2/content-helper/traffic-boost/".concat(t.id,"/generate-placement/").concat(e.id),[4,this.fetch({method:"POST",path:o,data:{keyword_exclusion_list:null==r?void 0:r.ignoreKeywords,performance_blending_weight:null!==(a=null==r?void 0:r.performanceBlendingWeight)&&void 0!==a?a:.5,save:null===(s=null==r?void 0:r.save)||void 0===s||s,allow_duplicate_links:null!==(l=null==r?void 0:r.allowDuplicateLinks)&&void 0!==l&&l}})];case 1:if(!(i=c.sent()).data)throw new oe((0,Mt.__)("Couldn't find a good link placement.","wp-parsely"),qt.UnknownError,"");return n.smartLink=i.data,[2,n]}}))}))},e.prototype.removeInboundLink=function(t,e,n){return dn(this,void 0,void 0,(function(){var r;return pn(this,(function(o){switch(o.label){case 0:return r="/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/delete-inbound/").concat(e),[4,this.fetch({method:"DELETE",path:r,data:{restore_original:n}})];case 1:return[2,o.sent().data.success]}}))}))},e.prototype.updateInboundLink=function(t,e,n){return dn(this,void 0,void 0,(function(){var r;return pn(this,(function(o){switch(o.label){case 0:return r="/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/update-inbound/").concat(e),[4,this.fetch({method:"POST",path:r,data:n})];case 1:return[2,o.sent()]}}))}))},e.prototype.getInboundSmartLinks=function(t){return dn(this,void 0,void 0,(function(){var e;return pn(this,(function(n){switch(n.label){case 0:return e="/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/get-inbound"),[4,this.fetch({path:e})];case 1:return[2,n.sent().data]}}))}))},e.prototype.getInboundLinks=function(t){return dn(this,void 0,void 0,(function(){var e;return pn(this,(function(n){switch(n.label){case 0:return[4,this.getInboundSmartLinks(t)];case 1:return 0===(e=n.sent()).length?[2,[]]:[2,this.createTrafficBoostLinks(e)]}}))}))},e.prototype.acceptSuggestion=function(t,e,n){return dn(this,void 0,void 0,(function(){var r,o,i,a;return pn(this,(function(s){switch(s.label){case 0:return[4,this.fetch({method:"POST",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/accept-suggestion/").concat(e),data:{text:null==n?void 0:n.text,offset:null==n?void 0:n.offset}})];case 1:if((r=s.sent()).data.success)return[2,{success:!0,didReplaceLink:null!==(o=r.data.did_replace_link)&&void 0!==o&&o,postContent:r.data.post_content}];throw new oe(null!==(i=r.message)&&void 0!==i?i:(0,Mt.__)("Unknown error.","wp-parsely"),null!==(a=r.error)&&void 0!==a?a:qt.UnknownError,"")}}))}))},e.prototype.discardSuggestions=function(t){return dn(this,void 0,void 0,(function(){return pn(this,(function(e){switch(e.label){case 0:return[4,this.fetch({method:"DELETE",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/discard-suggestions")})];case 1:return[2,e.sent().data]}}))}))},e.prototype.discardSuggestion=function(t,e){return dn(this,void 0,void 0,(function(){return pn(this,(function(n){switch(n.label){case 0:return[4,this.fetch({method:"DELETE",path:"/wp-parsely/v2/content-helper/traffic-boost/".concat(t,"/discard-suggestion/").concat(e)})];case 1:return[2,n.sent().data]}}))}))},e.prototype.createSuggestion=function(t){return{uid:"suggestion-".concat(t.id,"-").concat(Date.now()),targetPost:t,isSuggestion:!0}},e.prototype.createTrafficBoostLinks=function(t){return dn(this,void 0,void 0,(function(){var e,n,r,o,i=this;return pn(this,(function(a){switch(a.label){case 0:return e=t.reduce((function(t,e){var n,r=null===(n=e.post_data)||void 0===n?void 0:n.type.rest;return r?(t[r]||(t[r]=[]),t[r].push(e),t):t}),{}),n=Object.entries(e).map((function(t){return dn(i,[t],void 0,(function(t){var e,n=t[0],r=t[1];return pn(this,(function(t){switch(t.label){case 0:return e=r.map((function(t){var e;return null===(e=t.source)||void 0===e?void 0:e.post_id})),[4,this.getPosts({include:e,posts_per_page:100,status:"any",context:"edit",rest_endpoint:n})];case 1:return[2,t.sent().data]}}))}))})),[4,Promise.all(n)];case 1:return r=a.sent(),o=t.map((function(t){var e=r.flat().find((function(e){var n;return e.id===(null===(n=t.source)||void 0===n?void 0:n.post_id)}));return!!e&&i.createTrafficBoostLink(t,e)})).filter((function(t){return!1!==t})),[2,o]}}))}))},e.prototype.createTrafficBoostLink=function(t,e){return{uid:t.uid+"-"+Date.now(),targetPost:e,smartLink:t,isSuggestion:!t.applied}},e}(ve),vn=function(){return{injectWordpressComponentStyles:(0,Bt.useCallback)((function(t){var e,n=null===(e=null===window||void 0===window?void 0:window.wpParselyDependencies)||void 0===e?void 0:e.urlWpComponents;if(n){var r=t.querySelector("link[data-wp-parsely-component-styles]");null===r&&((r=t.createElement("link")).rel="stylesheet",r.href=n,r.setAttribute("data-wp-parsely-component-styles","true"),t.head.appendChild(r))}else console.error("WordPress component styles URL not found")}),[])}},mn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),yn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})}),wn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"})}),bn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M18.3 11.7c-.6-.6-1.4-.9-2.3-.9H6.7l2.9-3.3-1.1-1-4.5 5L8.5 16l1-1-2.7-2.7H16c.5 0 .9.2 1.3.5 1 1 1 3.4 1 4.5v.3h1.5v-.2c0-1.5 0-4.3-1.5-5.7z"})}),xn=function(e){var n=e.size,r=void 0===n?40:n,o=e.color,i=void 0===o?"#cccccc":o;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(Qt.SVG,{xmlns:"http://www.w3.org/2000/svg",width:"3",height:r,viewBox:"0 0 1 ".concat(r),fill:"none",children:(0,t.jsx)(Qt.Rect,{width:"1",height:r,fill:i})})})},kn=function(e){var n,r,o=e.activeLink,i=e.onAccept,a=e.onUpdateLink,s=e.onDiscard,l=e.onRemove,c=e.onRestoreOriginal,u=e.selectedText,d=e.iframeRef,p=!(null==o?void 0:o.isSuggestion),f=(0,Bt.useState)(!0),h=f[0],g=f[1],v=(0,Gt.useSelect)((function(t){return{isAccepting:!!o&&t(Ze).isAccepting(o),isRemoving:!!o&&t(Ze).isRemoving(o),isGenerating:!!o&&t(Ze).isGenerating(o)}}),[o]),m=v.isAccepting,y=v.isRemoving,w=v.isGenerating,b=(0,Bt.useCallback)((function(t){var e=t.totalDelta,n=t.originalItemRect,r=t.iframeRect,o={x:e.x,y:e.y};return n.x+e.x<8?o.x=8-n.x:n.x+e.x+n.width+8>r.width&&(o.x=r.width-n.width-n.x-8),n.y+e.y<8?o.y=8-n.y:n.y+e.y+n.height+8>r.height&&(o.y=r.height-n.height-n.y-8),o}),[]),x=function(t){var e=t.onDrag,n=t.iframeRef,r=t.dragHandleSelector,o=(0,Bt.useState)(!1),i=o[0],a=o[1],s=(0,Bt.useRef)({x:0,y:0}),l=(0,Bt.useRef)({x:0,y:0}),c=(0,Bt.useRef)(null),u=(0,Bt.useRef)(null),d=(0,Bt.useRef)(null),p=(0,Bt.useRef)(null),f=(0,Bt.useRef)({x:0,y:0}),h=(0,Bt.useRef)(null),g=(0,Bt.useCallback)((function(t){if(d.current=t,h.current&&h.current(),t){var e=function(t){var e,o,i,l,h,g,v;if(t.target.closest(r)){t.preventDefault();var m=null!==(o=null===(e=n.current)||void 0===e?void 0:e.contentDocument)&&void 0!==o?o:null===(l=null===(i=n.current)||void 0===i?void 0:i.contentWindow)||void 0===l?void 0:l.document;m&&(c.current=m.documentElement.getBoundingClientRect()),u.current=null!==(g=null===(h=d.current)||void 0===h?void 0:h.getBoundingClientRect())&&void 0!==g?g:null,p.current={x:t.clientX,y:t.clientY},f.current={x:s.current.x,y:s.current.y};var y=null===(v=d.current)||void 0===v?void 0:v.style.transform;if(y&&u.current){var w=new DOMMatrix(y);u.current={x:u.current.x-w.e,y:u.current.y-w.f,width:u.current.width,height:u.current.height}}a(!0)}};t.addEventListener("mousedown",e),h.current=function(){t.removeEventListener("mousedown",e)}}}),[n,r]);return(0,Bt.useEffect)((function(){var t,r,o,h,g,v,m,y,w;if(i){var b=null!==(r=null===(t=n.current)||void 0===t?void 0:t.contentDocument)&&void 0!==r?r:null===(h=null===(o=n.current)||void 0===o?void 0:o.contentWindow)||void 0===h?void 0:h.document;if(b){var x=(g=function(t){if(d.current&&c.current&&u.current&&p.current){var n=t.clientX-p.current.x,r=t.clientY-p.current.y;s.current={x:f.current.x+n,y:f.current.y+r},l.current=e({totalDelta:{x:s.current.x,y:s.current.y},originalItemRect:u.current,iframeRect:c.current}),d.current.style.transform="translate(".concat(l.current.x,"px, ").concat(l.current.y,"px)")}},v=null,m=null,y=function(){null!==m&&g.apply(void 0,m),v=null},w=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];m=t,v||(v=requestAnimationFrame(y))},w.cancel=function(){return v&&cancelAnimationFrame(v)},w),k=function(){s.current=l.current,a(!1)};return b.addEventListener("mousemove",x),b.addEventListener("mouseup",k),function(){x.cancel(),b.removeEventListener("mousemove",x),b.removeEventListener("mouseup",k)}}}}),[i,e,n]),[g,i]}({onDrag:b,dragHandleSelector:".traffic-boost-preview-actions-drag-handle",iframeRef:d}),k=x[0],_=x[1];return o?(0,t.jsx)("div",{className:"traffic-boost-preview-actions",ref:k,children:!w&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"traffic-boost-preview-actions-drag-handle ".concat(_?"dragging":""),role:"button",tabIndex:0,"aria-label":(0,Mt.__)("Drag to reposition actions bar","wp-parsely"),children:(0,t.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M8 7H10V5H8V7ZM8 13H10V11H8V13ZM8 19H10V17H8V19ZM14 5V7H16V5H14ZM14 13H16V11H14V13ZM14 19H16V17H14V19Z",fill:"#1E1E1E"})})}),(0,t.jsxs)("div",{className:"traffic-boost-preview-actions-buttons",children:[!p&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Qt.Button,{variant:"primary",onClick:function(){return i(o)},isBusy:m,disabled:m,icon:m?null:mn,children:m?(0,Mt.__)("Acceptingâ€¦","wp-parsely"):(0,Mt.__)("Accept","wp-parsely")}),(0,t.jsx)(Qt.Button,{variant:"tertiary",onClick:function(){return s(o)},icon:yn,children:(0,Mt.__)("Reject","wp-parsely")}),(0,t.jsx)(xn,{size:48,color:"#1e1e1e"}),!u&&(0,t.jsxs)("div",{className:"traffic-boost-preview-actions-hint",children:[(0,t.jsx)(Qt.Icon,{icon:wn}),(0,t.jsx)("div",{className:"traffic-boost-preview-actions-hint-text",children:(0,Mt.__)("TIP: Customize by selecting different text.","wp-parsely")})]}),u&&(0,t.jsx)(Qt.Button,{variant:"tertiary",onClick:c,icon:bn,children:(0,Mt.__)("Revert","wp-parsely")})]}),p&&u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Qt.Button,{variant:"primary",onClick:function(){return a(o,h)},isBusy:m,disabled:m,icon:m?null:mn,children:m?(0,Mt.__)("Updatingâ€¦","wp-parsely"):(0,Mt.__)("Update Link","wp-parsely")}),(null===(n=o.smartLink)||void 0===n?void 0:n.is_link_replacement)&&(0,t.jsx)(Qt.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,Mt.__)("Restore original link?","wp-parsely"),checked:h,onChange:function(t){g(t)}}),(0,t.jsx)(xn,{size:48,color:"#1e1e1e"}),(0,t.jsx)(Qt.Button,{variant:"tertiary",onClick:c,icon:bn,children:(0,Mt.__)("Revert","wp-parsely")})]}),p&&!u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Qt.Button,{variant:y?"primary":"tertiary",icon:y?null:yn,onClick:function(){return l(o,h)},isBusy:y,disabled:y,isDestructive:!0,children:y?(0,Mt.__)("Removingâ€¦","wp-parsely"):(0,Mt.__)("Remove Link","wp-parsely")}),(null===(r=o.smartLink)||void 0===r?void 0:r.is_link_replacement)&&(0,t.jsx)(Qt.CheckboxControl,{__nextHasNoMarginBottom:!0,label:(0,Mt.__)("Restore original link?","wp-parsely"),checked:h,onChange:function(t){g(t)}})]})]})]})}):(0,t.jsx)(t.Fragment,{})},Sn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM12.75 8V13H11.25V8H12.75ZM12.75 14.5V16H11.25V14.5H12.75Z"})}),En=function(e){var n=e.onSelect,r=e.iframeDocument,o=e.selection,i=e.onErrorClick;!function(t){var e=vn().injectWordpressComponentStyles;(0,Bt.useEffect)((function(){e(t);var n=window.getComputedStyle(document.documentElement).getPropertyValue("--wp-admin-theme-color").trim(),r=t.createElement("style");return r.textContent='\n\t\t\t/* Highlight styles */\n\t\t\t.parsely-traffic-boost-highlight {\n\t\t\t\tposition: absolute;\n\t\t\t\tpointer-events: none;\n\t\t\t\tz-index: 1010;\n\t\t\t\ttransition: all 0.15s ease-out;\n\t\t\t}\n\n\t\t\t/* Popover container styles */\n\t\t\t.parsely-traffic-boost-popover-container {\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 50%;\n\t\t\t\tbottom: 100%;\n\t\t\t\ttransform: translateX(-50%);\n\t\t\t\tmargin-bottom: 12px;\n\t\t\t\tz-index: 1001;\n\t\t\t\topacity: 0;\n\t\t\t\tanimation: slideUp 0.2s ease-out forwards;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-popover-container .components-button.is-primary:focus:not(:disabled) {\n\t\t\t\tbox-shadow:none;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-popover-container.closing {\n\t\t\t\tanimation: slideDown 0.2s ease-out forwards;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-iframe-popover {\n\t\t\t\t/* Reset font family to editor defaults to avoid inheriting frontend font in tooltip. */\n\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont,"Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell,"Helvetica Neue", sans-serif;\n\t\t\t\tpadding: 0;\n\t\t\t\tpointer-events: auto;\n\t\t\t\twhite-space: nowrap;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-iframe-popover-button {\n\t\t\t\tbox-shadow: 0px 2px 3px 0px rgba(0, 0, 0, 0.05),\n\t\t\t\t\t0px 4px 5px 0px rgba(0, 0, 0, 0.04),\n\t\t\t\t\t0px 4px 5px 0px rgba(0, 0, 0, 0.03),\n\t\t\t\t\t0px 16px 16px 0px rgba(0, 0, 0, 0.02);\n\t\t\t\tpadding: 6px 12px;\n\t\t\t\tbackground: var(--wp-admin-theme-color, '.concat(n,");\n\t\t\t\tborder-radius: 2px;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-iframe-popover-error {\n\t\t\t\tbackground: #000 !important;\n\t\t\t\tcolor: #fff !important;\n\t\t\t}\n\n\t\t\t/* Animation styles */\n\t\t\t@keyframes slideUp {\n\t\t\t\tfrom {\n\t\t\t\t\topacity: 0;\n\t\t\t\t\ttransform: translate(-50%, 10px);\n\t\t\t\t}\n\t\t\t\tto {\n\t\t\t\t\topacity: 1;\n\t\t\t\t\ttransform: translate(-50%, 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t@keyframes slideDown {\n\t\t\t\tfrom {\n\t\t\t\t\topacity: 1;\n\t\t\t\t\ttransform: translate(-50%, 0);\n\t\t\t\t}\n\t\t\t\tto {\n\t\t\t\t\topacity: 0;\n\t\t\t\t\ttransform: translate(-50%, 10px);\n\t\t\t\t}\n\t\t\t}\n\t\t"),t.head.appendChild(r),function(){r.remove()}}),[t,e])}(r);var a=(0,Bt.useState)(null),s=a[0],l=a[1],c=(0,Bt.useState)(!1),u=c[0],d=c[1],p=(0,Bt.useCallback)((function(t){var e=t.startContainer,n=t.endContainer;for(e===n&&e.firstChild&&(e=e.firstChild);null!==e;){if(e.nodeType===Node.ELEMENT_NODE&&"A"===e.tagName)return!0;e=Ln(e,!1,n)}return!1}),[]),f=(0,Bt.useCallback)((function(){var t,e,n=o.getRangeAt(0).commonAncestorContainer,r=n.nodeType===Node.ELEMENT_NODE?n.closest("a"):null===(t=n.parentElement)||void 0===t?void 0:t.closest("a");return!(!r||o.isCollapsed)&&o.toString().trim()===(null===(e=r.textContent)||void 0===e?void 0:e.trim())}),[o]);return(0,Bt.useEffect)((function(){if(f())d(!0);else{var t=o.getRangeAt(0);p(t)?l((0,Mt.__)("Select text without existing links.","wp-parsely")):l(null)}}),[p,f,o]),s?(0,t.jsx)("div",{className:"parsely-traffic-boost-iframe-popover",children:(0,t.jsx)(Qt.Button,{variant:"primary",className:"parsely-traffic-boost-iframe-popover-error",icon:Sn,onClick:i,children:s})}):(0,t.jsx)("div",{className:"parsely-traffic-boost-iframe-popover",children:(0,t.jsx)(Qt.Button,{variant:"primary",icon:Ve,className:"parsely-traffic-boost-iframe-popover-button",onClick:n,children:u?(0,Mt.__)("Replace Link","wp-parsely"):(0,Mt.__)("Use as Link Text","wp-parsely")})})},Pn=function(e){var n=e.iframeRef,r=e.onTextSelected,o=(0,Bt.useCallback)((function(){var e,o=null===(e=n.current)||void 0===e?void 0:e.contentDocument;if(o){var i=o.getSelection(),a=o.querySelector(".parsely-traffic-boost-highlight");if(a){if(!i||i.isCollapsed){var s=a.querySelector(".parsely-traffic-boost-popover-container");return void(s?(s.classList.add("closing"),setTimeout((function(){a.remove()}),200)):a.remove())}a.remove()}if(i&&!i.isCollapsed){var l=nn(o);if(l){if(i.rangeCount>1){var c=i.getRangeAt(0),u=i.getRangeAt(i.rangeCount-1),d=Nn(c.startContainer),p=Nn(u.endContainer);if(!d||!p||d!==p)return}var f=i.getRangeAt(0);if(l.contains(f.commonAncestorContainer)){var h=jn(f,o);Tn(f,h)&&(i.removeAllRanges(),i.addRange(h));var g=Nn(h.startContainer),v=Nn(h.endContainer);if(g&&v&&g===v){var m=o.createElement("div");m.className="parsely-traffic-boost-highlight";var y=o.createElement("div");y.className="parsely-traffic-boost-popover-container",m.appendChild(y);var w=(0,Bt.createRoot)(y);w.render((0,t.jsx)(En,{iframeDocument:o,selection:i,onErrorClick:function(){y.classList.add("closing"),i.removeAllRanges(),setTimeout((function(){k()}),200)},onSelect:function(){var t,e;y.classList.add("closing");for(var n=function(t,e,n){var r=e.toString().trim();if(!r)return 0;var o=e.getRangeAt(0),i=t.createRange();i.setStart(n,0),i.setEnd(o.startContainer,o.startOffset);var a=i.toString(),s=new RegExp(r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),l=a.match(s);return l?l.length:0}(o,i,l),a=o.createElement("div"),s=0;s<i.rangeCount;s++){var c=i.getRangeAt(s).cloneContents();a.appendChild(c)}var u=null!==(e=null===(t=a.textContent)||void 0===t?void 0:t.trim())&&void 0!==e?e:"";r(u,n),i.removeAllRanges(),setTimeout((function(){k()}),200)}}));var b=function(){var t,e,n=h.getBoundingClientRect(),r=null!==(e=null===(t=o.defaultView)||void 0===t?void 0:t.scrollY)&&void 0!==e?e:0;m.style.top="".concat(n.top+r,"px"),m.style.left="".concat(n.left,"px"),m.style.width="".concat(n.width,"px"),m.style.height="".concat(n.height,"px")};b(),l.appendChild(m);var x=function(){requestAnimationFrame(b)};o.addEventListener("scroll",x,{passive:!0}),window.addEventListener("scroll",x,{passive:!0});var k=function(){o.removeEventListener("scroll",x),window.removeEventListener("scroll",x),w.unmount(),m.remove()}}}}}}}),[n,r]);return(0,Bt.useEffect)((function(){var t,e=null===(t=n.current)||void 0===t?void 0:t.contentDocument;if(e){var r=(0,Oe.debounce)(o,300,{leading:!0,trailing:!0});e.addEventListener("selectionchange",r);var i=function(){var t=e.getSelection();if(null!==t&&0!==t.rangeCount){var n=t.getRangeAt(0),r=!1===(null==n?void 0:n.collapsed);if(t&&n&&r){var o=jn(n,e);Tn(n,o)&&(t.removeAllRanges(),t.addRange(o)),Cn(t,o)}}};return e.addEventListener("mouseup",i),function(){e.removeEventListener("selectionchange",r),e.removeEventListener("mouseup",i)}}}),[o,n]),null},Ln=function(t,e,n){return n===t?null:t.firstChild&&!e?t.firstChild:t.parentNode?t.nextSibling?t.nextSibling:Ln(t.parentNode,!0,n):null},jn=function(t,e){if(t.startContainer!==t.endContainer&&0===t.endOffset){var n=Nn(t.startContainer);if(null===n)return t;var r=e.createRange();return r.selectNodeContents(n),r}return t},Tn=function(t,e){return t.startContainer!==e.startContainer||t.startOffset!==e.startOffset||t.endContainer!==e.endContainer||t.endOffset!==e.endOffset},Nn=function(t){var e,n,r=["p","li"].join(", ");return t.nodeType===Node.ELEMENT_NODE&&t.matches(r)?t:null!==(n=null===(e=t.parentElement)||void 0===e?void 0:e.closest(r))&&void 0!==n?n:null},Cn=function(t,e){var n,r;if(!function(t,e){var n,r=e.commonAncestorContainer,o=r.nodeType===Node.ELEMENT_NODE?r.closest("a"):null===(n=r.parentElement)||void 0===n?void 0:n.closest("a");if(t.toString()===(null==o?void 0:o.textContent))return!0;if(o){var i=e.cloneRange();return i.selectNodeContents(o),t.removeAllRanges(),t.addRange(i),!0}return!1}(t,e)){var o=e.startContainer,i=e.startOffset,a=e.startOffset;if(o.nodeType===Node.TEXT_NODE)for(var s=null!==(n=o.textContent)&&void 0!==n?n:"";a>0&&/[^\s.,!?;:'"â€™)\]}]/g.test(s[a-1]);)a--;var l=e.endContainer,c=e.endOffset,u=e.endOffset;if(l.nodeType===Node.TEXT_NODE)for(var d=null!==(r=l.textContent)&&void 0!==r?r:"";u<d.length&&/[^\s.,!?;:'"â€™([{]/g.test(d[u]);)u++;a===i&&u===c||(e.setStart(o,a),e.setEnd(l,u),t.removeAllRanges(),t.addRange(e))}},In=function(e){var n=e.previewUrl,r=e.isLoading,o=e.onTextSelected,i=e.isFrontendPreview,a=e.activeLink,s=e.selectedText,l=e.onLoadingChange,c=e.onRestoreOriginal,u=e.onAccept,d=e.onDiscard,p=e.onUpdateLink,f=e.onRemove,h=(0,Bt.useRef)(null),g=(0,Bt.useRef)(null),v=!(null==a?void 0:a.isSuggestion),m=(0,Gt.useSelect)((function(t){return{selectedLinkType:t(Ze).getPreviewLinkType(),isGenerating:!!a&&t(Ze).isGenerating(a)}}),[a]),y=m.selectedLinkType,w=m.isGenerating,b=(0,Oe.usePrevious)(w),x=(0,Bt.useMemo)((function(){if(!n)return n;var t=new URL(n);return t.searchParams.set("customize_changeset_uuid",crypto.randomUUID()),t.toString()}),[n]),k=(0,t.jsx)(kn,{activeLink:a,onAccept:u,onDiscard:d,onUpdateLink:p,onRemove:f,onRestoreOriginal:c,selectedText:null!=s?s:null,iframeRef:g}),_=function(t){var e=t.iframeRef,n=t.contentAreaRef,r=t.activeLink,o=t.selectedText,i=t.isInboundLink,a=t.onRestoreOriginal,s=t.actionsBar,l=vn().injectWordpressComponentStyles,c=(0,Bt.useCallback)((function(t){var e,n,r=null!==(e=t.contentDocument)&&void 0!==e?e:null===(n=t.contentWindow)||void 0===n?void 0:n.document;if(r){l(r);var o=r.createElement("style");o.textContent="\n\t\t\t/** Smart link highlight styles. */\n\t\t\t.smart-link-highlight {\n\t\t\t\toutline: 2px solid #3858E9;\n\t\t\t\tborder-radius: 2px;\n\t\t\t\tbackground-color: #3858E9;\n\t\t\t\tcolor: #ffffff;\n\t\t\t}\n\n\t\t\t.smart-link-highlight *:hover,\n\t\t\t.smart-link-highlight *:focus {\n\t\t\t\tcolor: #ffffff;\n\t\t\t\ttext-decoration: revert;\n\t\t\t}\n\n\t\t\t.smart-link-highlight * {\n\t\t\t\tcolor: #ffffff;\n\t\t\t}\n\n\t\t\t.smart-link-highlight.previous-suggestion {\n\t\t\t\toutline: 2px solid rgba(56, 88, 233, 0.2);\n\t\t\t\tbackground-color: rgba(56, 88, 233, 0.2);\n\t\t\t\ttext-decoration: line-through;\n\t\t\t\tcolor: inherit;\n\t\t\t}\n\n\t\t\t.smart-link-highlight.previous-suggestion * {\n\t\t\t\tcolor: inherit;\n\t\t\t}\n\n\t\t\t/** Link type highlight styles. */\n\t\t\t.link-type-highlight {\n\t\t\t\tborder-radius: 2px;\n\t\t\t\tbackground-color: transparent;\n\t\t\t\toutline: 0 solid transparent;\n\t\t\t\tanimation: highlight-fade-in 0.2s ease-in-out forwards;\n\t\t\t\toutline-width: 0;\n\t\t\t}\n\n\t\t\t.link-type-highlight * {\n\t\t\t\tcolor: white !important;\n\t\t\t\tmix-blend-mode: difference;\n\t\t\t}\n\n\t\t\t.link-type-highlight.removing {\n\t\t\t\tanimation: highlight-fade-out 0.2s ease-in-out forwards;\n\t\t\t}\n\n\t\t\t.link-type-highlight a {\n\t\t\t\ttext-decoration: underline;\n\t\t\t\ttext-decoration-color: currentColor;\n\t\t\t\ttransition: all 0.2s ease-in-out;\n\t\t\t}\n\n\t\t\t.link-type-highlight:not(.removing) a {\n\t\t\t\ttext-decoration-color: transparent;\n\t\t\t}\n\n\t\t\t@keyframes highlight-fade-in {\n\t\t\t\t0% {\n\t\t\t\t\toutline-width: 0;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t}\n\t\t\t\t1% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t}\n\t\t\t\t100% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: currentColor;\n\t\t\t\t\tbackground-color: currentColor;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t@keyframes highlight-fade-out {\n\t\t\t\t0% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: currentColor;\n\t\t\t\t\tbackground-color: currentColor;\n\t\t\t\t}\n\t\t\t\t99% {\n\t\t\t\t\toutline-width: 2px;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tcolor: inherit;\n\t\t\t\t}\n\t\t\t\t100% {\n\t\t\t\t\toutline-width: 0;\n\t\t\t\t\toutline-color: transparent;\n\t\t\t\t\tbackground-color: transparent;\n\t\t\t\t\tcolor: inherit;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Actions bar styles. */\n\t\t\t.parsely-traffic-boost-actions-container {\n\t\t\t\tposition: absolute;\n\t\t\t\tz-index: 1000;\n\t\t\t\ttop: ".concat(8,"px;\n\t\t\t\tleft: ").concat(8,"px;\n\t\t\t\tuser-select: none;\n\t\t\t\topacity: 0;\n\t\t\t\ttransition: opacity 0.1s ease-in-out;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container.fade-in {\n\t\t\t\topacity: 1;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container.align-left {\n\t\t\t\tleft: ").concat(8,"px;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container.align-right {\n\t\t\t\tleft: auto;\n\t\t\t\tright: ").concat(8,'px;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container .traffic-boost-preview-actions {\n\t\t\t\t/* Reset font family to editor defaults to avoid inheriting frontend font in actions toolbar. */\n\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont,"Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell,"Helvetica Neue", sans-serif;\n\t\t\t\theight: 48px;\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: center;\n\t\t\t\talign-items: center;\n\t\t\t\tbackground: rgba(255, 255, 255, 1);\n\t\t\t\tborder: 1px solid #1e1e1e;\n\t\t\t\tborder-radius: 2px;\n\t\t\t\tgap: 8px;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container .traffic-boost-preview-actions-drag-handle {\n\t\t\t\tflex-shrink: 0;\n\t\t\t\tcursor: grab;\n\t\t\t\tborder-right: 1px solid #1e1e1e;\n\t\t\t\tpadding: 0 8px;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container .traffic-boost-preview-actions-drag-handle.dragging {\n\t\t\t\tcursor: grabbing;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container .traffic-boost-preview-actions-buttons {\n\t\t\t\tdisplay: flex;\n\t\t\t\tgap: 4px;\n\t\t\t\talign-items: center;\n\t\t\t\tflex-wrap: nowrap;\n\t\t\t\tjustify-content: center;\n\t\t\t\tpadding-right: 8px;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container .traffic-boost-preview-actions-buttons .components-button {\n\t\t\t\theight: 36px;\n\t\t\t\twhite-space: nowrap;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container .traffic-boost-preview-actions-hint {\n\t\t\t\tdisplay: flex;\n\t\t\t\tcursor: help;\n\t\t\t\tuser-select: none;\n\t\t\t\talign-items: center;\n\t\t\t}\n\n\t\t\t.parsely-traffic-boost-actions-container .traffic-boost-preview-actions-hint-text {\n\t\t\t\tfont-size: 13px;\n\t\t\t\tfont-family: inherit;\n\t\t\t\twhite-space: nowrap;\n\t\t\t\tmargin-left: 4px;\n\t\t\t\tcolor: #2F2F2F;\n\t\t\t}\n\t\t'),r.head.appendChild(o)}}),[l]),u=(0,Bt.useCallback)((function(t,e,n){for(var r,o,i,a=[],s=n.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),l=s.nextNode(),c="",u=[];l;){var d=null!==(r=l.textContent)&&void 0!==r?r:"",p=null===(o=l.parentElement)||void 0===o?void 0:o.closest("article, aside, blockquote, details, dialog, dd, div, dl, dt, fieldset, figcaption, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hgroup, hr, li, main, nav, ol, p, pre, section, table, ul");u.push({node:l,start:c.length,end:c.length+d.length,blockParent:null!=p?p:null}),c+=d,l=s.nextNode()}for(var f=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),h=function(){var e=i.index,r=e+t.length,o=u.find((function(t){return e>=t.start&&e<t.end})),s=u.find((function(t){return r>t.start&&r<=t.end}));if(o&&s&&o.blockParent&&s.blockParent&&o.blockParent===s.blockParent){var l=n.createRange();l.setStart(o.node,e-o.start),l.setEnd(s.node,r-s.start),a.push(l)}};null!==(i=f.exec(c));)h();return a}),[]),d=(0,Bt.useCallback)((function(t,n,r,o){var i,a,l,c,u,d,p,f;void 0===o&&(o=!1);try{var h=null!==(a=null===(i=e.current)||void 0===i?void 0:i.contentDocument)&&void 0!==a?a:null===(c=null===(l=e.current)||void 0===l?void 0:l.contentWindow)||void 0===c?void 0:c.document;if(!h)return;h.querySelector(".parsely-traffic-boost-actions-container")&&window.wpParselyTrafficBoostCleanupActionsBar&&window.wpParselyTrafficBoostCleanupActionsBar();var g=t.cloneContents(),v=h.createElement("span");v.className=o?"".concat(n," previous-suggestion"):n,v.setAttribute("aria-label",r),v.setAttribute("role","mark"),o&&v.setAttribute("aria-roledescription",(0,Mt.__)("Previous suggestion","wp-parsely"));var m=t.commonAncestorContainer,y=m.nodeType===Node.ELEMENT_NODE?m.closest("a"):null===(u=m.parentElement)||void 0===u?void 0:u.closest("a");y&&t.toString().trim()===(null===(d=y.textContent)||void 0===d?void 0:d.trim())&&y?(null===(p=y.parentNode)||void 0===p||p.insertBefore(v,y),v.appendChild(y)):(t.deleteContents(),v.appendChild(g),t.insertNode(v));var w=h.createElement("div");w.className="parsely-traffic-boost-actions-container",h.body.appendChild(w);var b=(0,Bt.createRoot)(w);b.render(s),window.wpParselyTrafficBoostCleanupActionsBar=function(){var t;window.wpParselyTrafficBoostCleanupActionsBar=void 0,"function"==typeof k.cancel&&k.cancel(),null===(t=h.defaultView)||void 0===t||t.removeEventListener("resize",k),b.unmount(),w.parentNode&&w.parentNode.removeChild(w)};var x=function(){var t=h.querySelector(".traffic-boost-preview-actions");if(t){t.style.transform="";var e=v.getBoundingClientRect(),n=h.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();w.classList.remove("align-left","align-right");var o=h.documentElement.scrollTop,i=e.top+o-35-r.height,a=e.left+e.width/2-r.width/2;w.style.top="".concat(Math.max(i,0),"px");var s=a;a+r.width>n.width?(w.classList.add("align-right"),w.style.left=""):s<0?(w.classList.add("align-left"),w.style.left=""):w.style.left="".concat(a,"px"),w.classList.add("fade-in")}};0===h.documentElement.scrollTop?setTimeout(x,400):setTimeout(x,0);var k=(0,Oe.throttle)((function(){return x()}),100);return null===(f=h.defaultView)||void 0===f||f.addEventListener("resize",k),v}catch(t){console.error("WP Parsely: Error highlighting range",t)}}),[e,s]),p=(0,Bt.useCallback)((function(t,e,n){var r,o;void 0===n&&(n=!1);try{var i=null!==(r=t.contentDocument)&&void 0!==r?r:null===(o=t.contentWindow)||void 0===o?void 0:o.document;if(!i)return;var a=function(t,e){window.wpParselyTrafficBoostCleanupActionsBar&&window.wpParselyTrafficBoostCleanupActionsBar();for(var n=i.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);e.insertBefore(n,t),e.removeChild(t),e.normalize(),Array.from(e.querySelectorAll("a")).forEach((function(t){var n,r;if(null===(n=t.textContent)||void 0===n?void 0:n.trim()){var o=t.nextElementSibling;o&&"A"===o.tagName&&(t.href===o.href||t.getAttribute("data-smartlink")===o.getAttribute("data-smartlink")&&null!==t.getAttribute("data-smartlink"))&&(t.nextSibling&&t.nextSibling.nodeType===Node.TEXT_NODE||null===(r=t.parentNode)||void 0===r||r.insertBefore(i.createTextNode(" "),o))}else e.removeChild(t)}))},s=function(t){t.querySelectorAll(e).forEach((function(t){return s(t)}));var r=t.parentNode;r&&(n?(t.classList.add("removing"),setTimeout((function(){a(t,r)}),200)):a(t,r))};i.querySelectorAll(e).forEach((function(t){var n;(null===(n=t.parentElement)||void 0===n?void 0:n.closest(e))||s(t)}))}catch(t){console.error("WP Parsely: Error removing highlights:",t)}}),[]),f=(0,Bt.useCallback)((function(t){p(t,".smart-link-highlight")}),[p]),h=(0,Bt.useCallback)((function(t,e,n){var r,o=!(t.compareBoundaryPoints(Range.END_TO_START,e)>0||t.compareBoundaryPoints(Range.START_TO_END,e)<0),i=(0,Mt.__)("Suggested link","wp-parsely");if(o){if(e.compareBoundaryPoints(Range.START_TO_START,t)<0){var a=e.cloneRange();a.setEnd(t.startContainer,t.startOffset),d(a,n,i,!0),t.setStart(a.endContainer,a.endOffset)}if(e.compareBoundaryPoints(Range.END_TO_END,t)>0){var s=e.cloneRange();s.setStart(t.endContainer,t.endOffset),d(s,n,i,!0)}r=d(t,n,i)}else d(e,n,i,!0),r=d(t,n,i);return r}),[d]),g=(0,Bt.useCallback)((function(t,e,r){if(void 0===r&&(r=0),n.current){var i=u(e,n.current,t)[r];if(i)if(null==o?void 0:o.text){var s=u(o.text,n.current,t)[o.offset];if(s){var l=h(s,i,"smart-link-highlight");l&&(l.style.cursor="pointer",l.addEventListener("click",(function(){a()})))}}else d(i,"smart-link-highlight",(0,Mt.__)("Suggested link","wp-parsely"))}}),[n,u,h,d,o,a]),v=(0,Bt.useCallback)((function(t,e){var i,a,s=t.querySelector('a[data-smartlink="'.concat(e,'"]'));if(s){var l=t.createRange();if(l.selectNode(s),(null==o?void 0:o.text)&&n.current){var c=u(o.text,n.current,t);if(c[o.offset]){var p=c[o.offset];return void h(p,l,"smart-link-highlight")}}d(l,"smart-link-highlight",(0,Mt.__)("Inbound link","wp-parsely"),!!o)}else(null===(i=null==r?void 0:r.smartLink)||void 0===i?void 0:i.text)&&g(t,r.smartLink.text,null!==(a=r.smartLink.offset)&&void 0!==a?a:0)}),[r,o,n,d,u,h,g]),m=(0,Bt.useCallback)((function(t){var e,n,o,a;try{var s=null!==(e=t.contentDocument)&&void 0!==e?e:null===(n=t.contentWindow)||void 0===n?void 0:n.document;if(!s||!(null===(o=null==r?void 0:r.smartLink)||void 0===o?void 0:o.text))return;i?v(s,r.smartLink.uid):g(s,r.smartLink.text,null!==(a=r.smartLink.offset)&&void 0!==a?a:0)}catch(t){console.error("WP Parsely: Error highlighting Smart Link text",t)}}),[r,v,g,i]),y=(0,Bt.useCallback)((function(t,e){var o,i,a=n.current,s=null!==(o=t.contentDocument)&&void 0!==o?o:null===(i=t.contentWindow)||void 0===i?void 0:i.document;if(a&&s&&(p(t,".link-type-highlight",!0),r&&e)){var l=new URL(r.targetPost.link).hostname,c=Array.from(a.querySelectorAll("a"));c=c.filter((function(t){var e;return""!==(null===(e=t.textContent)||void 0===e?void 0:e.trim())}));var u=(0,Mt.__)("Highlighted link","wp-parsely");switch(e){case"external":c=c.filter((function(t){return!t.href.includes(l)})),u=(0,Mt.__)("External link","wp-parsely");break;case"internal":c=c.filter((function(t){return t.href.includes(l)})),u=(0,Mt.__)("Internal link","wp-parsely");break;case"smart":c=c.filter((function(t){return t.hasAttribute("data-smartlink")})),u=(0,Mt.__)("Smart Link","wp-parsely")}(null==c?void 0:c.length)&&c.forEach((function(t){var e=s.createRange();e.selectNode(t),d(e,"link-type-highlight",u)}))}}),[r,n,d,p]);return{injectHighlightStyles:c,highlightSmartLink:m,highlightLinkType:y,removeSmartLinkHighlights:f,removeHighlights:p}}({iframeRef:g,contentAreaRef:h,activeLink:a,selectedText:s,isInboundLink:v,onRestoreOriginal:c,actionsBar:k}),S=_.injectHighlightStyles,E=_.highlightSmartLink,P=_.highlightLinkType,L=_.removeSmartLinkHighlights,j=(0,Bt.useCallback)((function(t){var e,n;if(i){var r=null===(e=t.contentWindow)||void 0===e?void 0:e.document.getElementById("wpadminbar");r&&(r.style.display="none");var o=null===(n=t.contentWindow)||void 0===n?void 0:n.document.documentElement;o&&o.style.setProperty("margin-top","0","important")}}),[i]),T=(0,Bt.useCallback)((function(t){var e,n,r,o,i=null!==(e=null==t?void 0:t.contentDocument)&&void 0!==e?e:null===(n=t.contentWindow)||void 0===n?void 0:n.document;if(i){i.addEventListener("click",(function(t){var e,n,r,o,i,a=t.target;if(!a.closest||!a.closest(".parsely-traffic-boost-actions-container")){if(!(null===(e=h.current)||void 0===e?void 0:e.contains(a)))return t.preventDefault(),void t.stopPropagation();var s="A"===a.tagName?a:a.closest("a");if(s){if(t.preventDefault(),t.stopPropagation(),!["P","A"].includes(null!==(r=null===(n=a.parentElement)||void 0===n?void 0:n.tagName)&&void 0!==r?r:""))return;s.blur(),null===(i=null===(o=s.ownerDocument.defaultView)||void 0===o?void 0:o.getSelection())||void 0===i||i.selectAllChildren(s)}}}),!0),i.addEventListener("submit",(function(t){t.preventDefault(),t.stopPropagation()}),!0),t.contentWindow&&Object.defineProperty(t.contentWindow,"open",{value:function(){return null},writable:!1}),i.addEventListener("contextmenu",(function(t){t.preventDefault(),t.stopPropagation()}),!0);try{(null===(r=t.contentWindow)||void 0===r?void 0:r.history)&&(t.contentWindow.history.pushState=function(){},t.contentWindow.history.replaceState=function(){})}catch(t){}null===(o=t.contentWindow)||void 0===o||o.addEventListener("popstate",(function(t){t.preventDefault(),t.stopPropagation()}),!0)}}),[h]),N=(0,Bt.useCallback)((function(t){var e,n,r=null!==(e=t.contentDocument)&&void 0!==e?e:null===(n=t.contentWindow)||void 0===n?void 0:n.document;if(r){var o=function(){return t=void 0,e=void 0,o=function(){var t;return function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}(this,(function(e){switch(e.label){case 0:return(t=r.querySelector(".smart-link-highlight:not(.previous-suggestion)"))?[4,new Promise((function(t){return setTimeout(t,100)}))]:[3,2];case 1:e.sent(),t.scrollIntoView({behavior:"smooth",block:"center"}),e.label=2;case 2:return[2]}}))},new((n=void 0)||(n=Promise))((function(r,i){function a(t){try{l(o.next(t))}catch(t){i(t)}}function s(t){try{l(o.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((o=o.apply(t,e||[])).next())}));var t,e,n,o},i=new MutationObserver((function(){r.querySelector(".smart-link-highlight:not(.previous-suggestion)")&&o()})),a=nn(r);a&&(i.observe(a,{childList:!0,subtree:!0}),o(),setTimeout((function(){return i.disconnect()}),1e3))}}),[]),C=(0,Bt.useCallback)((function(t){var e;if(null==t?void 0:t.contentDocument){S(t);var n=nn(t.contentDocument);n&&(h.current=n),(null===(e=g.current)||void 0===e?void 0:e.contentDocument)&&(j(t),P(t,y),T(t),l(!1),N(t))}}),[h,T,j,P,S,N,l,y]);return(0,Bt.useEffect)((function(){if(!w){var t=g.current;if(t){var e=function(){C(t)};return t.src!==x&&l(!0),t.addEventListener("load",e),function(){t.removeEventListener("load",e)}}}}),[w,x,C,l]),(0,Bt.useEffect)((function(){h.current=null}),[a,h]),(0,Bt.useEffect)((function(){var t=g.current;(null==t?void 0:t.contentDocument)&&null!==h.current&&!r&&(L(t),E(t),N(t))}),[h,E,r,N,L,s]),(0,Bt.useEffect)((function(){var t=g.current;(null==t?void 0:t.contentDocument)&&null!==h.current&&!r&&P(t,y)}),[h,P,r,y]),(0,t.jsx)("div",{className:"wp-parsely-preview",children:(0,t.jsxs)("div",{className:"preview-iframe-wrapper",children:[(0,t.jsx)("div",{className:"wp-parsely-preview-loading ".concat(r?"is-loading":""),children:i&&a&&en(a)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(cn,{}),(0,Mt.__)("This link is not available in the preview.","wp-parsely")]}):(0,t.jsx)(t.Fragment,{children:r&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Qt.Spinner,{}),(w||b)&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ln,{showSpinner:!1,messages:hn,typewriter:!0,randomOrder:!1})})]})})}),a&&!w&&(!i||!en(a))&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("iframe",{ref:g,src:x,title:(0,Mt.__)("Post Preview","wp-parsely"),className:"wp-parsely-preview-iframe ".concat(r?"is-loading":""),sandbox:"allow-same-origin allow-scripts"}),(0,t.jsx)(Pn,{iframeRef:g,onTextSelected:function(t,e){o(t,e)}})]})]})})},Rn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},An=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},On=function(e){var n=e.activeLink,r=e.onAccept,o=e.onDiscard,i=e.onRemoveInboundLink,a=e.onUpdateInboundLink,s=(0,Bt.useState)(!1),l=s[0],c=s[1],u=(0,Bt.useState)(!1),d=u[0],p=u[1],f=(0,Bt.useState)(!0),h=f[0],g=f[1],v=(0,Bt.useState)(n),m=v[0],y=v[1],w=(0,Bt.useState)(n.targetPost),b=w[0],x=w[1],k=(0,Bt.useState)(null),_=k[0],S=k[1],E=(0,Bt.useState)(""),P=E[0],L=E[1],j=(0,Bt.useState)(0),T=j[0],N=j[1],C=(0,Bt.useState)(0),I=C[0],R=C[1],A=(0,Gt.useDispatch)("core/notices"),O=A.createSuccessNotice,D=A.createErrorNotice,B=(0,Gt.useSelect)((function(t){return{post:t(Ze).getCurrentPost(),suggestions:t(Ze).getSuggestions(),inboundLinks:t(Ze).getInboundLinks()}}),[]),M=B.post,G=B.suggestions,F=B.inboundLinks,U=(0,Gt.useDispatch)(Ze),H=U.setSelectedLink,V=U.removeSuggestion,$=U.removeInboundLink,W=U.addInboundLink,z=U.setSelectedTab,q=U.setIsAccepting,Z=U.setIsRemoving;(0,Bt.useEffect)((function(){y(n)}),[n]),(0,Bt.useEffect)((function(){x(m.targetPost),p(!m.isSuggestion),S(null)}),[m]),(0,Bt.useEffect)((function(){var t,e;m.isSuggestion?(N(null!==(t=null==G?void 0:G.length)&&void 0!==t?t:0),R((null==G?void 0:G.indexOf(m))+1)):(N(null!==(e=null==F?void 0:F.length)&&void 0!==e?e:0),R((null==F?void 0:F.indexOf(m))+1))}),[m,F,G]),(0,Bt.useEffect)((function(){var t,e,n,r;if(b){var o=l?(0,ie.addQueryArgs)(b.link,{parsely_preview:"true",_wpnonce:null!==(n=window._parsely_traffic_boost_preview_nonce)&&void 0!==n?n:"",smart_link_id:null===(r=m.smartLink)||void 0===r?void 0:r.smart_link_id}):(0,ie.addQueryArgs)("".concat(window.location.origin,"/wp-admin/admin-ajax.php"),{action:"parsely_post_preview",post_id:b.id,_wpnonce:null!==(t=window._parsely_traffic_boost_preview_nonce)&&void 0!==t?t:"",smart_link_id:null===(e=m.smartLink)||void 0===e?void 0:e.smart_link_id});o!==P&&(g(!0),L(o))}}),[b,l,P]);var K=(0,Bt.useCallback)((function(){S(null)}),[]),Y=function(){var t;(t=d?null==F?void 0:F[I]:null==G?void 0:G[I])&&(R(I+1),H(t))},J=function(){var t;(t=d?null==F?void 0:F[I-2]:null==G?void 0:G[I-2])&&(R(I-1),H(t))};return b&&M?(0,t.jsxs)("div",{className:"traffic-boost-preview",children:[(0,t.jsx)(an,{isLoading:h,activeLink:m,onOpenPostInNewTab:function(){(null==b?void 0:b.link)&&window.open(b.link,"_blank","noopener")},onOpenPostEditor:function(){(null==b?void 0:b.id)&&window.open("".concat(window.location.origin,"/wp-admin/post.php?post=").concat(b.id,"&action=edit"),"_blank","noopener")},onOpenParselyDashboard:function(){if(null==b?void 0:b.link){var t="https://dash.parsely.com/".concat(window.wpParselySiteId,"/find?url=").concat(encodeURIComponent(b.link));window.open(t,"_blank","noopener")}},isFrontendPreview:l,setIsFrontendPreview:c}),(0,t.jsx)(In,{activeLink:m,previewUrl:P,isLoading:h,selectedText:_,onTextSelected:function(t,e){S({text:t,offset:e})},onRestoreOriginal:K,isFrontendPreview:l,onLoadingChange:g,onAccept:function(e){return Rn(void 0,void 0,void 0,(function(){var n,o;return An(this,(function(i){switch(i.label){case 0:q(e,!0),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r(e,_)];case 2:if(!i.sent())throw new oe((0,Mt.__)("Failed to accept suggestion.","wp-parsely"),qt.UnknownError,"");return[3,4];case 3:return n=i.sent(),o=(0,Mt.__)("Failed to accept suggestion.","wp-parsely"),n instanceof oe&&n.message&&n.code!==qt.UnknownError&&(o+=" ".concat(n.message)),D(o,{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Me})}),q(e,!1),[2];case 4:return V(e),e.isSuggestion=!1,W(e),q(e,!1),O((0,Mt.__)("Link planted","wp-parsely"),{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Ve})}),I===T&&1===T?(z(Ee.INBOUND_LINKS),H(e),L(P+"?cache-bust="+Date.now())):I===T?J():Y(),[2]}}))}))},onDiscard:function(t){return Rn(void 0,void 0,void 0,(function(){return An(this,(function(e){switch(e.label){case 0:return[4,o(t)];case 1:return e.sent(),V(t),I===T&&1===T?H(null):I===T?J():Y(),[2]}}))}))},onUpdateLink:function(e,n){return Rn(void 0,void 0,void 0,(function(){var r,o;return An(this,(function(i){switch(i.label){case 0:if(!_)return[2];q(e,!0),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a(e,_.text,_.offset,n)];case 2:if(!i.sent())throw new oe((0,Mt.__)("Failed to update link.","wp-parsely"),qt.UnknownError,"");return[3,4];case 3:return r=i.sent(),o=(0,Mt.__)("Failed to update link.","wp-parsely"),r instanceof oe&&r.message&&r.code!==qt.UnknownError&&(o+=" ".concat(r.message)),D(o,{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Me})}),q(e,!1),[2];case 4:return q(e,!1),O((0,Mt.__)("Link updated","wp-parsely"),{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Ve})}),L(P+"?cache-bust="+Date.now()),S(null),[2]}}))}))},onRemove:function(e,n){return Rn(void 0,void 0,void 0,(function(){var r,o;return An(this,(function(a){switch(a.label){case 0:Z(e,!0),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i(e,n)];case 2:if(!a.sent())throw new oe((0,Mt.__)("Failed to remove link.","wp-parsely"),qt.UnknownError,"");return[3,4];case 3:return r=a.sent(),o=(0,Mt.__)("Failed to remove link.","wp-parsely"),r instanceof oe&&r.message&&r.code!==qt.UnknownError&&(o+=" ".concat(r.message)),D(o,{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Me})}),Z(e,!1),[2];case 4:return $(e),Z(e,!1),O((0,Mt.__)("Link removed","wp-parsely"),{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:$e})}),I===T&&1===T?H(null):I===T?J():Y(),[2]}}))}))}}),(0,t.jsx)(Je,{activeLink:m,totalItems:T,itemIndex:I,onNext:Y,onPrevious:J})]}):(0,t.jsx)(t.Fragment,{})},Dn=function(e){var n,r=e.post,o=e.isLoading;return(0,t.jsxs)("div",{className:"traffic-boost-post-details",children:[(0,t.jsx)("div",{className:"traffic-boost-post-details-label",children:(0,Mt.__)("Target Post:","wp-parsely")}),(0,t.jsxs)("div",{className:"traffic-boost-post-details-content",children:[(0,t.jsx)(xe,{post:r,size:52,className:"traffic-boost-thumbnail"}),o&&(0,t.jsx)(Qt.Spinner,{}),!o&&(0,t.jsx)("div",{className:"post-title",dangerouslySetInnerHTML:{__html:null!==(n=null==r?void 0:r.title.rendered)&&void 0!==n?n:(0,Mt.__)("(no title)","wp-parsely")}})]}),(0,t.jsx)("div",{className:"traffic-boost-post-details-divider"}),(0,t.jsx)("div",{className:"traffic-boost-post-details-description",children:(0,Mt.__)("Use Parse.ly data to increase your post's traffic. Plant links to this post in high-performing related source posts.","wp-parsely")})]})},Bn=function(e){var n=e.onBackClick,r=e.isLoading,o=e.post;return(0,t.jsxs)("div",{className:"traffic-boost-sidebar-header",children:[(0,t.jsx)("div",{className:"traffic-boost-sidebar-header-nav",children:(0,t.jsx)(Qt.Button,{icon:ee,onClick:n,children:(0,Mt.__)("Back","wp-parsely")})}),(0,t.jsx)("div",{className:"traffic-boost-sidebar-inner",children:(0,t.jsx)(Dn,{post:o,isLoading:r})})]})},Mn=window.wp.escapeHtml,Gn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})}),Fn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),Un=(0,Bt.forwardRef)((function(e,n){var r=e.suggestion,o=e.isActive,i=e.onClick,a=r.targetPost,s=function(){null==i||i(r)};return(0,t.jsxs)("div",{className:"traffic-boost-single-link ".concat(o?"active":""),ref:n,onClick:function(t){t.preventDefault(),s()},onKeyDown:function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),s())},role:"button",tabIndex:0,"aria-label":(0,Mt.sprintf)(/* translators: %s: Post title */ /* translators: %s: Post title */
(0,Mt.__)("Traffic boost link for %s","wp-parsely"),a.title.rendered),"aria-pressed":o,children:[(0,t.jsx)("div",{className:"single-link-thumbnail",children:(0,t.jsx)(xe,{post:a,size:52,className:"traffic-boost-preview-thumbnail"})}),(0,t.jsx)("div",{className:"single-link-details",children:(0,t.jsx)("div",{className:"single-link-title",dangerouslySetInnerHTML:{__html:a.title.rendered}})})]})})),Hn=function(e){var n,r=e.isLoading,o=e.useScrollbar,i=void 0!==o&&o,a=e.children,s=e.links,l=e.onClick,c=e.activeLink,u=e.minItemsPerPage,d=void 0===u?3:u,p=e.currentPage,f=void 0===p?1:p,h=e.itemsPerPage,g=void 0===h?3:h,v=e.onPageChange,m=e.onItemsPerPageChange,y=e.renderEmptyState,w=e.showPagination,b=void 0===w||w,x=(0,Bt.useState)(r),k=x[0],_=x[1],S=(0,Bt.useState)([]),E=S[0],P=S[1],L=(0,Bt.useState)(1),j=L[0],T=L[1],N=(0,Bt.useState)(null!==(n=null==c?void 0:c.uid)&&void 0!==n?n:null),C=N[0],I=N[1],R=(0,Bt.useRef)(null),A=(0,Bt.useRef)(0),O=(0,Bt.useRef)([]),D=(0,Bt.useCallback)((function(){if(!k&&!i)if(R.current){var t=R.current.clientHeight;if(t!==A.current){A.current=t;var e=t-60,n=Math.floor(e/85),r=Math.max(d,n);null==m||m(r),_(!1)}}else null==m||m(d)}),[k,d,m,i]);(0,Bt.useEffect)((function(){_(r)}),[r]),(0,Bt.useEffect)((function(){var t;I(null!==(t=null==c?void 0:c.uid)&&void 0!==t?t:null)}),[c]),(0,Bt.useEffect)((function(){if(i&&c&&R.current){var t=s.findIndex((function(t){return t.uid===c.uid}));if(-1!==t&&O.current[t]){var e=R.current,n=O.current[t];if(n){if(0===t)return void(e.scrollTop=0);var r=e.getBoundingClientRect(),o=n.getBoundingClientRect();(o.top<r.top||o.bottom>r.bottom)&&n.scrollIntoView({behavior:"smooth",block:"start"})}}}}),[c,s,i]),(0,Bt.useEffect)((function(){if(!i){D();var t=new ResizeObserver(D);return R.current&&t.observe(R.current),function(){t.disconnect()}}}),[D,i]),(0,Bt.useEffect)((function(){if(0!==g&&!i){var t=Math.max(1,Math.ceil(s.length/g));T(t||1);var e=(f-1)*g,n=e+g;P(s.slice(e,n)),t<f&&t>0&&(null==v||v(t))}}),[f,g,s,v,i]),(0,Bt.useEffect)((function(){if(!i&&c&&s){var t=s.findIndex((function(t){return t.uid===c.uid}));if(-1!==t){var e=Math.floor(t/g)+1;null==v||v(e)}}}),[c,s,g,v,i]);var B=function(t){I(t.uid),null==l||l(t)};return(0,t.jsxs)("div",{ref:R,className:"traffic-boost-links".concat(i?" scrollbar":""),children:[function(){if(k&&0===E.length)return(0,t.jsx)("div",{className:"traffic-boost-links-list-loading",children:(0,t.jsx)(Qt.Spinner,{})});var e=E;return i&&(e=s),s.length>0&&0===e.length&&!i?null:0===e.length?y?y():(0,t.jsx)("p",{children:(0,Mt.__)("No posts found.","wp-parsely")}):(0,t.jsx)("div",{className:"traffic-boost-links-list",children:e.map((function(e,n){var r;return(0,t.jsx)(Un,{suggestion:e,isActive:e.uid===C,onClick:B,ref:function(t){O.current[n]=t}},e.targetPost.id+(null!==(r=e.uid)&&void 0!==r?r:""))}))})}(),(0,t.jsxs)("div",{className:"links-pagination",children:[(0,t.jsx)("div",{className:"links-pagination-children",children:a}),!i&&!k&&s.length>g&&j>0&&(0,t.jsxs)(t.Fragment,{children:[b&&(0,t.jsxs)("div",{className:"page-selector",children:[(0,t.jsx)("span",{children:(0,Mt.__)("Page","wp-parsely")}),(0,t.jsx)("select",{value:f,onChange:function(t){return function(t){if(i&&t){var e=parseInt(t,10);e>j?e=j:e<1&&(e=1),null==v||v(e)}}(t.target.value)},children:Array.from({length:Math.max(1,j)},(function(t,e){return e+1})).map((function(e){return(0,t.jsx)("option",{value:e,children:e},e)}))}),(0,t.jsxs)("span",{children:[(0,Mt.__)("of","wp-parsely")," ",j]})]}),(0,t.jsxs)("div",{className:"page-navigation",children:[(0,t.jsx)(Qt.Button,{icon:Gn,onClick:function(){i||null==v||v(Math.max(f-1,1))},disabled:f<=1}),(0,t.jsx)(Qt.Button,{icon:Fn,onClick:function(){i||null==v||v(Math.min(f+1,j))},disabled:f>=j})]})]})]})]})},Vn=function(e){var n=e.onInboundLinkClick,r=(0,Gt.useSelect)((function(t){return{selectedLink:t(Ze).getSelectedLink(),inboundLinks:t(Ze).getInboundLinks(),currentPage:t(Ze).getInboundLinksPage(),itemsPerPage:t(Ze).getInboundLinksItemsPerPage(),isLoadingInboundLinks:t(Ze).isLoadingInboundLinks()}}),[]),o=r.selectedLink,i=r.inboundLinks,a=r.currentPage,s=r.itemsPerPage,l=r.isLoadingInboundLinks,c=(0,Gt.useDispatch)(Ze),u=c.setInboundLinksItemsPerPage,d=c.setInboundLinksPage;return(0,t.jsx)(Hn,{isLoading:l,links:i,onClick:n,activeLink:(null==o?void 0:o.isSuggestion)?null:o,currentPage:a,itemsPerPage:s,onPageChange:d,onItemsPerPageChange:u,renderEmptyState:function(){return(0,t.jsx)("div",{className:"traffic-boost-suggestions-empty-state",children:(0,t.jsx)("p",{children:(0,Mt.__)("This post has no inbound links.","wp-parsely")})})}})},$n=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M7 7.2h8.2L13.5 9l1.1 1.1 3.6-3.6-3.5-4-1.1 1 1.9 2.3H7c-.9 0-1.7.3-2.3.9-1.4 1.5-1.4 4.2-1.4 5.6v.2h1.5v-.3c0-1.1 0-3.5 1-4.5.3-.3.7-.5 1.2-.5zm13.8 4V11h-1.5v.3c0 1.1 0 3.5-1 4.5-.3.3-.7.5-1.3.5H8.8l1.7-1.7-1.1-1.1L5.9 17l3.5 4 1.1-1-1.9-2.3H17c.9 0 1.7-.3 2.3-.9 1.5-1.4 1.5-4.2 1.5-5.6z"})}),Wn=(0,t.jsx)(te.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(te.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),zn=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},qn=function(e){var n=e.disabled,r=e.onPostClick,o=e.suggestions,i=(0,Bt.useState)(""),a=i[0],s=i[1],l=(0,Bt.useRef)(null),c=(0,Oe.useDebounce)(s,300),u=(0,Bt.useState)([]),d=u[0],p=u[1],f=(0,Gt.useSelect)((function(t){return t(Ze).getCurrentPost()}),[]);return(0,Bt.useEffect)((function(){var t,e=[null!==(t=null==f?void 0:f.id)&&void 0!==t?t:0];o.length>0&&(e=zn(zn([],e,!0),o.map((function(t){return t.targetPost.id})),!0)),p(e)}),[o,f]),(0,t.jsx)(Qt.Dropdown,{contentClassName:"wp-parsely-traffic-boost-add-new-link-popover",onClose:function(){s("")},renderToggle:function(e){var r=e.isOpen,o=e.onToggle;return(0,t.jsx)(Qt.Button,{icon:Wn,variant:"secondary",className:"traffic-boost-add-suggestion",onClick:o,isPressed:r,disabled:n,children:(0,Mt.__)("Add Source Post","wp-parsely")})},popoverProps:{placement:"bottom-start"},renderContent:function(e){var n=e.onClose;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:(0,Mt.__)("Manually add a post where you would like Parse.ly to plant a link.","wp-parsely")}),(0,t.jsx)("div",{children:(0,t.jsx)(Qt.SearchControl,{__nextHasNoMarginBottom:!0,ref:l,value:a,onChange:c})}),a&&(0,t.jsx)(Ae,{currentPage:1,setCurrentPage:function(){},className:"traffic-boost-add-link-table",query:{status:"publish",per_page:5,search:a,search_columns:["post_title","post_excerpt"],exclude:d,context:"edit"},hideHeader:!0,hidePagination:!0,compact:!0,noResultsMessage:(0,Mt.__)("No posts found.","wp-parsely"),onPostClick:function(t){r(t),n()}})]})}})},Zn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},Kn=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Yn=function(e){var n=e.variant,r=e.isGeneratingSuggestions,o=e.handleGenerateSuggestions;return(0,t.jsx)(Qt.Button,{icon:$n,variant:n,isBusy:r,disabled:r,className:"traffic-boost-add-suggestion",onClick:o,children:r?(0,Mt.__)("Generatingâ€¦","wp-parsely"):(0,Mt.__)("Generate","wp-parsely")})},Jn=function(e){var n=e.onSuggestionClick,r=gn.getInstance(),o=(0,Gt.useSelect)((function(t){return{currentPost:t(Ze).getCurrentPost(),selectedLink:t(Ze).getSelectedLink(),suggestions:t(Ze).getSuggestions(),inboundLinks:t(Ze).getInboundLinks(),isGeneratingSuggestions:t(Ze).isGeneratingSuggestions(),isLoadingSuggestions:t(Ze).isLoadingSuggestions(),settings:t(Ze).getSettings(),suggestionsToGenerate:t(Ze).getSuggestionsToGenerate()}}),[]),i=o.currentPost,a=o.selectedLink,s=o.suggestions,l=o.inboundLinks,c=o.settings,u=o.isGeneratingSuggestions,d=o.isLoadingSuggestions,p=o.suggestionsToGenerate,f=(0,Gt.useDispatch)(Ze),h=f.setSelectedLink,g=f.addSuggestion,v=f.setSuggestions,m=f.updateSuggestion,y=f.setIsGeneratingSuggestions,w=f.setIsGenerating,b=f.removeSuggestion,x=f.setSuggestionsToGenerate,k=(0,Gt.useDispatch)("core/notices"),_=k.createSuccessNotice,S=k.createErrorNotice,E=function(){return Zn(void 0,void 0,void 0,(function(){var e,n,o;return Kn(this,(function(a){switch(a.label){case 0:if(!i)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),y(!0),e=l.map((function(t){var e,n,r,o;return[null===(n=null===(e=t.smartLink)||void 0===e?void 0:e.post_data)||void 0===n?void 0:n.parsely_canonical_url,null===(o=null===(r=t.smartLink)||void 0===r?void 0:r.post_data)||void 0===o?void 0:o.permalink]})).flat().filter((function(t){return void 0!==t})),v([]),x(c.maxItems),[4,r.generateBatchSuggestions(i.id,c.maxItems,{urlExclusionList:e,discardPrevious:!0,save:!0,onNewSuggestions:function(t,e){v(t,!1),e&&h(t[0]),x((function(e){return Math.max(0,e-t.length)}))}})];case 2:return a.sent(),_((0,Mt.__)("Finished generating suggestions.","wp-parsely"),{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:$n})}),y(!1),[3,4];case 3:return n=a.sent(),o=(0,Mt.__)("Failed to generate suggestions.","wp-parsely"),n instanceof oe&&n.message&&n.code!==qt.UnknownError&&(o+=" ".concat(n.message)),S(o,{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Me})}),y(!1),[3,4];case 4:return[2]}}))}))};return d&&u?(0,t.jsx)("div",{className:"traffic-boost-suggestions-loading-generating",children:(0,t.jsx)(ln,{messages:hn,typewriter:!0,randomOrder:!1})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(Hn,{isLoading:d,links:s,useScrollbar:!0,onClick:n,activeLink:(null==a?void 0:a.isSuggestion)?a:null,renderEmptyState:function(){return u?(0,t.jsx)("div",{className:"traffic-boost-suggestions-loading-generating",children:(0,t.jsx)(ln,{messages:hn,typewriter:!0,randomOrder:!1})}):(0,t.jsxs)("div",{className:"traffic-boost-suggestions-empty-state",children:[(0,t.jsx)("p",{children:(0,Mt.__)("This post has no suggestions. Do you want to generate some?","wp-parsely")}),(0,t.jsx)(Yn,{variant:"primary",isGeneratingSuggestions:u,handleGenerateSuggestions:E})]})},children:[!d&&!u&&(0,t.jsx)(qn,{disabled:u,suggestions:s,onPostClick:function(e){return Zn(void 0,void 0,void 0,(function(){var n,o,s,l,c;return Kn(this,(function(u){switch(u.label){case 0:return i?(n=a,o=r.createSuggestion(e),[4,g(o)]):[2];case 1:return u.sent(),[4,w(o,!0)];case 2:u.sent(),u.label=3;case 3:return u.trys.push([3,6,,7]),[4,r.generateSuggestionForPost(i,e,o)];case 4:return s=u.sent(),[4,m(s,o.uid)];case 5:return u.sent(),w(o,!1),[3,7];case 6:return l=u.sent(),c=(0,Mt.__)("Failed to find a link placement.","wp-parsely"),l instanceof oe&&l.message&&l.code!==qt.UnknownError&&(c+=" ".concat(l.message)),S(c,{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Me})}),w(o,!1),b(o),h(n),[3,7];case 7:return[2]}}))}))}}),u&&s.length>0&&(0,t.jsxs)("div",{className:"traffic-boost-suggestions-generating-footer",children:[(0,t.jsx)(Qt.Spinner,{}),(0,t.jsx)("span",{children:(0,Mt.sprintf)(/* translators: %d: number of suggestions generated */ /* translators: %d: number of suggestions generated */
(0,Mt._n)("Generating %d last suggestionâ€¦","Generating %d more suggestionsâ€¦",p,"wp-parsely"),p)})]})]})})},Xn=function(e){var n=e.activeTab,r=e.onSuggestionClick,o=e.onInboundLinkClick,i=e.hardError,a=(0,Gt.useSelect)((function(t){return{selectedLink:t(Ze).getSelectedLink(),selectedTab:t(Ze).getSelectedTab()}}),[]),s=a.selectedLink,l=a.selectedTab,c=(0,Gt.useDispatch)(Ze).setSelectedTab;if((0,Bt.useEffect)((function(){c(n.name)}),[n,c]),(0,Bt.useEffect)((function(){(null==s?void 0:s.isSuggestion)?c(Ee.SUGGESTIONS):s&&!s.isSuggestion&&c(Ee.INBOUND_LINKS)}),[s,c]),i){var u=i.Message();if(qt.ParselySuggestionsApiNoAuthorization===i.code){var d=(0,Mt.sprintf)('<a href="%1$s" target="_blank" rel="noopener">%2$s</a>',"https://lobby.vip.wordpress.com/2025/05/19/introducing-traffic-boost-a-smarter-way-to-recirculate-your-content/",(0,Mt.__)("Traffic Boost","wp-parsely")),p=(0,Mt.sprintf)('<a href="%1$s" target="_blank" rel="noopener">%2$s</a>',"https://docs.wpvip.com/parse-ly/wp-parsely-features/traffic-boost/#Access",(0,Mt.__)("here","wp-parsely")),f=(0,Mt.sprintf)((0,Mn.escapeHTML)(/* translators: %1$s: Lobby Post link, %2$s: VIP Documentation link */ /* translators: %1$s: Lobby Post link, %2$s: VIP Documentation link */
(0,Mt.__)("%1$s is currently not enabled for your Site ID. Information about requesting access to Traffic Boost can be found %2$s.","wp-parsely")),d,p);u=(0,t.jsx)(Zt,{children:f})}return(0,t.jsx)("div",{className:"traffic-boost-suggestions-empty-state",children:u})}switch(l){case Ee.SUGGESTIONS:return(0,t.jsx)(Jn,{onSuggestionClick:r});case Ee.INBOUND_LINKS:return(0,t.jsx)(Vn,{onInboundLinkClick:o});default:return(0,t.jsx)("div",{children:(0,Mt.__)("Select a tab","wp-parsely")})}},Qn=function(e){var n=e.onLinkClick,r=e.hardError,o=q(),i=(0,Gt.useSelect)((function(t){return{post:t(Ze).getCurrentPost(),selectedTab:t(Ze).getSelectedTab(),suggestions:t(Ze).getSuggestions(),inboundLinks:t(Ze).getInboundLinks(),isLoadingPost:t(Ze).isLoadingPost()}}),[]),a=i.post,s=i.isLoadingPost,l=i.selectedTab,c=i.suggestions,u=i.inboundLinks,d=(0,Gt.useDispatch)(Ze).setSelectedTab;return(0,Bt.useEffect)((function(){var t=function(t,e){var n=document.querySelector(t);if(n)if(e<=0){var r=n.querySelector(".tab-count");r&&r.remove()}else{var o=n.querySelector(".tab-count");o||((o=document.createElement("span")).className="tab-count",n.appendChild(o)),o.textContent=e.toString()}};t(".components-tab-panel__tabs-item.suggestions-tab",c.length),t(".components-tab-panel__tabs-item.inbound-links-tab",u.length)}),[u,u.length,c.length]),(0,Bt.useEffect)((function(){var t=document.querySelector(".traffic-boost-sidebar-tabs .".concat(l,"-tab"));t&&t.click()}),[l]),(0,t.jsxs)("div",{className:"traffic-boost-sidebar",children:[(0,t.jsx)(Bn,{isLoading:s,onBackClick:function(){return o("/traffic-boost")},post:null!=a?a:void 0}),(0,t.jsx)("div",{className:"traffic-boost-sidebar-content",children:(0,t.jsx)(Qt.TabPanel,{className:"traffic-boost-sidebar-tabs",tabs:[{name:Ee.SUGGESTIONS,title:(0,Mt.__)("Suggested Sources","wp-parsely"),className:"traffic-boost-tab suggestions-tab"},{name:Ee.INBOUND_LINKS,title:(0,Mt.__)("Inbound Links","wp-parsely"),className:"traffic-boost-tab inbound-links-tab"}],onSelect:function(t){return d(t)},children:function(e){return(0,t.jsx)(Xn,{activeTab:e,onSuggestionClick:n,onInboundLinkClick:n,hardError:r})}})})]})},tr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},er=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},nr=function(){var n=function(){let{matches:t}=e.useContext(U),n=t[t.length-1];return n?n.params:{}}().postId,r=$().state,o=q(),i=(0,Bt.useState)(),a=i[0],s=i[1],l=(0,Bt.useState)(160),c=l[0],u=l[1],d=(0,Bt.useState)(!1),p=d[0],f=d[1],h=(0,Gt.useSelect)((function(t){var e;return{isLoadingPost:t(Ze).isLoadingPost(),error:t(Ze).getError(),inboundLinks:t(Ze).getInboundLinks(),currentPost:null!==(e=null==r?void 0:r.post)&&void 0!==e?e:t(Ze).getCurrentPost(),selectedLink:t(Ze).getSelectedLink(),settings:t(Ze).getSettings(),suggestions:t(Ze).getSuggestions()}}),[null==r?void 0:r.post]),g=h.isLoadingPost,v=h.error,m=h.currentPost,y=h.inboundLinks,w=h.selectedLink,b=h.settings,x=h.suggestions,k=(0,Gt.useDispatch)(Ze),_=k.setError,S=k.setLoading,E=k.setCurrentPost,P=k.setSelectedLink,L=k.setInboundLinks,j=k.setSuggestions,T=k.setIsGeneratingSuggestions,N=k.setSelectedTab,C=k.updateInboundLink,I=k.setSuggestionsToGenerate,R=(0,Gt.useDispatch)("core/notices"),A=R.createSuccessNotice,O=R.createErrorNotice,D=v instanceof oe&&!v.retryFetch;return(0,Bt.useEffect)((function(){var t=document.getElementById("adminmenuback");if(t){var e=window.getComputedStyle(t);s(e.backgroundColor);var n=document.querySelector("#wpwrap");n&&(n.style.backgroundColor=e.backgroundColor);var r=function(){var e=t.getBoundingClientRect().width;u(e)};r();var o=new ResizeObserver((function(){r()}));return o.observe(t),function(){gn.getInstance().cancelAll(),o.disconnect(),n.style.backgroundColor="",T(!1),S(!1),_(null),L([]),j([]),E(null),P(null),N(Ee.SUGGESTIONS)}}}),[]),(0,Bt.useEffect)((function(){(null==r?void 0:r.post)?E(r.post):(S(!0,"post"),tr(void 0,void 0,void 0,(function(){var t,e;return er(this,(function(r){switch(r.label){case 0:if(!n)return[2];r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,gn.getInstance().getPost(parseInt(n))];case 2:return t=r.sent(),E(t||null),[3,5];case 3:return e=r.sent(),_(e),console.error(e),[3,5];case 4:return S(!1,"post"),f(!0),[7];case 5:return[2]}}))})))}),[n,S,E,_,r]),(0,Bt.useEffect)((function(){return function(){E(null),P(null)}}),[E,P]),(0,Bt.useEffect)((function(){(null==w?void 0:w.isSuggestion)&&0===x.length&&P(null)}),[P,x,w]),(0,Bt.useEffect)((function(){!p||g||m||o("/traffic-boost")}),[p,g,m,o]),(0,Bt.useEffect)((function(){if(v&&!D){var e=(0,Mt.__)("There was an issue while fetching the data.","wp-parsely")+(v instanceof oe?" ".concat(v.message):"");O(e,{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Me})}),_(null)}}),[v,O,_,D]),(0,Bt.useEffect)((function(){tr(void 0,void 0,void 0,(function(){var t,e,r;return er(this,(function(o){switch(o.label){case 0:if(!n)return[2];o.label=1;case 1:return o.trys.push([1,3,4,5]),S(!0,"inbound-links"),[4,gn.getInstance().getInboundLinks(parseInt(n))];case 2:return t=o.sent(),e=t.filter((function(t){var e;return(null===(e=t.targetPost)||void 0===e?void 0:e.id)!==parseInt(n)})),L(e),[3,5];case 3:return r=o.sent(),_(r instanceof oe?r:new oe((0,Mt.__)("Failed to fetch inbound links","wp-parsely"),qt.FetchError)),console.error(r),[3,5];case 4:return S(!1,"inbound-links"),[7];case 5:return[2]}}))}))}),[n,L,_,S]),(0,Bt.useEffect)((function(){n&&tr(void 0,void 0,void 0,(function(){var e,r,o,i;return er(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,6,7]),_(null),S(!0,"suggestions"),[4,(e=gn.getInstance()).getExistingSuggestions(parseInt(n))];case 1:return 0!==(r=a.sent()).length?[3,3]:(T(!0),o=y.map((function(t){var e,n,r,o;return[null===(n=null===(e=t.smartLink)||void 0===e?void 0:e.post_data)||void 0===n?void 0:n.parsely_canonical_url,null===(o=null===(r=t.smartLink)||void 0===r?void 0:r.post_data)||void 0===o?void 0:o.permalink]})).flat().filter((function(t){return void 0!==t})),I(b.maxItems),[4,e.generateBatchSuggestions(parseInt(n),b.maxItems,{urlExclusionList:o,discardPrevious:!0,save:!0,onNewSuggestions:function(t,e){e&&S(!1,"suggestions"),j(t,!1),e&&P(t[0]),I((function(e){return Math.max(0,e-t.length)}))}})]);case 2:return a.sent(),A((0,Mt.__)("Finished generating suggestions.","wp-parsely"),{type:"snackbar",icon:(0,t.jsx)(Qt.Icon,{icon:Ge})}),[3,4];case 3:j(r),r.length>0&&P(r[0]),a.label=4;case 4:return[3,7];case 5:return(i=a.sent())instanceof oe&&_(i),console.error(i),[3,7];case 6:return T(!1),S(!1,"suggestions"),[7];case 7:return[2]}}))}))}),[n]),(0,t.jsxs)(Jt,{name:"traffic-boost-single-post",backgroundColor:a,className:"traffic-boost-single-post",style:{position:"fixed",left:c,width:"calc(100% - calc(".concat(c,"px + var(--grid-unit-20)))"),transition:"left 0.3s ease, width 0.3s ease"},children:[(0,t.jsx)("style",{children:"\n\t\t\t\t\t#wpfooter {\n\t\t\t\t\t\tdisplay: none;\n\t\t\t\t\t}\n\t\t\t\t\t#wpbody-content {\n\t\t\t\t\t\tpadding-bottom: 0 !important;\n\t\t\t\t\t}\n\t\t\t\t"}),(0,t.jsx)(Qn,{onLinkClick:function(t){P(t)},hardError:D?v:void 0}),w&&(0,t.jsx)(On,{activeLink:w,onAccept:function(t,e){return tr(void 0,void 0,void 0,(function(){var n,r,o,i;return er(this,(function(a){switch(a.label){case 0:return t.smartLink&&m&&0!==t.smartLink.smart_link_id?[4,gn.getInstance().acceptSuggestion(m.id,t.smartLink.smart_link_id,{text:null==e?void 0:e.text,offset:null==e?void 0:e.offset})]:[2,!1];case 1:return n=a.sent(),r=n.success,o=n.didReplaceLink,i=n.postContent,o&&(t.smartLink.is_link_replacement=!0),t.targetPost.content.raw=i,[2,r]}}))}))},onDiscard:function(t){return tr(void 0,void 0,void 0,(function(){return er(this,(function(e){return t.smartLink&&m&&0!==t.smartLink.smart_link_id?(gn.getInstance().discardSuggestion(m.id,t.smartLink.smart_link_id),[2]):[2]}))}))},onRemoveInboundLink:function(t,e){return tr(void 0,void 0,void 0,(function(){return er(this,(function(n){switch(n.label){case 0:return t.smartLink&&m&&0!==t.smartLink.smart_link_id?[4,gn.getInstance().removeInboundLink(m.id,t.smartLink.smart_link_id,e)]:[2,!1];case 1:return[2,n.sent()]}}))}))},onUpdateInboundLink:function(t,e,n,r){return tr(void 0,void 0,void 0,(function(){var o;return er(this,(function(i){switch(i.label){case 0:return t.smartLink&&m&&0!==t.smartLink.smart_link_id?[4,gn.getInstance().updateInboundLink(m.id,t.smartLink.smart_link_id,{text:e,offset:n,restore_original:r})]:[2,!1];case 1:return(o=i.sent())&&(t.smartLink=o.data.smart_link,t.targetPost.content.raw=o.data.post_content,C(t,t.smartLink.uid)),[2,!0]}}))}))}}),(0,t.jsx)(He,{className:w?"traffic-boost-snackbar-notices":""})]})};Dt()((function(){var e;null===(e=document.querySelector("#toplevel_page_parsely-dashboard-page .wp-submenu li.wp-first-item"))||void 0===e||e.classList.add("current"),(0,Bt.createRoot)(document.getElementById("parsely-dashboard-page")).render((0,t.jsx)(Tt,{children:(0,t.jsx)(rr,{})}))}));var rr=function(){return(0,t.jsxs)(st,{children:[(0,t.jsx)(it,{path:"/",element:(0,t.jsx)(ot,{to:"/traffic-boost",replace:!0})}),(0,t.jsx)(it,{path:"/traffic-boost",element:(0,t.jsx)(De,{})}),(0,t.jsx)(it,{path:"/traffic-boost/:postId",element:(0,t.jsx)(nr,{})}),(0,t.jsx)(it,{path:"/settings",element:(0,t.jsx)(Be,{})})]})}}()}();