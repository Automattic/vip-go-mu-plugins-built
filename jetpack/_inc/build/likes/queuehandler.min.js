(()=>{var e=[],t=!1,i=[],o=new Promise((e=>{"loading"!==document.readyState?e():window.addEventListener("DOMContentLoaded",(()=>e()))}));function n(e,t){if("string"==typeof e)try{e=JSON.parse(e)}catch{return}if(t&&"function"==typeof t.postMessage)try{t.postMessage(JSON.stringify({type:"likesMessage",data:e}),"*")}catch{}}function s(){const t=[];document.querySelectorAll("div.jetpack-likes-widget-unloaded").forEach((i=>{if(!(e.indexOf(i.id)>-1)&&c(i)){e.push(i.id);var o,n=/like-(post|comment)-wrapper-(\d+)-(\d+)-(\w+)/.exec(i.id);n&&5===n.length&&(o={blog_id:n[2],width:i.width},"post"===n[1]?o.post_id=n[3]:"comment"===n[1]&&(o.comment_id=n[3]),o.obj_id=n[4],t.push(o))}})),t.length>0&&n({event:"initialBatch",requests:t},window.frames["likes-master"])}function a(){const e=document.querySelector("#likes-other-gravatars");if(e){e.style.display="none",e.setAttribute("aria-hidden","true");const t=e.__resizeHandler;t&&(window.removeEventListener("resize",t),delete e.__resizeHandler)}}function r(){var e;if(t){!function(){for(let e=i.length-1;e>=0;e--){const t=i[e];if(!c(t)){const o=t&&t.parentElement&&t.parentElement.parentElement;o.classList.remove("jetpack-likes-widget-loaded"),o.classList.remove("jetpack-likes-widget-loading"),o.classList.add("jetpack-likes-widget-unloaded"),i.splice(e,1),t.remove()}}}();var o=[...document.querySelectorAll("div.jetpack-likes-widget-unloaded")].filter((e=>c(e)));o.length>0&&s();for(var n=0,a=o.length;n<=a-1;n++)(e=o[n].id)&&l(e)}else setTimeout(r,500)}function l(e){if(void 0===e)return;const t=document.querySelector("#"+e);t.querySelectorAll("iframe").forEach((e=>e.remove()));const o=t.querySelector(".likes-widget-placeholder");if(o&&o.classList.contains("post-likes-widget-placeholder")){const e=document.createElement("iframe");e.classList.add("post-likes-widget","jetpack-likes-widget"),e.name=t.dataset.name,e.src=t.dataset.src,e.height="55px",e.width="100%",e.frameBorder="0",e.scrolling="no",e.title=t.dataset.title,o.after(e)}if(o.classList.contains("comment-likes-widget-placeholder")){const e=document.createElement("iframe");e.class="comment-likes-widget-frame jetpack-likes-widget-frame",e.name=t.dataset.name,e.src=t.dataset.src,e.height="18px",e.width="100%",e.frameBorder="0",e.scrolling="no",t.querySelector(".comment-like-feedback").after(e),i.push(e)}t.classList.remove("jetpack-likes-widget-unloaded"),t.classList.add("jetpack-likes-widget-loading"),t.querySelector("iframe").addEventListener("load",(e=>{n({event:"loadLikeWidget",name:e.target.name,width:e.target.width},window.frames["likes-master"]),t.classList.remove("jetpack-likes-widget-loading"),t.classList.add("jetpack-likes-widget-loaded")}))}function c(e){const t=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;return t+2e3>=0&&i<=window.innerHeight+2e3}window.addEventListener("message",(function(e){let i=e&&e.data;if("string"==typeof i)try{i=JSON.parse(i)}catch{return}const r=i&&i.type,l=i&&i.data;if("likesMessage"!==r||void 0===l.event)return;if("https://widgets.wp.com"===e.origin)switch(l.event){case"masterReady":o.then((()=>{t=!0;const e={event:"injectStyles"},i=document.querySelector(".sd-text-color"),o=document.querySelector(".sd-link-color"),a=i&&getComputedStyle(i)||{},r=o&&getComputedStyle(o)||{};document.body.classList.contains("single")&&n({event:"reblogsEnabled"},window.frames["likes-master"]),e.textStyles={color:a.color,fontFamily:a["font-family"],fontSize:a["font-size"],direction:a.direction,fontWeight:a["font-weight"],fontStyle:a["font-style"],textDecoration:a["text-decoration"]},e.linkStyles={color:r.color,fontFamily:r["font-family"],fontSize:r["font-size"],textDecoration:r["text-decoration"],fontWeight:r["font-weight"],fontStyle:r["font-style"]},n(e,window.frames["likes-master"]),s()}));break;case"showLikeWidget":l.total>0&&document.querySelector(`#${l.id}`).classList.add("liked");break;case"showCommentLikeWidget":break;case"killCommentLikes":document.querySelectorAll(".jetpack-comment-likes-widget-wrapper").forEach((e=>e.remove()));break;case"clickReblogFlair":wpcom_reblog&&"function"==typeof wpcom_reblog.toggle_reblog_box_flair&&wpcom_reblog.toggle_reblog_box_flair(l.obj_id);break;case"hideOtherGravatars":a();break;case"clickPostLike":l.total>0?document.querySelector(`#${l.id}`).classList.add("liked"):document.querySelector(`#${l.id}`).classList.remove("liked");break;case"showOtherGravatars":{const e=document.querySelector("#likes-other-gravatars");if(!e)break;const t=e.querySelector("ul");e.style.display="none",t.innerHTML="",e.querySelectorAll(".likes-text span").forEach((e=>e.textContent=l.totalLikesLabel)),(l.likers||[]).forEach((async(e,i)=>{if("http"!==e.profile_URL.substr(0,4))return;const o=document.createElement("li");t.append(o);const s=encodeURI(e.profile_URL),r=encodeURI(e.avatar_URL);o.innerHTML=`<a href="${s}" rel="nofollow" target="_parent" class="wpl-liker">\n\t\t\t\t\t\t<img src="${r}"\n\t\t\t\t\t\t\talt=""\n\t\t\t\t\t\t\tstyle="width: 28px; height: 28px;" />\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t</a>`,o.classList.add(e.css_class),o.querySelector("img").alt=l.avatarAltTitle.replace("%s",e.name),o.querySelector("span").innerText=e.name,i===l.likers.length-1&&o.addEventListener("keydown",(e=>{"Tab"!==e.key||e.shiftKey||(e.preventDefault(),a(),n({event:"focusLikesCount",parent:l.parent},window.frames["likes-master"]))}))}));const i=function(){const t="rtl"===getComputedStyle(e).direction,i=document.querySelector(`*[name='${l.parent}']`),o=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,s=o.top+n.pageYOffset,a=o.left+n.pageXOffset;let r=0;if(e.style.top=s+l.position.top-1+"px",t){const t=l&&l.likers?Math.min(l.likers.length,5):0;r=a+l.position.left+24*t+4,e.style.transform="translateX(-100%)"}else r=a+l.position.left;e.style.left=r+"px";const c=l.width-20,d=Math.floor(c/37);let f=37*Math.ceil(l.likers.length/d)+17+22;f>204&&(f=204),e.style.left="-9999px",e.style.display="block";const m=e.offsetWidth;r+m>n.innerWidth&&(r=o.right-m),e.style.left=r+"px",e.setAttribute("aria-hidden","false")};i(),e.focus();const o=function(e,t){var i;return function(){var o=this,n=arguments;clearTimeout(i),i=setTimeout((function(){e.apply(o,n)}),t)}},s=o(i,100);e.__resizeHandler=s,window.addEventListener("resize",s),e.focus()}}})),document.addEventListener("click",a);var d,f,m,u=(d=250,f=r,function(){clearTimeout(m),m=setTimeout(f,d)});r(),window.addEventListener("scroll",u,!0)})();