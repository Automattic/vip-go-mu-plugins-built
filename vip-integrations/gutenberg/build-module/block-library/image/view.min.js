import*as t from"@wordpress/interactivity";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const n=(a={getContext:()=>t.getContext,getElement:()=>t.getElement,store:()=>t.store,withSyncEvent:()=>t.withSyncEvent},o={},e.d(o,a),o);var a,o;let r=!1,i=0;const{state:l,actions:g,callbacks:c}=(0,n.store)("core/image",{state:{currentImageId:null,get currentImage(){return l.metadata[l.currentImageId]},get overlayOpened(){return null!==l.currentImageId},get roleAttribute(){return l.overlayOpened?"dialog":null},get ariaModal(){return l.overlayOpened?"true":null},get enlargedSrc(){return l.currentImage.uploadedSrc||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},get figureStyles(){return l.overlayOpened&&`${l.currentImage.figureStyles?.replace(/margin[^;]*;?/g,"")};`},get imgStyles(){return l.overlayOpened&&`${l.currentImage.imgStyles?.replace(/;$/,"")}; object-fit:cover;`},get imageButtonRight(){const{imageId:t}=(0,n.getContext)();return l.metadata[t].imageButtonRight},get imageButtonTop(){const{imageId:t}=(0,n.getContext)();return l.metadata[t].imageButtonTop},get isContentHidden(){const t=(0,n.getContext)();return l.overlayEnabled&&l.currentImageId===t.imageId},get isContentVisible(){const t=(0,n.getContext)();return!l.overlayEnabled&&l.currentImageId===t.imageId}},actions:{showLightbox(){const{imageId:t}=(0,n.getContext)();l.metadata[t].imageRef?.complete&&(l.scrollTopReset=document.documentElement.scrollTop,l.scrollLeftReset=document.documentElement.scrollLeft,l.overlayEnabled=!0,l.currentImageId=t,c.setOverlayStyles())},hideLightbox(){l.overlayEnabled&&(l.overlayEnabled=!1,setTimeout((function(){l.currentImage.buttonRef.focus({preventScroll:!0}),l.currentImageId=null}),450))},handleKeydown:(0,n.withSyncEvent)((t=>{if(l.overlayEnabled){if("Tab"===t.key){t.preventDefault();const{ref:e}=(0,n.getElement)();e.querySelector("button").focus()}"Escape"===t.key&&g.hideLightbox()}})),handleTouchMove:(0,n.withSyncEvent)((t=>{l.overlayEnabled&&t.preventDefault()})),handleTouchStart(){r=!0},handleTouchEnd(){i=Date.now(),r=!1},handleScroll(){l.overlayOpened&&!r&&Date.now()-i>450&&window.scrollTo(l.scrollLeftReset,l.scrollTopReset)}},callbacks:{setOverlayStyles(){if(!l.overlayEnabled)return;let{naturalWidth:t,naturalHeight:e,offsetWidth:n,offsetHeight:a}=l.currentImage.imageRef,{x:o,y:r}=l.currentImage.imageRef.getBoundingClientRect();const i=t/e;let g=n/a;if("contain"===l.currentImage.scaleAttr)if(i>g){const t=n/i;r+=(a-t)/2,a=t}else{const t=a*i;o+=(n-t)/2,n=t}g=n/a;let c=parseFloat("none"!==l.currentImage.targetWidth?l.currentImage.targetWidth:t),d=parseFloat("none"!==l.currentImage.targetHeight?l.currentImage.targetHeight:e),s=c/d,u=c,m=d,h=c,p=d;if(i.toFixed(2)!==s.toFixed(2)){if(i>s){const t=c/i;d-t>c?(d=t,c=t*i):d=c/i}else{const t=d*i;c-t>d?(c=t,d=t/i):c=d*i}h=c,p=d,s=c/d,g>s?(u=c,m=u/g):(m=d,u=m*g)}(n>h||a>p)&&(h=n,p=a);let f=0;window.innerWidth>480?f=80:window.innerWidth>1920&&(f=160);const y=Math.min(window.innerWidth-f,h),w=Math.min(window.innerHeight-80,p);g>y/w?(h=y,p=h/g):(p=w,h=p*g);const b=n/h,I=c*(h/u),v=d*(p/m);l.overlayStyles=`\n\t\t\t\t\t--wp--lightbox-initial-top-position: ${r}px;\n\t\t\t\t\t--wp--lightbox-initial-left-position: ${o}px;\n\t\t\t\t\t--wp--lightbox-container-width: ${h+1}px;\n\t\t\t\t\t--wp--lightbox-container-height: ${p+1}px;\n\t\t\t\t\t--wp--lightbox-image-width: ${I}px;\n\t\t\t\t\t--wp--lightbox-image-height: ${v}px;\n\t\t\t\t\t--wp--lightbox-scale: ${b};\n\t\t\t\t\t--wp--lightbox-scrollbar-width: ${window.innerWidth-document.documentElement.clientWidth}px;\n\t\t\t\t`},setButtonStyles(){const{imageId:t}=(0,n.getContext)(),{ref:e}=(0,n.getElement)();l.metadata[t].imageRef=e,l.metadata[t].currentSrc=e.currentSrc;const{naturalWidth:a,naturalHeight:o,offsetWidth:r,offsetHeight:i}=e;if(0===a||0===o)return;const g=e.parentElement,c=e.parentElement.clientWidth;let d=e.parentElement.clientHeight;const s=g.querySelector("figcaption");if(s){const t=window.getComputedStyle(s);["absolute","fixed"].includes(t.position)||(d=d-s.offsetHeight-parseFloat(t.marginTop)-parseFloat(t.marginBottom))}const u=d-i,m=c-r;let h=u+16,p=m+16;if("contain"===l.metadata[t].scaleAttr){const t=a/o;t>=r/i?(h=(i-r/t)/2+u+16,p=m+16):(h=u+16,p=(r-i*t)/2+m+16)}l.metadata[t].imageButtonTop=h,l.metadata[t].imageButtonRight=p},setOverlayFocus(){if(l.overlayEnabled){const{ref:t}=(0,n.getElement)();t.focus()}},initTriggerButton(){const{imageId:t}=(0,n.getContext)(),{ref:e}=(0,n.getElement)();l.metadata[t].buttonRef=e}}},{lock:!0});
//# sourceMappingURL=view.min.js.map