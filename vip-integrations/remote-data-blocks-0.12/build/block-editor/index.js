(()=>{var e={9545:(e,t)=>{"use strict";t.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");var n={},r=e.length;if(r<2)return n;var i=t&&t.decode||u,a=0,s=0,f=0;do{if(-1===(s=e.indexOf("=",a)))break;if(-1===(f=e.indexOf(";",a)))f=r;else if(s>f){a=e.lastIndexOf(";",s-1)+1;continue}var p=l(e,a,s),v=c(e,s,p),h=e.slice(p,v);if(!o.call(n,h)){var g=l(e,s+1,f),m=c(e,f,g);34===e.charCodeAt(g)&&34===e.charCodeAt(m-1)&&(g++,m--);var b=e.slice(g,m);n[h]=d(b,i)}a=f+1}while(a<r);return n},t.serialize=function(e,t,o){var l=o&&o.encode||encodeURIComponent;if("function"!=typeof l)throw new TypeError("option encode is invalid");if(!r.test(e))throw new TypeError("argument name is invalid");var c=l(t);if(!i.test(c))throw new TypeError("argument val is invalid");var u=e+"="+c;if(!o)return u;if(null!=o.maxAge){var d=Math.floor(o.maxAge);if(!isFinite(d))throw new TypeError("option maxAge is invalid");u+="; Max-Age="+d}if(o.domain){if(!a.test(o.domain))throw new TypeError("option domain is invalid");u+="; Domain="+o.domain}if(o.path){if(!s.test(o.path))throw new TypeError("option path is invalid");u+="; Path="+o.path}if(o.expires){var f=o.expires;if(!function(e){return"[object Date]"===n.call(e)}(f)||isNaN(f.valueOf()))throw new TypeError("option expires is invalid");u+="; Expires="+f.toUTCString()}if(o.httpOnly&&(u+="; HttpOnly"),o.secure&&(u+="; Secure"),o.partitioned&&(u+="; Partitioned"),o.priority)switch("string"==typeof o.priority?o.priority.toLowerCase():o.priority){case"low":u+="; Priority=Low";break;case"medium":u+="; Priority=Medium";break;case"high":u+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(o.sameSite)switch("string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"strict":u+="; SameSite=Strict";break;case"none":u+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return u};var n=Object.prototype.toString,o=Object.prototype.hasOwnProperty,r=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,i=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,a=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/;function l(e,t,n){do{var o=e.charCodeAt(t);if(32!==o&&9!==o)return t}while(++t<n);return n}function c(e,t,n){for(;t>n;){var o=e.charCodeAt(--t);if(32!==o&&9!==o)return t+1}return n}function u(e){return-1!==e.indexOf("%")?decodeURIComponent(e):e}function d(e,t){try{return t(e)}catch(t){return e}}},1510:(e,t,n)=>{"use strict";var o=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.getCallbacksMap=a,t.isLoading=s,t.addScriptCallback=function(e,t){var n=a();s(e)?(r('Adding a callback for an existing script from "'.concat(e,'"')),n.get(e).add(t)):(r('Adding a callback for a new script from "'.concat(e,'"')),n.set(e,new Set([t])))},t.removeScriptCallback=function(e,t){if(r('Removing a known callback for a script from "'.concat(e,'"')),s(e)){var n=a(),o=n.get(e);o.delete(t),0===o.size&&n.delete(e)}},t.removeScriptCallbacks=function(e){r('Removing all callbacks for a script from "'.concat(e,'"')),a().delete(e)},t.removeAllScriptCallbacks=function(){r("Removing all callbacks for scripts from all URLs"),a().clear()},t.executeCallbacks=l,t.handleRequestSuccess=function(){var e=this.getAttribute("src");r('Handling successful request for "'.concat(e,'"')),l(e),this.onload=null},t.handleRequestError=function(){var e=this.getAttribute("src");r('Handling failed request for "'.concat(e,'"')),l(e,new Error('Failed to load script "'.concat(e,'"'))),this.onerror=null};var r=(0,o(n(2769)).default)("lib/load-script/callback-handler"),i=new Map;function a(){return i}function s(e){return a().has(e)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=a(),o=n.get(e);if(o){var i='Executing callbacks for "'.concat(e,'"')+(null===t?" with success":' with error "'.concat(t,'"'));r(i),o.forEach((function(e){"function"==typeof e&&e(t)})),n.delete(e)}}},8469:(e,t,n)=>{"use strict";var o=n(4994);Object.defineProperty(t,"__esModule",{value:!0}),t.createScriptElement=function(e){a('Creating script element for "'.concat(e,'"'));var t=document.createElement("script");return t.src=e,t.type="text/javascript",t.async=!0,t.onload=i.handleRequestSuccess,t.onerror=i.handleRequestError,t},t.attachToHead=function(e){a("Attaching element to head"),document.head.appendChild(e)};var r=o(n(2769)),i=n(1510),a=(0,r.default)("lib/load-script/dom-operations")},1050:(e,t,n)=>{"use strict";var o=n(4994);t.k0=function(e,t){if(!(0,i.isLoading)(e)&&(0,a.attachToHead)((0,a.createScriptElement)(e)),"function"!=typeof t)return new Promise((function(t,n){(0,i.addScriptCallback)(e,(function(e){null===e?t():n(e)}))}));(0,i.addScriptCallback)(e,t)};var r=o(n(2769)),i=n(1510),a=n(8469);(0,r.default)("package/load-script")},2769:(e,t,n)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":o(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(r=o))})),t.splice(r,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(2632)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2632:(e,t,n)=>{"use strict";e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return o.colors[Math.abs(t)%o.colors.length]}function o(e){var n;function a(){if(a.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=a,s=Number(new Date),l=s-(n||s);i.diff=l,i.prev=n,i.curr=s,n=s,t[0]=o.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;c++;var r=o.formatters[n];if("function"==typeof r){var a=t[c];e=r.call(i,a),t.splice(c,1),c--}return e})),o.formatArgs.call(i,t),(i.log||o.log).apply(i,t)}}return a.namespace=e,a.enabled=o.enabled(e),a.useColors=o.useColors(),a.color=t(e),a.destroy=r,a.extend=i,"function"==typeof o.init&&o.init(a),o.instances.push(a),a}function r(){var e=o.instances.indexOf(this);return-1!==e&&(o.instances.splice(e,1),!0)}function i(e,t){return o(this.namespace+(void 0===t?":":t)+e)}return o.debug=o,o.default=o,o.coerce=function(e){return e instanceof Error?e.stack||e.message:e},o.disable=function(){o.enable("")},o.enable=function(e){var t;o.save(e),o.names=[],o.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$")));for(t=0;t<o.instances.length;t++){var i=o.instances[t];i.enabled=o.enabled(i.namespace)}},o.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=o.skips.length;t<n;t++)if(o.skips[t].test(e))return!1;for(t=0,n=o.names.length;t<n;t++)if(o.names[t].test(e))return!0;return!1},o.humanize=n(6585),Object.keys(e).forEach((function(t){o[t]=e[t]})),o.instances=[],o.names=[],o.skips=[],o.formatters={},o.selectColor=t,o.enable(o.load()),o}},7833:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(o++,"%c"===e&&(r=o))})),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(736)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,n)=>{e.exports=function(e){function t(e){let n,r,i,a=null;function s(...e){if(!s.enabled)return;const o=s,r=Number(new Date),i=r-(n||r);o.diff=i,o.prev=n,o.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,r)=>{if("%%"===n)return"%";a++;const i=t.formatters[r];if("function"==typeof i){const t=e[a];n=i.call(o,t),e.splice(a,1),a--}return n})),t.formatArgs.call(o,e),(o.log||t.log).apply(o,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=o,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(r!==t.namespaces&&(r=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function o(e,n){const o=t(this.namespace+(void 0===n?":":n)+e);return o.log=this.log,o}function r(e,t){let n=0,o=0,r=-1,i=0;for(;n<e.length;)if(o<t.length&&(t[o]===e[n]||"*"===t[o]))"*"===t[o]?(r=o,i=n,o++):(n++,o++);else{if(-1===r)return!1;o=r+1,i++,n=i}for(;o<t.length&&"*"===t[o];)o++;return o===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names,...t.skips.map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").trim().replace(" ",",").split(",").filter(Boolean);for(const e of n)"-"===e[0]?t.skips.push(e.slice(1)):t.names.push(e)},t.enabled=function(e){for(const n of t.skips)if(r(e,n))return!1;for(const n of t.names)if(r(e,n))return!0;return!1},t.humanize=n(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},7007:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(n,o){function r(n){e.removeListener(t,i),o(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}h(e,t,i,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&h(e,"error",t,{once:!0})}(e,r)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function c(e,t,n,o){var r,i,a,c;if(s(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if("function"==typeof a?a=i[t]=o?[n,a]:[a,n]:o?a.unshift(n):a.push(n),(r=l(e))>0&&a.length>r&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=u.bind(o);return r.listener=n,o.wrapFn=r,r}function f(e,t,n){var o=e._events;if(void 0===o)return[];var r=o[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):v(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function h(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(i){o.once&&e.removeEventListener(t,r),n(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,u=v(l,c);for(n=0;n<c;++n)o(u[n],this,t)}return!0},i.prototype.addListener=function(e,t){return c(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return c(this,e,t,!0)},i.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,o,r,i,a;if(s(t),void 0===(o=this._events))return this;if(void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,r=i;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,i=Object.keys(n);for(o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},i.prototype.listeners=function(e){return f(this,e,!0)},i.prototype.rawListeners=function(e){return f(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},6166:(e,t,n)=>{"use strict";var o=n(7426),r=n(3349);function i(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=i,i.prototype.update=function(e,t){if(e=o.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=o.join32(e,0,e.length-n,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},i.prototype.digest=function(e){return this.update(this._pad()),r(null===this.pending),this._digest(e)},i.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,o=new Array(n+this.padLength);o[0]=128;for(var r=1;r<n;r++)o[r]=0;if(e<<=3,"big"===this.endian){for(var i=8;i<this.padLength;i++)o[r++]=0;o[r++]=0,o[r++]=0,o[r++]=0,o[r++]=0,o[r++]=e>>>24&255,o[r++]=e>>>16&255,o[r++]=e>>>8&255,o[r++]=255&e}else for(o[r++]=255&e,o[r++]=e>>>8&255,o[r++]=e>>>16&255,o[r++]=e>>>24&255,o[r++]=0,o[r++]=0,o[r++]=0,o[r++]=0,i=8;i<this.padLength;i++)o[r++]=0;return o}},2287:(e,t,n)=>{"use strict";var o=n(7426),r=n(6166),i=n(6225),a=n(3349),s=o.sum32,l=o.sum32_4,c=o.sum32_5,u=i.ch32,d=i.maj32,f=i.s0_256,p=i.s1_256,v=i.g0_256,h=i.g1_256,g=r.BlockHash,m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=m,this.W=new Array(64)}o.inherits(b,g),e.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,t){for(var n=this.W,o=0;o<16;o++)n[o]=e[t+o];for(;o<n.length;o++)n[o]=l(h(n[o-2]),n[o-7],v(n[o-15]),n[o-16]);var r=this.h[0],i=this.h[1],g=this.h[2],m=this.h[3],b=this.h[4],y=this.h[5],C=this.h[6],_=this.h[7];for(a(this.k.length===n.length),o=0;o<n.length;o++){var w=c(_,p(b),u(b,y,C),this.k[o],n[o]),k=s(f(r),d(r,i,g));_=C,C=y,y=b,b=s(m,w),m=g,g=i,i=r,r=s(w,k)}this.h[0]=s(this.h[0],r),this.h[1]=s(this.h[1],i),this.h[2]=s(this.h[2],g),this.h[3]=s(this.h[3],m),this.h[4]=s(this.h[4],b),this.h[5]=s(this.h[5],y),this.h[6]=s(this.h[6],C),this.h[7]=s(this.h[7],_)},b.prototype._digest=function(e){return"hex"===e?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},6225:(e,t,n)=>{"use strict";var o=n(7426).rotr32;function r(e,t,n){return e&t^~e&n}function i(e,t,n){return e&t^e&n^t&n}function a(e,t,n){return e^t^n}t.ft_1=function(e,t,n,o){return 0===e?r(t,n,o):1===e||3===e?a(t,n,o):2===e?i(t,n,o):void 0},t.ch32=r,t.maj32=i,t.p32=a,t.s0_256=function(e){return o(e,2)^o(e,13)^o(e,22)},t.s1_256=function(e){return o(e,6)^o(e,11)^o(e,25)},t.g0_256=function(e){return o(e,7)^o(e,18)^e>>>3},t.g1_256=function(e){return o(e,17)^o(e,19)^e>>>10}},7426:(e,t,n)=>{"use strict";var o=n(3349),r=n(6698);function i(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function a(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function s(e){return 1===e.length?"0"+e:e}function l(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=r,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}else for(var o=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?n[o++]=a:a<2048?(n[o++]=a>>6|192,n[o++]=63&a|128):i(e,r)?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),n[o++]=a>>18|240,n[o++]=a>>12&63|128,n[o++]=a>>6&63|128,n[o++]=63&a|128):(n[o++]=a>>12|224,n[o++]=a>>6&63|128,n[o++]=63&a|128)}else for(r=0;r<e.length;r++)n[r]=0|e[r];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=s(e[n].toString(16));return t},t.htonl=a,t.toHex32=function(e,t){for(var n="",o=0;o<e.length;o++){var r=e[o];"little"===t&&(r=a(r)),n+=l(r.toString(16))}return n},t.zero2=s,t.zero8=l,t.join32=function(e,t,n,r){var i=n-t;o(i%4==0);for(var a=new Array(i/4),s=0,l=t;s<a.length;s++,l+=4){var c;c="big"===r?e[l]<<24|e[l+1]<<16|e[l+2]<<8|e[l+3]:e[l+3]<<24|e[l+2]<<16|e[l+1]<<8|e[l],a[s]=c>>>0}return a},t.split32=function(e,t){for(var n=new Array(4*e.length),o=0,r=0;o<e.length;o++,r+=4){var i=e[o];"big"===t?(n[r]=i>>>24,n[r+1]=i>>>16&255,n[r+2]=i>>>8&255,n[r+3]=255&i):(n[r+3]=i>>>24,n[r+2]=i>>>16&255,n[r+1]=i>>>8&255,n[r]=255&i)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,o){return e+t+n+o>>>0},t.sum32_5=function(e,t,n,o,r){return e+t+n+o+r>>>0},t.sum64=function(e,t,n,o){var r=e[t],i=o+e[t+1]>>>0,a=(i<o?1:0)+n+r;e[t]=a>>>0,e[t+1]=i},t.sum64_hi=function(e,t,n,o){return(t+o>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,o){return t+o>>>0},t.sum64_4_hi=function(e,t,n,o,r,i,a,s){var l=0,c=t;return l+=(c=c+o>>>0)<t?1:0,l+=(c=c+i>>>0)<i?1:0,e+n+r+a+(l+=(c=c+s>>>0)<s?1:0)>>>0},t.sum64_4_lo=function(e,t,n,o,r,i,a,s){return t+o+i+s>>>0},t.sum64_5_hi=function(e,t,n,o,r,i,a,s,l,c){var u=0,d=t;return u+=(d=d+o>>>0)<t?1:0,u+=(d=d+i>>>0)<i?1:0,u+=(d=d+s>>>0)<s?1:0,e+n+r+a+l+(u+=(d=d+c>>>0)<c?1:0)>>>0},t.sum64_5_lo=function(e,t,n,o,r,i,a,s,l,c){return t+o+i+s+c>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},6698:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},3349:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},6585:e=>{var t=1e3,n=60*t,o=60*n,r=24*o,i=7*r;function a(e,t,n,o){var r=t>=1.5*n;return Math.round(e/n)+" "+o+(r?"s":"")}e.exports=function(e,s){s=s||{};var l,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return s*i;case"days":case"day":case"d":return s*r;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&isFinite(e))return s.long?(l=e,(c=Math.abs(l))>=r?a(l,c,r,"day"):c>=o?a(l,c,o,"hour"):c>=n?a(l,c,n,"minute"):c>=t?a(l,c,t,"second"):l+" ms"):function(e){var i=Math.abs(e);return i>=r?Math.round(e/r)+"d":i>=o?Math.round(e/o)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4994:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.blocks;(0,e.registerBlockBindingsSource)({name:"remote-data/binding",label:"Remote Data Binding",usesContext:["remote-data-blocks/remoteData"],getValues:()=>({})});const t=window.wp.hooks;function o(e){var t,n;return null!==(n=null===(t=r(e))||void 0===t?void 0:t.availableBindings)&&void 0!==n?n:{}}function r(e){var t,n;return null===(n=null===(t=window.REMOTE_DATA_BLOCKS)||void 0===t?void 0:t.config)||void 0===n?void 0:n[e]}function i(e){var t,n;return e&&null!==(n=null===(t=r(e))||void 0===t?void 0:t.dataSourceType)&&void 0!==n?n:""}function a(){var e,t;return null!==(t=null===(e=window.REMOTE_DATA_BLOCKS)||void 0===e?void 0:e.config)&&void 0!==t?t:{}}function s(e,t){return function(...e){return e.filter(Boolean).join(" ")}(t,`rdb-${n=e,n.replace(/[^a-zA-Z\d\u00C0-\u00FF]/g,"-").toLowerCase()}`);var n}const l=["core/button","core/heading","core/image","core/paragraph"],c="display",u="remote-data-blocks/remoteData",d=null!==(p=null===(f=window.REMOTE_DATA_BLOCKS)||void 0===f?void 0:f.rest_url)&&void 0!==p?p:"http://127.0.0.1:9999";var f,p;s("container");const v="ui:search_input",h=["button_text"],g=["button_url"],m=["html"],b=["id","id:list"],y=["image_alt"],C=["image_url"],_=["currency_in_current_locale","email_address","integer","markdown","number","string","title"],w=window.ReactJSXRuntime,k=window.wp.blockEditor,j=window.wp.components,F=window.wp.compose,x=window.wp.i18n;var O=n(7833);const S=n.n(O)()("calypso:analytics");let P;n(2287);let E=null;"undefined"!=typeof window&&window.addEventListener("popstate",(function(){E=null}));var B=n(9545);const I=["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI","SK","GB","CH","IS","LI","NO"],L=["california","colorado","connecticut","utah","virginia","texas","tennessee","oregon","new jersey","montana","iowa","indiana","delaware"],N="sensitive_pixel_option",A="sensitive_pixel_options",T={ok:!1,buckets:{essential:!0,analytics:!1,advertising:!1}},M={ok:!1,buckets:{essential:!0,analytics:!0,advertising:!1}},D={ok:!0,buckets:{essential:!0,analytics:!0,advertising:!0}},R=(e,t,n=T)=>{const{ok:o,buckets:r}=e?JSON.parse(e):{};return"boolean"==typeof o?{ok:o,buckets:{...n.buckets,...r}}:t&&["yes","no"].includes(t)?{ok:"yes"===t,buckets:D.buckets}:n};var q=n(7007),z=n(1050);const H=["calypso","jetpack","remotedatablocks","wpcom_dsp_widget"],$=["a8c_cookie_banner_ok","a8c_cookie_banner_view","a8c_ccpa_optout","wcadmin_storeprofiler_create_jetpack_account","wcadmin_storeprofiler_connect_store","wcadmin_storeprofiler_login_jetpack_account","wcadmin_storeprofiler_payment_login","wcadmin_storeprofiler_payment_create_account","calypso_checkout_switch_to_p_24","calypso_checkout_composite_p24_submit_clicked","wpcom_launchbar_button_click","wpcom_support_free_migration_request_click"];let U,K=Promise.resolve();"undefined"!=typeof document&&(K=(0,z.k0)("//stats.wp.com/w.js?67"));const G=new q.EventEmitter;function V(e,t){t=t||{};const n=P;n?.localeSlug&&(t.user_lang=n.localeSlug);const o=function(){if("undefined"==typeof document)return D;const e=B.parse(document.cookie),t="unknown"===(n=e.country_code)||void 0!==n&&I.includes(n);var n;const o=function(e,t){return"US"===e&&("unknown"===t||void 0!==t&&L.includes(t.toLowerCase()))}(e.country_code,e.region);if(!t&&!o)return D;const r=t?M:D,{ok:i,buckets:a}=R(e[A],e[N],r);return o?{ok:i,buckets:{...D.buckets,advertising:a.advertising}}:{ok:i,buckets:a}}();if(o?.buckets.analytics)if(S('Record event "%s" called with props %o',e,t),function(e){return H.some((t=>e.startsWith(`${t}_`)))}(e)||$.includes(e)){if(U){const e=U(t);t={...t,...e}}t=Object.fromEntries(Object.entries(t).filter((([,e])=>void 0!==e))),S('Recording event "%s" with actual props %o',e,t),r=["recordEvent",e,t],"undefined"!=typeof window&&(window._tkq=window._tkq||[],window._tkq.push(r)),G.emit("record-event",e,t)}else S("- Event name must be prefixed by a known source or added to `EVENT_NAME_EXCEPTIONS`");else S('Analytics has been disabled - Ignoring event "%s" with actual props %o',e,t);var r}const J="remotedatablocks_";function Q(e,t){const n=function(){var e;return null===(e=window.REMOTE_DATA_BLOCKS)||void 0===e?void 0:e.tracks_global_properties}();n&&"local"!==n.vip_env&&V(`${J}${e}`,Object.assign(Object.assign({},n),t))}function Z(e){const{availableBindings:t,fieldTypes:n,label:o,target:r,updateFieldBinding:i,value:a}=e,s=Object.entries(t).filter((([e,t])=>n.includes(t.type))).map((([e,t])=>({label:t.name,value:e})));return(0,w.jsx)(j.SelectControl,{label:o,name:r,options:[{label:"Select a field",value:""},...s],onChange:e=>i(r,e),value:a})}function W(e){var t,n,o,r,a,s,l,c,u,d,f,p,v,b,k,F,x,O,S,P,E,_x,B,I;const{attributes:L,availableBindings:N,blockName:A,remoteDataName:T,removeBinding:M,updateBinding:D}=e,R=null===(o=null===(n=null===(t=L.metadata)||void 0===t?void 0:t.bindings)||void 0===n?void 0:n.content)||void 0===o?void 0:o.args,q=null!==(r=null==R?void 0:R.field)&&void 0!==r?r:"",z=null!==(u=null===(c=null===(l=null===(s=null===(a=L.metadata)||void 0===a?void 0:a.bindings)||void 0===s?void 0:s.alt)||void 0===l?void 0:l.args)||void 0===c?void 0:c.field)&&void 0!==u?u:"",H=null!==(b=null===(v=null===(p=null===(f=null===(d=L.metadata)||void 0===d?void 0:d.bindings)||void 0===f?void 0:f.url)||void 0===p?void 0:p.args)||void 0===v?void 0:v.field)&&void 0!==b?b:"",$=null!==(S=null===(O=null===(x=null===(F=null===(k=L.metadata)||void 0===k?void 0:k.bindings)||void 0===F?void 0:F.url)||void 0===x?void 0:x.args)||void 0===O?void 0:O.field)&&void 0!==S?S:"",U=null!==(I=null===(B=null===(_x=null===(E=null===(P=L.metadata)||void 0===P?void 0:P.bindings)||void 0===E?void 0:E.text)||void 0===_x?void 0:_x.args)||void 0===B?void 0:B.field)&&void 0!==I?I:"";function K(e,t){var n,o,r,a;if(!t)return M(e),void Q("remote_data_container_actions",{action:"remove_binding",data_source_type:i(T),block_target_attribute:e});const s=null!==(a=null===(r=null===(o=null===(n=L.metadata)||void 0===n?void 0:n.bindings)||void 0===o?void 0:o[e])||void 0===r?void 0:r.args)&&void 0!==a?a:{};D(e,Object.assign(Object.assign({},s),{field:t})),Q("remote_data_container_actions",{action:"update_binding",data_source_type:i(T),remote_data_field:t,block_target_attribute:e})}switch(A){case"core/heading":case"core/paragraph":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Z,{availableBindings:N,fieldTypes:_,label:"Content",target:"content",updateFieldBinding:K,value:q}),(0,w.jsx)(j.CheckboxControl,{checked:Boolean(null==R?void 0:R.label),disabled:!q,label:"Show label",name:"show_label",onChange:function(e){var t,n;if(!q)return;const o=e?null===(n=null===(t=Object.entries(N).find((([e])=>e===q)))||void 0===t?void 0:t[1])||void 0===n?void 0:n.name:void 0;D("content",Object.assign(Object.assign({},R),{field:q,label:o})),Q("remote_data_container_actions",{action:e?"show_label":"hide_label",data_source_type:i(T)})}})]});case"core/image":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Z,{availableBindings:N,fieldTypes:C,label:"Image URL",target:"url",updateFieldBinding:K,value:H}),(0,w.jsx)(Z,{availableBindings:N,fieldTypes:y,label:"Image alt text",target:"alt",updateFieldBinding:K,value:z})]});case"core/button":return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Z,{availableBindings:N,fieldTypes:g,label:"Button URL",target:"url",updateFieldBinding:K,value:$}),(0,w.jsx)(Z,{availableBindings:N,fieldTypes:h,label:"Button Text",target:"text",updateFieldBinding:K,value:U})]});case"remote-data-blocks/remote-html":return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(Z,{availableBindings:N,fieldTypes:m,label:"Raw HTML",target:"content",updateFieldBinding:K,value:q})})}return null}const X="remote-data/binding",Y=window.wp.data,ee=window.wp.editor;var te=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};function ne(e){return e.map((e=>Object.fromEntries(Object.entries(e.result).map((([e,t])=>[e,t.value])))))}function oe(e,t,n=""){var o,r,i;return null!==(i=null===(r=null===(o=null==e?void 0:e.result[t])||void 0===o?void 0:o.value)||void 0===r?void 0:r.toString())&&void 0!==i?i:n}function re(e){var t;if(!e)return;const{queryInput:n,results:o}=e,r=te(e,["queryInput","results"]),i=null==o?void 0:o.map(((e,t)=>{var n;const o=null!==(n=e.result)&&void 0!==n?n:{};return function(e){return Object.prototype.hasOwnProperty.call(e,"result")&&Object.prototype.hasOwnProperty.call(e,"uuid")}(e)?e:(r=o,i=`${t}`,{result:Object.fromEntries(Object.entries(r).map((([e,t])=>[e,{name:e,type:"string",value:t}]))),uuid:i});var r,i}));return Object.assign(Object.assign({},r),{queryInputs:null!==(t=e.queryInputs)&&void 0!==t?t:n?[n]:[{}],results:i})}function ie(t,n,o){var r;const i=null===(r=t.innerBlocks)||void 0===r?void 0:r.map((e=>ie(e,n,o))),a=ce(t.attributes,[n],o);return(0,e.cloneBlock)(t,a,i)}function ae(e,t){var n;if(!(null==t?void 0:t.field)||!(null===(n=null==e?void 0:e.result)||void 0===n?void 0:n[t.field]))return null;let o=oe(e,t.field);return t.label&&(o=`<span class="${s("block-label")}">${t.label}</span> ${o}`),o}function se(e,t){var n,o;return Object.entries(null!==(o=null===(n=e.metadata)||void 0===n?void 0:n.bindings)&&void 0!==o?o:{}).filter((([e,n])=>{var o;return n.source===X&&(null===(o=n.args)||void 0===o?void 0:o.block)===t}))}function le(e,t){var n;const o=(null!==(n=e.className)&&void 0!==n?n:"").split(/\s/).filter((e=>!e.startsWith("rdb-block-data-"))),r=new Set([...o,...se(e,t).map((([e,t])=>s(`block-data-${t.args.field}`)))]);return Array.from(r.values()).filter(Boolean).join(" ")}function ce(e,t,n,o=0){return Object.fromEntries(se(e,n).map((([e,n])=>[e,ae(t[o],n.args)])).filter((([t,n])=>null!==n&&n!==function(e,t){var n,o,r;return!t||"object"!=typeof(r=e)||null===r||Array.isArray(r)?"":null!==(o=null===(n=e[t])||void 0===n?void 0:n.toString())&&void 0!==o?o:""}(e,t))))}function ue(e,t){var n,o;return se(e.attributes,t).length>0||null!==(o=null===(n=e.innerBlocks)||void 0===n?void 0:n.some((e=>ue(e,t))))&&void 0!==o&&o}function de(e){var t,n;const{attributes:o,availableBindings:r,blockName:i,remoteDataName:a,remoteDataTitle:s,setAttributes:l}=e,c=null!==(n=null===(t=o.metadata)||void 0===t?void 0:t.bindings)&&void 0!==n?n:{};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(k.InspectorControls,{children:(0,w.jsx)(j.PanelBody,{title:(0,x.sprintf)((0,x.__)("Remote Data Block: %s","remote-data-blocks"),s),children:(0,w.jsx)(W,{attributes:o,availableBindings:r,blockName:i,remoteDataName:a,removeBinding:function(e){const t=c,n=e,r=(t[n],function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(t,["symbol"==typeof n?n:n+""]));l({metadata:Object.assign(Object.assign({},o.metadata),{bindings:r,name:void 0})})},updateBinding:function(e,t){var n,i;l({className:le(o,a),metadata:Object.assign(Object.assign({},o.metadata),{bindings:Object.assign(Object.assign({},null===(n=o.metadata)||void 0===n?void 0:n.bindings),{[e]:{source:X,args:Object.assign(Object.assign({},t),{block:a})}}),name:null===(i=r[t.field])||void 0===i?void 0:i.name})})}})})}),e.children]})}const fe=(0,F.createHigherOrderComponent)((e=>t=>{var n,i,a,s;const{attributes:l,context:c,name:d,previewIndex:f=0,setAttributes:p}=t,{remoteData:v}=function(e){var t;const{postMeta:n,postType:o}=(i=e=>{var t,n;return{postMeta:null!==(t=e("meta"))&&void 0!==t?t:{},postType:null!==(n=e("type"))&&void 0!==n?n:""}},(0,Y.useSelect)((e=>{const{getEditedPostAttribute:t}=e(ee.store);return i(t)}),[]));var i;if("wp_block"===o){const e=String(null!==(t=n._remote_data_blocks_block_type)&&void 0!==t?t:""),o=r(e);if(o)return{remoteData:{blockName:e,metadata:{},queryInputs:[],queryKey:"Example Query Key",resultId:"",results:[{result:Object.fromEntries(Object.entries(o.availableBindings).map((([e,t])=>[e,{name:t.name,type:t.type,value:t.name}]))),uuid:"Example Entity ID"}]}}}return{remoteData:e[u]}}(c),h=o(null!==(n=null==v?void 0:v.blockName)&&void 0!==n?n:""),g=Boolean(Object.keys(h).length);if(!v||!g)return(0,w.jsx)(e,Object.assign({},t));const m=c["pattern/overrides"],b=Boolean(m),y=Object.values(null!==(a=null===(i=l.metadata)||void 0===i?void 0:i.bindings)&&void 0!==a?a:{}).some((e=>"core/pattern-overrides"===e.source)),C=Object.assign(Object.assign({},l),ce(l,v.results,v.blockName,f));if(b&&!y)return(0,w.jsx)(e,Object.assign({},t,{attributes:C}));const _=function(e){var t,n,o;return e?null!==(o=null===(n=null===(t=r(e))||void 0===t?void 0:t.settings)||void 0===n?void 0:n.title)&&void 0!==o?o:e.replace("remote-data-blocks/",""):""}(null==v?void 0:v.blockName);return(0,w.jsx)(de,{attributes:C,availableBindings:h,blockName:d,remoteDataName:null!==(s=null==v?void 0:v.blockName)&&void 0!==s?s:"",remoteDataTitle:_,setAttributes:p,children:(0,w.jsx)(e,Object.assign({},t,{attributes:C}))})}),"withBlockBinding");(0,t.addFilter)("blocks.registerBlockType","remote-data-blocks/withBlockBinding",(function(e){var t;return Object.assign(Object.assign({},e),{edit:fe(null!==(t=e.edit)&&void 0!==t?t:()=>null)})}),5),(0,t.addFilter)("blocks.registerBlockType","remote-data-blocks/addUsesContext",(function(e,t){if(!l.includes(t))return e;const{usesContext:n=[]}=e;return(null==n?void 0:n.includes(u))?e:Object.assign(Object.assign({},e),{usesContext:[...n,u]})}),10);const pe=window.wp.richText,ve=window.wp.element,he=window.wp.primitives,ge=(0,w.jsx)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,w.jsx)(he.Path,{d:"M10.8622 8.04053L14.2805 12.0286L10.8622 16.0167L9.72327 15.0405L12.3049 12.0286L9.72327 9.01672L10.8622 8.04053Z"})}),me=(0,w.jsx)(he.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,w.jsx)(he.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),be=window.wp.apiFetch;var ye,Ce=n.n(be);!function(e){e.MissingRequiredInput="missing_required_input"}(ye||(ye={}));class _e extends Error{constructor(e,t,n){super(e),this.type=t,this.affectedInputVariables=n}}function we(e,t){const n=t.filter((e=>e.required)).filter((t=>{var n;return null===(null!==(n=e[t.slug])&&void 0!==n?n:null)}));if(n.length)throw new _e("Missing required query input variables",ye.MissingRequiredInput,n);return!0}var ke=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},je=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};class Fe extends Error{constructor(e,t){super(e),this.cause=t}}const xe=function(){const e=new Map,t=e=>{try{return JSON.stringify(e)}catch(t){return String(e)}};return(...n)=>{const o=Array.from(n).map(t).join(",");if(e.has(o))return e.get(o);const r=function(e){return ke(this,void 0,void 0,(function*(){const{body:t}=yield Ce()({url:d,method:"POST",data:e});return t?{blockName:t.block_name,metadata:t.metadata,pagination:t.pagination,queryKey:t.query_key,queryInputs:t.query_inputs,resultId:t.result_id,results:t.results}:null}))}(...n);return r instanceof Promise?r.then((()=>(e.set(o,r),r))):(e.set(o,r),r)}}();function Oe({blockName:e,externallyManagedRemoteData:t,externallyManagedUpdateRemoteData:n,fetchOnMount:o=!1,initialPage:i,initialPerPage:a,initialSearchInput:s,onSuccess:l,queryKey:c}){var u,d;const[f,p]=(0,ve.useState)(),[h,g]=(0,ve.useState)(),[m,b]=(0,ve.useState)(!1),y=null!=t?t:f,C=null!=n?n:p,_=Boolean(y),w=r(e),k=null===(u=null==w?void 0:w.selectors)||void 0===u?void 0:u.find((e=>e.query_key===c));if(!k)throw new Error(`Query not found for block "${e}" and key "${c}".`);const j=null!==(d=null==t?void 0:t.enabledOverrides)&&void 0!==d?d:[],F=k.inputs,x=function({initialPage:e=1,initialPerPage:t,paginationData:n}){var o,r,i,a,s,l;const[c,u]=(0,ve.useState)(e),[d,f]=(0,ve.useState)(null!=t?t:null),[p,v]=(0,ve.useState)(),h=null===(o=null==n?void 0:n.input_variables)||void 0===o?void 0:o.next_page,g=null===(r=null==n?void 0:n.input_variables)||void 0===r?void 0:r.previous_page,m=null===(i=null==n?void 0:n.input_variable_targets)||void 0===i?void 0:i.offset,b=null===(a=null==n?void 0:n.input_variable_targets)||void 0===a?void 0:a.page,y=null===(s=null==n?void 0:n.input_variable_targets)||void 0===s?void 0:s.per_page,C=null!==(l=null!=d?d:null==n?void 0:n.per_page)&&void 0!==l?l:10,_=Boolean(h),w=Boolean((null==n?void 0:n.type)&&"NONE"!==(null==n?void 0:n.type)),k=null==n?void 0:n.total_items,j=k?Math.ceil(k/C):void 0;return{hasNextPage:_,page:c,paginationQueryInput:p,perPage:null!=d?d:null==n?void 0:n.per_page,setPage:function(e){if(!w)return;const t=e>c,o=e<c&&e>0,r=t?Math.min(null!=j?j:c+1,e):Math.max(1,e);if(t||o)switch(null==n?void 0:n.type){case"CURSOR":case"CURSOR_SIMPLE":if(t){u(c+1),v(h);break}u(c-1),v(g);break;case"OFFSET":if(!m)break;if(u(r),t){v(Object.assign(Object.assign({},h),{[m]:C*(r-1)}));break}v(Object.assign(Object.assign({},g),{[m]:C*(r-1)}));break;case"PAGE":if(!b)break;if(u(r),t){v(Object.assign(Object.assign({},h),{[b]:r}));break}v(Object.assign(Object.assign({},g),{[b]:r}))}},setPerPage:function(e){y&&C!==e&&(f(e),v(Object.assign(Object.assign({},p),{[y]:e})))},supportsPagination:w,supportsPerPage:Boolean(y),totalItems:k,totalPages:j}}({initialPage:i,initialPerPage:a,paginationData:null==y?void 0:y.pagination}),{hasNextPage:O,page:S,perPage:P,paginationQueryInput:E,supportsPagination:B,totalItems:I,totalPages:L}=x,N=je(x,["hasNextPage","page","perPage","paginationQueryInput","supportsPagination","totalItems","totalPages"]),{hasSearchInput:A,searchQueryInput:T,searchInput:M,setSearchInput:D,supportsSearch:R}=function({initialSearchInput:e="",inputVariables:t,searchInputDelayInMs:n=500}){var o;const[r,i]=function(e,t){const n=(0,ve.useRef)(null),[o,r]=(0,ve.useState)(t);return[o,(0,ve.useCallback)((t=>{n.current&&clearTimeout(n.current),n.current=setTimeout((()=>{r(t)}),e)}),[])]}(n,e),a=null==t?void 0:t.find((e=>e.type===v)),s=Boolean(a),l=s&&!(null==a?void 0:a.required),c=s&&Boolean(r||l);return{hasSearchInput:c,searchInput:r,searchQueryInput:s?{[null!==(o=null==a?void 0:a.slug)&&void 0!==o?o:""]:c?r:null}:{},setSearchInput:s?i:()=>{},supportsSearch:s}}({initialSearchInput:s,inputVariables:F}),q=Object.assign(Object.assign({},E),T),z=!h&&(_||A),H=_&&R&&!A;function $(t){return ke(this,void 0,void 0,(function*(){if(0===t.length)return C(void 0),void g(new Fe("Query input is empty",t));1===t.length&&(t[0]=Object.assign(Object.assign({},t[0]),q));const n={block_name:e,query_key:c,query_inputs:t};try{t.forEach((e=>we(e,F)))}catch(e){return C(void 0),void g(new Fe("Query input is invalid",e))}b(!0);const o=yield xe(n).catch((e=>(g(new Fe("Request for remote data failed",e)),null)));if(!o)return C(void 0),void b(!1);C(Object.assign({enabledOverrides:j},o)),b(!1),null==l||l()}))}return(0,ve.useEffect)((()=>{var e;H?C(void 0):z&&$(null!==(e=null==y?void 0:y.queryInputs)&&void 0!==e?e:[{}])}),[H,z,S,P,M]),(0,ve.useEffect)((()=>{o&&function(e,t){try{return we(e,t),!0}catch(e){return!1}}(q,F)&&$([{}])}),[]),Object.assign({data:y,error:h,fetch:$,hasNextPage:null!=O?O:L?S<L:B,hasPreviousPage:S>1,loading:m,page:S,perPage:P,reset:function(){C(void 0),g(void 0),b(!1)},searchInput:M,setSearchInput:D,supportsPagination:B,supportsSearch:R,totalPages:L},N)}function Se(e){return(0,w.jsx)(w.Fragment,{children:Object.entries(e.fields).map((([t,n],o)=>{var r;const i={action:"add_field_shortcode",selectedField:t,remoteData:e.remoteData,type:e.fieldType,selectionPath:"select_new_tab"};return(0,w.jsx)(j.MenuItem,{className:"remote-data-blocks-inline-field",onClick:t=>{t.preventDefault(),e.onSelectField(i,n.value)},onKeyDown:t=>{"enter"===t.key.toLowerCase()&&e.onSelectField(i,n.value)},suffix:e.selectedField===t?(0,w.jsx)(j.Icon,{icon:me,size:24,style:{color:"#4ab866"}}):void 0,children:(0,w.jsxs)(j.BaseControl,{className:"remote-data-blocks-inline-field-choice",__nextHasNoMarginBottom:!0,children:[(0,w.jsxs)(j.BaseControl.VisualLabel,{style:{marginBottom:0,whiteSpace:"normal"},children:[n.name,":"]}),null===(r=n.value)||void 0===r?void 0:r.toString()]})},o)}))})}function Pe(e){const t=o(e.remoteData.blockName),n=Object.entries(t).reduce(((t,[n,o])=>{const r=oe(e.remoteData.results[0],n);return r&&_.includes(o.type)?Object.assign(Object.assign({},t),{[n]:{name:o.name,value:r}}):t}),{});return(0,w.jsx)(Se,Object.assign({},e,{fields:n,fieldType:"field"}))}function Ee(e){var t;const n=Object.fromEntries(Object.entries(null!==(t=e.remoteData.metadata)&&void 0!==t?t:{}).map((([e,t])=>{var n,o;return[e,{name:t.name,value:null!==(o=null===(n=t.value)||void 0===n?void 0:n.toString())&&void 0!==o?o:""}]})));return(0,w.jsx)(Se,Object.assign({},e,{fields:n,fieldType:"meta"}))}function Be(e){const{data:t,fetch:n,loading:o}=Oe({blockName:e.blockName,queryKey:c});if((0,ve.useEffect)((()=>{o||t||n(e.queryInputs)}),[o,t]),!t||o)return(0,w.jsx)(j.Spinner,{});const r={onSelectField:e.onSelectField,remoteData:t,selectedField:e.selectedField};return"meta"===e.fieldType?(0,w.jsx)(Ee,Object.assign({},r)):(0,w.jsx)(Pe,Object.assign({},r))}function Ie(e){const t=a(),{remoteData:n}=e;return n.length>0?(0,w.jsx)(j.DropdownMenu,{icon:ge,label:"",text:(0,x.__)("Existing items","remote-data-blocks"),popoverProps:{className:"remote-data-blocks-field-shortcode-dropdown remote-data-blocks-select-existing",placement:"right-start",offset:0},children:()=>n.map((n=>{var o,r;return(0,w.jsx)(j.MenuGroup,{label:null!==(r=null===(o=t[n.blockName])||void 0===o?void 0:o.settings.title)&&void 0!==r?r:n.blockName,children:(0,w.jsx)(Pe,{onSelectField:(t,n)=>e.onSelectField(Object.assign(Object.assign({},t),{selectionPath:"select_existing_tab"}),n),remoteData:n})},n.blockName)}))}):void 0}function Le(e){var t,n;const o=(0,pe.useAnchor)({editableContentElement:e.contentRef.current,settings:e.formatTypeSettings}),{remoteData:r,selectedField:i,type:a}=e.fieldSelection;return(0,w.jsx)(j.Popover,{placement:"bottom-start",anchor:o,className:"block-editor-format-toolbar__image-popover",noArrow:!1,offset:8,onClose:e.onClose,focusOnMount:"firstElement",children:(0,w.jsxs)(j.Card,{style:{width:"24rem"},children:[(0,w.jsx)(j.CardHeader,{children:(0,w.jsx)(j.__experimentalHeading,{level:4,children:(0,x.__)("Select a field to bind","remote-data-blocks")})}),(0,w.jsx)(j.CardBody,{children:(0,w.jsx)(Be,{blockName:null!==(t=null==r?void 0:r.blockName)&&void 0!==t?t:"Remote Data Block",fieldType:null!=a?a:"field",onSelectField:(t,n)=>e.onSelectField(Object.assign(Object.assign({},t),{action:"update_field_shortcode"}),n),queryInputs:null!==(n=null==r?void 0:r.queryInputs)&&void 0!==n?n:[{}],selectedField:i})}),(0,w.jsx)(j.CardFooter,{children:(0,w.jsx)(j.Button,{onClick:()=>e.resetField(null==r?void 0:r.blockName),isDestructive:!0,children:(0,x.__)("Reset field","remote-data-blocks")})})]})})}function Ne(){const{getBlocksByName:e,getBlocksByClientId:t}=(0,Y.useSelect)(k.store,[]);return Object.keys(a()).flatMap((n=>e(n).map((e=>{var n;const o=t(e)[0];return re(null===(n=null==o?void 0:o.attributes)||void 0===n?void 0:n.remoteData)})).filter((e=>Boolean(e)))))}function Ae(e){const t=a(),n=Ne();return n.length>0?(0,w.jsx)(j.DropdownMenu,{icon:ge,label:"",text:(0,x.__)("Query metadata","remote-data-blocks"),popoverProps:{className:"remote-data-blocks-field-shortcode-dropdown remote-data-blocks-select-meta",placement:"right-start",offset:0},children:()=>n.map((n=>{var o,r;return(0,w.jsx)(j.MenuGroup,{label:null!==(r=null===(o=t[n.blockName])||void 0===o?void 0:o.settings.title)&&void 0!==r?r:n.blockName,children:(0,w.jsx)(Ee,{onSelectField:(t,n)=>e.onSelectField(Object.assign(Object.assign({},t),{selectionPath:"select_meta_tab"}),n),remoteData:n})},n.blockName)}))}):void 0}function Te(e){const{blockName:t,field:n,item:o,mediaField:r,onSelectField:i}=e,a=oe(o,n);if(n===r){const e=function(e,t,n=""){var o,r,i;return null!==(i=null===(r=null===(o=Object.values(e.result).find((e=>e.type===t)))||void 0===o?void 0:o.value)||void 0===r?void 0:r.toString())&&void 0!==i?i:n}(o,"image_alt");return(0,w.jsx)("img",{alt:e,src:a})}return i?(0,w.jsx)(j.Button,{onClick:()=>{i(function(e,t,n){return{action:"add_field_shortcode",remoteData:{blockName:n,queryInputs:ne([t]),metadata:{}},selectedField:e,selectionPath:"select_new_tab",type:"field"}}(n,o,t),a)},variant:"link",children:a}):a}function Me(t,n=""){var o;const{patterns:i}=null!==(o=r(t))&&void 0!==o?o:{},{replaceInnerBlocks:a}=(0,Y.useDispatch)(k.store),{getPatternsByBlockTypes:s,allowedPatterns:l}=(0,Y.useSelect)((e=>{var t;const o=e(k.store);return{getBlocks:o.getBlocks,getPatternsByBlockTypes:o.getPatternsByBlockTypes,allowedPatterns:null!==(t=o.__experimentalGetAllowedPatterns(n))&&void 0!==t?t:[]}}),[t,n]),c=s(t);const u={defaultPattern:c.find((({name:e})=>e===(null==i?void 0:i.default))),getSupportedPatterns:e=>{const n=l.filter((e=>{var n;return(null===(n=null==e?void 0:e.blockTypes)||void 0===n?void 0:n.includes(t))||e.blocks.some((e=>ue(e,t)))}));return e?n.map((n=>Object.assign(Object.assign({},n),{blocks:n.blocks.map((n=>ie(n,e,t)))}))):n},innerBlocksPattern:c.find((({name:e})=>e===(null==i?void 0:i.inner_blocks))),insertPatternBlocks:function(o,r=!1){const i=function(n){var o;if(function(e){return Boolean(e.id&&"unsynced"!==e.syncStatus)}(n)){const t=(0,e.createBlock)("core/block",{ref:n.id});return[(0,e.createBlock)("remote-data-blocks/template",{},[t])]}const r=null!==(o=n.blocks.map((n=>se(n.attributes,t).length?(0,e.cloneBlock)(n):n)))&&void 0!==o?o:[];return[(0,e.createBlock)("remote-data-blocks/template",{},r)]}(o);r&&i.push((0,e.createBlock)("remote-data-blocks/pagination")),a(n,i).catch((()=>{}))},resetInnerBlocks:()=>{a(n,[]).catch((()=>{}))}};return u}function De(e){var t,n,o,r;const{blockName:i,hasNextPage:a,loading:s,onSelect:l,onSelectField:c,page:u,perPage:d,results:f=[],searchInput:p,selectionIds:v,setPage:h,setPerPage:g,setSearchInput:m,setSelectionIds:y,supportsSearch:_,totalItems:k,totalPages:j}=e,{DataViews:F}=window.LockedPrivateDataViews,{defaultPattern:O}=Me(i),S=null!==(n=null===(t=null==f?void 0:f[0])||void 0===t?void 0:t.result)&&void 0!==n?n:{},P=Object.entries(S).filter((([e,t])=>!b.includes(t.type))).map((([e])=>e)),E=null===(o=Object.entries(S).find((([e,t])=>"title"===t.type)))||void 0===o?void 0:o[0],B=null===(r=Object.entries(S).find((([e,t])=>C.includes(t.type))))||void 0===r?void 0:r[0],I=P.map((e=>{var t,n;return{id:e,label:null!==(n=null===(t=S[e])||void 0===t?void 0:t.name)&&void 0!==n?n:e,enableGlobalSearch:!0,getValue:({item:t})=>oe(t,e),render:({item:t})=>(0,w.jsx)(Te,{blockName:i,field:e,item:t,mediaField:B,onSelectField:c}),enableSorting:e!==B}})),L=P.filter((e=>e!==B&&e!==E)),[N,A]=(0,ve.useState)({type:"table",perPage:null!=d?d:f.length,page:u,search:p,fields:L,filters:[],layout:{},titleField:E,mediaField:B});(0,ve.useEffect)((()=>{A((e=>Object.assign(Object.assign({},e),{fields:L,mediaField:B,titleField:E})))}),[[B,E,...L].join(";")]);const T=B?{table:{},grid:{}}:{table:{}},M={id:"choose",icon:(0,w.jsx)(w.Fragment,{children:(0,x.__)("Choose")}),isPrimary:!0,label:"",callback:e=>{null==l||l(e)},supportsBulk:!0};let D=[];return l&&(null==f?void 0:f.length)&&(D=[M]),(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(F,{actions:D,data:f,defaultLayouts:T,fields:I,getItemId:e=>e.uuid,isLoading:s||!O||!f,isItemClickable:()=>!0,onChangeSelection:y,onChangeView:function(e){var t,n,o,r;h(null!==(t=e.page)&&void 0!==t?t:1),g(null!==(o=null!==(n=e.perPage)&&void 0!==n?n:d)&&void 0!==o?o:f.length),m(null!==(r=e.search)&&void 0!==r?r:""),A(e)},paginationInfo:{totalItems:null!=k?k:f.length,totalPages:null!=j?j:a?u+1:Math.max(1,u)},search:_,selection:v,view:N})})}const Re=e=>{var t,n,o,a;const{className:s,blockName:l,onSelect:c,onSelectField:u,queryKey:d,renderTrigger:f,title:p}=e,v=r(l),[h,g]=(0,ve.useState)([]),m=h.length>1?(0,x.__)("items selected in total"):(0,x.__)("item selected in total"),{close:b,isOpen:y,open:C}=function(){const[e,t]=(0,ve.useState)(!1);return{close:function(){t(!1)},isOpen:e,open:function(){t(!0)}}}(),{data:_,hasNextPage:k,loading:F,page:O,searchInput:S,setPage:P,setPerPage:E,setSearchInput:B,supportsSearch:I,totalItems:L,totalPages:N}=Oe({blockName:l,fetchOnMount:!0,queryKey:d}),A=h.map((e=>e.uuid)),T=null!==(n=null===(t=null==_?void 0:_.results)||void 0===t?void 0:t.map((e=>e.uuid)))&&void 0!==n?n:[];function M(e){const t=A.filter((e=>!T.includes(e))),n=Array.from(new Set([...t,...e])).map((e=>{var t,n,o;return null!==(o=null!==(n=null===(t=null==_?void 0:_.results)||void 0===t?void 0:t.find((t=>e===t.uuid)))&&void 0!==n?n:h.find((t=>e===t.uuid)))&&void 0!==o?o:null})).filter((e=>null!==e));g(n)}function D(e){e.length&&(null==c||c(ne(e)),Q("add_block",{action:"select_item",selected_option:"search_from_list",data_source_type:i(l)}),b())}const R=f?f({onClick:C}):(0,w.jsx)(j.Button,{variant:"primary",onClick:C,children:(0,x.__)("Choose")});return(0,w.jsxs)(w.Fragment,{children:[R,y&&(0,w.jsxs)(j.Modal,{className:`${s} rdb-dataviews-bulk-actions-modal`,isFullScreen:!0,onRequestClose:b,title:null!==(a=null===(o=null==v?void 0:v.settings)||void 0===o?void 0:o.title)&&void 0!==a?a:p,children:[(0,w.jsx)(De,{blockName:l,hasNextPage:null!=k&&k,loading:F,onSelect:D,onSelectField:u,page:O,results:F||null==_?void 0:_.results,searchInput:S,selectionIds:A,setPage:P,setPerPage:E,setSearchInput:B,setSelectionIds:M,supportsSearch:I,totalItems:L,totalPages:N}),c&&!F&&(0,w.jsxs)(w.Fragment,{children:[h.length>1&&(0,w.jsx)(j.BaseControl,{className:"rdb-dataviews-bulk-actions-footer__item-count-total",__nextHasNoMarginBottom:!0,children:(0,w.jsxs)(j.BaseControl.VisualLabel,{style:{marginBottom:"0"},children:[h.length," ",m]})}),(0,w.jsxs)(j.__experimentalHStack,{className:"rdb-dataviews-bulk-actions-footer__selection-total",children:[(0,w.jsx)(j.Button,{disabled:0===h.length,onClick:()=>M([]),variant:"secondary",children:(0,x.__)("Cancel")}),(0,w.jsx)(j.Button,{disabled:0===h.length,onClick:()=>D(h),variant:"primary",children:(0,x.__)("Save")})]})]})]})]})};function qe(e){const{onSelectField:t}=e,n=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(e,["onSelectField"]),o=a(),r=Object.values(o).reduce(((e,t)=>{const n=t.dataSourceType;return e[n]||(e[n]=[]),e[n].push(t),e}),{});return(0,w.jsx)(j.DropdownMenu,Object.assign({icon:ge,label:"",text:(0,x.__)("Select an item","remote-data-blocks"),popoverProps:{className:"remote-data-blocks-field-shortcode-dropdown remote-data-blocks-select-new",placement:"right-start",offset:0}},n,{children:()=>Object.entries(r).map((([e,n])=>(0,w.jsx)(j.MenuGroup,{label:e,children:n.map((e=>{const n=e.selectors.find((e=>["list","search"].includes(e.type)));return n?(0,w.jsx)(Re,{blockName:e.name,headerImage:n.image_url,onSelectField:t,queryKey:n.query_key,renderTrigger:({onClick:t})=>{var n,o;return(0,w.jsx)(j.MenuItem,{onClick:t,children:null!==(o=null===(n=e.settings)||void 0===n?void 0:n.title)&&void 0!==o?o:e.name})}},e.name):null}))},e)))}))}const ze="remote-data-blocks/inline-field",He={attributes:{"data-query":"data-query"},className:null,contentEditable:!1,edit:()=>null,interactive:!0,name:ze,object:!1,tagName:"remote-data-blocks-inline-field",title:"Field Shortcode"};(0,pe.registerFormatType)("remote-data-blocks/field-shortcode",Object.assign(Object.assign({},He),{edit:function(e){const{onChange:t,onFocus:n,value:o,isObjectActive:r,activeObjectAttributes:a,contentRef:s}=e,l=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(null==a?void 0:a["data-query"]),[c,u]=(0,ve.useState)(!1);(0,ve.useEffect)((()=>{r&&u(!0)}),[r]);const d=(e,n)=>{const r={remoteData:null==e?void 0:e.remoteData,selectedField:null==e?void 0:e.selectedField,type:null==e?void 0:e.type},i={attributes:Object.assign(Object.assign({},a),{"data-query":e?JSON.stringify(r):""}),innerHTML:n,type:ze};t(Object.keys(a).length?Object.assign(Object.assign({},o),{replacements:o.replacements.map(((e,t)=>t===o.start?i:e))}):(0,pe.insertObject)(o,i))},f=(e,t)=>{var o;d(e,t),u(!1),n(),Q("field_shortcode",{action:e.action,data_source_type:i(null===(o=e.remoteData)||void 0===o?void 0:o.blockName),selection_path:e.selectionPath})},p=Ne();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(k.BlockControls,{children:(0,w.jsx)(j.ToolbarGroup,{children:p.length>0?(0,w.jsx)(j.ToolbarDropdownMenu,{className:"remote-data-blocks-select-new",icon:"shortcode",label:(0,x.__)("Select block bindings","remote-data-blocks"),popoverProps:{className:"rdb-field-shortcode_dropdown",offset:8},children:()=>(0,w.jsxs)(j.ToolbarGroup,{children:[(0,w.jsx)(qe,{onSelectField:f}),(0,w.jsx)(Ie,{onSelectField:f,remoteData:p}),(0,w.jsx)(Ae,{onSelectField:f})]})}):(0,w.jsx)(qe,{onSelectField:f,icon:"shortcode",label:(0,x.__)("Select block bindings","remote-data-blocks"),popoverProps:{offset:8,placement:"bottom-start"},text:void 0})})}),c&&l&&(0,w.jsx)(Le,{contentRef:s,fieldSelection:l,formatTypeSettings:He,onClose:()=>{u(!1),n()},onSelectField:(e,t)=>f(Object.assign(Object.assign({},e),{selectionPath:"popover"}),t),resetField:e=>{d(null,"Unbound field"),Q("field_shortcode",{action:"reset_field_shortcode",data_source_type:i(e)})}})]})}}))})()})();