(()=>{"use strict";const e=window.wp.blocks,t=window.wp.primitives,n=window.ReactJSXRuntime,o=(0,n.jsx)(t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(t.Path,{d:"m7.3 9.7 1.4 1.4c.2-.2.3-.3.4-.5 0 0 0-.1.1-.1.3-.5.4-1.1.3-1.6L12 7 9 4 7.2 6.5c-.6-.1-1.1 0-1.6.3 0 0-.1 0-.1.1-.3.1-.4.2-.6.4l1.4 1.4L4 11v1h1l2.3-2.3zM4 20h9v-1.5H4V20zm0-5.5V16h16v-1.5H4z"})}),r=JSON.parse('{"UU":"remote-data-blocks/template"}'),l=window.wp.blockEditor,i=window.wp.components,s=window.wp.i18n;function a(e,t){return function(...e){return e.filter(Boolean).join(" ")}(t,`rdb-${n=e,n.replace(/[^a-zA-Z\d\u00C0-\u00FF]/g,"-").toLowerCase()}`);var n}var c;null===(c=window.REMOTE_DATA_BLOCKS)||void 0===c||c.rest_url,a("container");const u="remote-data/binding",d=window.wp.data,v=window.wp.editor;function p(e){var t;const{postMeta:n,postType:o}=(r=e=>{var t,n;return{postMeta:null!==(t=e("meta"))&&void 0!==t?t:{},postType:null!==(n=e("type"))&&void 0!==n?n:""}},(0,d.useSelect)((e=>{const{getEditedPostAttribute:t}=e(v.store);return r(t)}),[]));var r;if("wp_block"===o){const e=String(null!==(t=n._remote_data_blocks_block_type)&&void 0!==t?t:""),o=function(e){var t,n;return null===(n=null===(t=window.REMOTE_DATA_BLOCKS)||void 0===t?void 0:t.config)||void 0===n?void 0:n[e]}(e);if(o)return{remoteData:{blockName:e,metadata:{},queryInputs:[],queryKey:"Example Query Key",resultId:"",results:[{result:Object.fromEntries(Object.entries(o.availableBindings).map((([e,t])=>[e,{name:t.name,type:t.type,value:t.name}]))),uuid:"Example Entity ID"}]}}}return{remoteData:e["remote-data-blocks/remoteData"]}}const w=window.wp.element,m=(0,w.memo)((function(e){const{blocks:t,isHidden:o=!1,onSelect:r}=e,i=(0,l.__experimentalUseBlockPreview)({blocks:t,props:{}}),s={cursor:"pointer",display:o?"none":void 0,listStyle:"none"};return(0,n.jsx)("li",Object.assign({},i,{onClick:r,onKeyDown:r,role:"button",style:s,tabIndex:0}))}));function b({isActive:e}){const t=(0,l.useInnerBlocksProps)();return e?(0,n.jsx)("li",Object.assign({},t)):null}const k=(0,w.createContext)(0);function f(e){const[t,o]=(0,w.useState)(0),{getInnerBlocks:r,remoteData:i}=e,{clientId:a}=(0,l.useBlockEditContext)();return(0,d.useSelect)((e=>e(l.store).getBlocksByClientId(a)),[a]),i.results.length?(0,n.jsx)("ul",{className:"remote-data-blocks-loop-template",children:i.results.map(((e,l)=>{const i=l===t;return(0,n.jsxs)(k.Provider,{value:l,children:[(0,n.jsx)(b,{isActive:i}),(0,n.jsx)(m,{blocks:r(e),isHidden:i,onSelect:()=>o(l)})]},l)}))}):(0,n.jsx)("p",{children:(0,s.__)("No results found.")})}function x(t,n,o){var r;const l=null===(r=t.innerBlocks)||void 0===r?void 0:r.map((e=>x(e,n,o))),i=function(e,t,n,o=0){return Object.fromEntries(function(e,t){var n,o;return Object.entries(null!==(o=null===(n=e.metadata)||void 0===n?void 0:n.bindings)&&void 0!==o?o:{}).filter((([e,n])=>{var o;return n.source===u&&(null===(o=n.args)||void 0===o?void 0:o.block)===t}))}(e,n).map((([e,n])=>[e,g(t[o],n.args)])).filter((([t,n])=>null!==n&&n!==function(e,t){var n,o;return t&&function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}(e)&&null!==(o=null===(n=e[t])||void 0===n?void 0:n.toString())&&void 0!==o?o:""}(e,t))))}(t.attributes,[n],o);return(0,e.cloneBlock)(t,i,l)}function g(e,t){var n;if(!(null==t?void 0:t.field)||!(null===(n=null==e?void 0:e.result)||void 0===n?void 0:n[t.field]))return null;let o=function(e,t,n=""){var o,r,l;return null!==(l=null===(r=null===(o=null==e?void 0:e.result[t])||void 0===o?void 0:o.value)||void 0===r?void 0:r.toString())&&void 0!==l?l:n}(e,t.field);return t.label&&(o=`<span class="${a("block-label")}">${t.label}</span> ${o}`),o}const j=window.wp.hooks,y=(0,window.wp.compose.createHigherOrderComponent)((e=>t=>{const o=(0,w.useContext)(k);return(0,n.jsx)(e,Object.assign({},t,{previewIndex:o}))}),"withPreviewIndex");(0,j.addFilter)("editor.BlockEdit","remote-data-blocks/withPreviewIndex",y),(0,e.registerBlockType)(r.UU,{edit:function(e){const{clientId:t,context:o,name:r}=e,a=(0,l.useBlockProps)(),{remoteData:c}=p(o),u=function(e,t,n){const{getBlocks:o}=(0,d.useSelect)(l.store,[e,[e,t]]);return r=>o(t).map((t=>x(t,r,null!=n?n:e)))}(r,t,null==c?void 0:c.blockName);return(null==c?void 0:c.blockName)?(0,n.jsx)(f,{getInnerBlocks:u,remoteData:c}):(0,n.jsx)("div",Object.assign({},a,{children:(0,n.jsx)(i.Placeholder,{label:(0,s.__)("Remote Data Template"),instructions:(0,s.__)("This block only works when placed inside a remote data block container and bound to an attribute. This block will be ignored as currently configured.")})}))},icon:{src:o},save:function(){return(0,n.jsx)(l.InnerBlocks.Content,{})}})})();