var U=Object.create;var V=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var M=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of O(t))!B.call(e,s)&&s!==r&&V(e,s,{get:()=>t[s],enumerable:!(i=K(t,s))||i.enumerable});return e};var p=(e,t,r)=>(r=e!=null?U(z(e)):{},M(t||!e||!e.__esModule?V(r,"default",{value:e,enumerable:!0}):r,e));var f=c((Y,T)=>{T.exports=window.wp.data});var m=c((G,v)=>{v.exports=window.wp.coreData});var F=c((J,x)=>{x.exports=window.wp.element});var g=c((X,P)=>{P.exports=window.wp.preferences});var u=p(f()),d=p(m());import{notFound as E}from"@wordpress/route";var S=p(F(),1),A=p(f(),1),N=p(g(),1);function y(e,t,r){return`dataviews-${e}-${t}-${r}`}function h(e,t){if(!t||t.length===0)return e;let r=new Set(t.map(s=>s.field)),i=(e.filters??[]).filter(s=>!r.has(s.field));return{...e,filters:[...i,...t]}}var _=p(f(),1),b=p(g(),1);async function w(e){let{kind:t,name:r,slug:i,defaultView:s,activeFilters:o,queryParams:a}=e,l=y(t,r,i),$=(0,_.select)(b.store).get("core/views",l)??s,j=a?.page??1,q=a?.search??"";return h({...$,page:j,search:q},o)}var L=p(f()),D=p(m()),Q={type:"table",sort:{field:"date",direction:"desc"},fields:["author","status","date"],titleField:"title",mediaField:"featured_media",descriptionField:"excerpt"};function R(e){return e==="all"?[]:[{field:"status",operator:"is",value:e}]}function C(e){return{...Q,showLevels:e?.hierarchical}}async function I(e,t,r){let i=await(0,L.resolveSelect)(D.store).getPostType(e),s=C(i);return w({kind:"postType",name:e,slug:"default-new",defaultView:s,activeFilters:R(t??"all"),queryParams:r})}function k(e,t){let r={};if(e.perPage!==void 0&&(r.per_page=e.perPage),e.page!==void 0&&(r.page=e.page),[void 0,""].includes(e.search)||(r.search=e.search),e.sort?.field!==void 0){let n=e.sort.field;n==="attached_to"&&(n="parent"),r.orderby=n}e.sort?.direction!==void 0&&(r.order=e.sort.direction),e.showLevels&&(r.orderby_hierarchy=!0);let i=e.filters?.find(n=>n.field==="status");i?r.status=i.value:t==="attachment"?r.status="inherit":r.status="draft,future,pending,private,publish";let s=e.filters?.find(n=>n.field==="author");s&&s.operator==="is"?r.author=s.value:s&&s.operator==="isNot"&&(r.author_exclude=s.value);let o=e.filters?.find(n=>n.field==="comment_status");o&&o.operator==="is"?r.comment_status=o.value:o&&o.operator==="isNot"&&(r.comment_status_exclude=o.value);let a=e.filters?.find(n=>n.field==="media_type");a&&(r.media_type=a.value);let l=e.filters?.find(n=>n.field==="date");return l&&l.value&&(l.operator==="before"?r.before=l.value:l.operator==="after"&&(r.after=l.value)),t==="attachment"&&(r._embed="wp:attached-to"),r}var we={beforeLoad:async({params:e})=>{try{if(!await(0,u.resolveSelect)(d.store).getPostType(e.type))throw E()}catch{throw E()}},title:async({params:e})=>(await(0,u.resolveSelect)(d.store).getPostType(e.type))?.labels?.name||e.type,async canvas(e){let{params:t,search:r}=e,i=await I(t.type,t.slug,{page:r.page,search:r.search});if(i.type!=="list")return;if(r.postIds&&r.postIds.length>0){let a=r.postIds[0].toString();return{postType:t.type,postId:a,isPreview:!0,editLink:`/types/${t.type}/edit/${a}`}}let s=k(i,t.type),o=await(0,u.resolveSelect)(d.store).getEntityRecords("postType",t.type,{...s,per_page:1});if(o&&o.length>0){let a=o[0].id.toString();return{postType:t.type,postId:a,isPreview:!0,editLink:`/types/${t.type}/edit/${a}`}}}};export{we as route};
