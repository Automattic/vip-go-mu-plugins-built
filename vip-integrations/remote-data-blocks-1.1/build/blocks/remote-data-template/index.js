(()=>{"use strict";const e=window.wp.blocks,t=window.wp.primitives,n=window.ReactJSXRuntime,o=(0,n.jsx)(t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(t.Path,{d:"M18 5.5H6a.5.5 0 00-.5.5v3h13V6a.5.5 0 00-.5-.5zm.5 5H10v8h8a.5.5 0 00.5-.5v-7.5zm-10 0h-3V18a.5.5 0 00.5.5h2.5v-8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})}),r=JSON.parse('{"UU":"remote-data-blocks/template"}'),i=window.wp.blockEditor,l=window.wp.components,s=window.wp.i18n;function a(e,t){return function(...e){return e.filter(Boolean).join(" ")}(t,`rdb-${n=e,n.replace(/[^a-zA-Z\d\u00C0-\u00FF]/g,"-").toLowerCase()}`);var n}var c;null===(c=window.REMOTE_DATA_BLOCKS)||void 0===c||c.rest_url,a("container");const u="remote-data/binding",d=window.wp.data,v=window.wp.editor;function p(e){var t;const{postMeta:n,postType:o}=(r=e=>{var t,n;return{postMeta:null!==(t=e("meta"))&&void 0!==t?t:{},postType:null!==(n=e("type"))&&void 0!==n?n:""}},(0,d.useSelect)((e=>{const{getEditedPostAttribute:t}=e(v.store);return r(t)}),[]));var r;if("wp_block"===o){const e=String(null!==(t=n._remote_data_blocks_block_type)&&void 0!==t?t:""),o=function(e){var t,n;return null===(n=null===(t=window.REMOTE_DATA_BLOCKS)||void 0===t?void 0:t.config)||void 0===n?void 0:n[e]}(e);if(o)return{remoteData:{blockName:e,metadata:{},queryInputs:[],queryKey:"Example Query Key",resultId:"",results:[{result:Object.fromEntries(Object.entries(o.availableBindings).map((([e,t])=>[e,{name:t.name,type:t.type,value:t.name}]))),uuid:"Example Entity ID"}]}}}return{remoteData:e["remote-data-blocks/remoteData"]}}const w=window.wp.element,m=(0,w.memo)((function(e){const{blocks:t,isHidden:o=!1,onSelect:r}=e,l=(0,i.__experimentalUseBlockPreview)({blocks:t,props:{}}),s={cursor:"pointer",display:o?"none":void 0,listStyle:"none"};return(0,n.jsx)("li",Object.assign({},l,{onClick:r,onKeyDown:r,role:"button",style:s,tabIndex:0}))}));function b({isActive:e}){const t=(0,i.useInnerBlocksProps)();return e?(0,n.jsx)("li",Object.assign({},t)):null}const k=(0,w.createContext)(0);function f(e){const[t,o]=(0,w.useState)(0),{getInnerBlocks:r,remoteData:l}=e,{clientId:s}=(0,i.useBlockEditContext)();return(0,d.useSelect)((e=>e(i.store).getBlocksByClientId(s)),[s]),(0,n.jsx)("ul",{className:"remote-data-blocks-loop-template",children:l.results.map(((e,i)=>{const l=i===t;return(0,n.jsxs)(k.Provider,{value:i,children:[(0,n.jsx)(b,{isActive:l}),(0,n.jsx)(m,{blocks:r(e),isHidden:l,onSelect:()=>o(i)})]},i)}))})}function g(t,n,o){var r;const i=null===(r=t.innerBlocks)||void 0===r?void 0:r.map((e=>g(e,n,o))),l=function(e,t,n,o=0){return Object.fromEntries(function(e,t){var n,o;return Object.entries(null!==(o=null===(n=e.metadata)||void 0===n?void 0:n.bindings)&&void 0!==o?o:{}).filter((([e,n])=>{var o;return n.source===u&&(null===(o=n.args)||void 0===o?void 0:o.block)===t}))}(e,n).map((([e,n])=>[e,x(t[o],n.args)])).filter((([t,n])=>null!==n&&n!==function(e,t){var n,o;return t&&function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}(e)&&null!==(o=null===(n=e[t])||void 0===n?void 0:n.toString())&&void 0!==o?o:""}(e,t))))}(t.attributes,[n],o);return(0,e.cloneBlock)(t,l,i)}function x(e,t){var n;if(!(null==t?void 0:t.field)||!(null===(n=null==e?void 0:e.result)||void 0===n?void 0:n[t.field]))return null;let o=function(e,t,n=""){var o,r,i;return null!==(i=null===(r=null===(o=null==e?void 0:e.result[t])||void 0===o?void 0:o.value)||void 0===r?void 0:r.toString())&&void 0!==i?i:n}(e,t.field);return t.label&&(o=`<span class="${a("block-label")}">${t.label}</span> ${o}`),o}const j=window.wp.hooks,y=(0,window.wp.compose.createHigherOrderComponent)((e=>t=>{const o=(0,w.useContext)(k);return(0,n.jsx)(e,Object.assign({},t,{previewIndex:o}))}),"withPreviewIndex");(0,j.addFilter)("editor.BlockEdit","remote-data-blocks/withPreviewIndex",y),(0,e.registerBlockType)(r.UU,{edit:function(e){const{clientId:t,context:o,name:r}=e,a=(0,i.useBlockProps)(),{remoteData:c}=p(o),u=function(e,t,n){const{getBlocks:o}=(0,d.useSelect)(i.store,[e,[e,t]]);return r=>o(t).map((t=>g(t,r,null!=n?n:e)))}(r,t,null==c?void 0:c.blockName);return(null==c?void 0:c.blockName)?c.results.length?(0,n.jsx)(f,{getInnerBlocks:u,remoteData:c}):(0,n.jsx)("div",Object.assign({},a)):(0,n.jsx)("div",Object.assign({},a,{children:(0,n.jsx)(l.Placeholder,{label:(0,s.__)("Remote Data Template"),instructions:(0,s.__)("This block only works when placed inside a remote data block container and bound to an attribute. This block will be ignored as currently configured.")})}))},icon:{src:o},save:function(){return(0,n.jsx)(i.InnerBlocks.Content,{})}})})();