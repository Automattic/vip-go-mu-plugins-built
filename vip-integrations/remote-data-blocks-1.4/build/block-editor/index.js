(()=>{var e={545:(e,t)=>{"use strict";t.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");var n={},o=e.length;if(o<2)return n;var i=t&&t.decode||u,a=0,s=0,p=0;do{if(-1===(s=e.indexOf("=",a)))break;if(-1===(p=e.indexOf(";",a)))p=o;else if(s>p){a=e.lastIndexOf(";",s-1)+1;continue}var f=l(e,a,s),v=c(e,s,f),g=e.slice(f,v);if(!r.call(n,g)){var h=l(e,s+1,p),m=c(e,p,h);34===e.charCodeAt(h)&&34===e.charCodeAt(m-1)&&(h++,m--);var b=e.slice(h,m);n[g]=d(b,i)}a=p+1}while(a<o);return n},t.serialize=function(e,t,r){var l=r&&r.encode||encodeURIComponent;if("function"!=typeof l)throw new TypeError("option encode is invalid");if(!o.test(e))throw new TypeError("argument name is invalid");var c=l(t);if(!i.test(c))throw new TypeError("argument val is invalid");var u=e+"="+c;if(!r)return u;if(null!=r.maxAge){var d=Math.floor(r.maxAge);if(!isFinite(d))throw new TypeError("option maxAge is invalid");u+="; Max-Age="+d}if(r.domain){if(!a.test(r.domain))throw new TypeError("option domain is invalid");u+="; Domain="+r.domain}if(r.path){if(!s.test(r.path))throw new TypeError("option path is invalid");u+="; Path="+r.path}if(r.expires){var p=r.expires;if(!function(e){return"[object Date]"===n.call(e)}(p)||isNaN(p.valueOf()))throw new TypeError("option expires is invalid");u+="; Expires="+p.toUTCString()}if(r.httpOnly&&(u+="; HttpOnly"),r.secure&&(u+="; Secure"),r.partitioned&&(u+="; Partitioned"),r.priority)switch("string"==typeof r.priority?r.priority.toLowerCase():r.priority){case"low":u+="; Priority=Low";break;case"medium":u+="; Priority=Medium";break;case"high":u+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"strict":u+="; SameSite=Strict";break;case"none":u+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return u};var n=Object.prototype.toString,r=Object.prototype.hasOwnProperty,o=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,i=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,a=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/;function l(e,t,n){do{var r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<n);return n}function c(e,t,n){for(;t>n;){var r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return n}function u(e){return-1!==e.indexOf("%")?decodeURIComponent(e):e}function d(e,t){try{return t(e)}catch(t){return e}}},510:(e,t,n)=>{"use strict";var r=n(994);Object.defineProperty(t,"__esModule",{value:!0}),t.getCallbacksMap=a,t.isLoading=s,t.addScriptCallback=function(e,t){var n=a();s(e)?(o('Adding a callback for an existing script from "'.concat(e,'"')),n.get(e).add(t)):(o('Adding a callback for a new script from "'.concat(e,'"')),n.set(e,new Set([t])))},t.removeScriptCallback=function(e,t){if(o('Removing a known callback for a script from "'.concat(e,'"')),s(e)){var n=a(),r=n.get(e);r.delete(t),0===r.size&&n.delete(e)}},t.removeScriptCallbacks=function(e){o('Removing all callbacks for a script from "'.concat(e,'"')),a().delete(e)},t.removeAllScriptCallbacks=function(){o("Removing all callbacks for scripts from all URLs"),a().clear()},t.executeCallbacks=l,t.handleRequestSuccess=function(){var e=this.getAttribute("src");o('Handling successful request for "'.concat(e,'"')),l(e),this.onload=null},t.handleRequestError=function(){var e=this.getAttribute("src");o('Handling failed request for "'.concat(e,'"')),l(e,new Error('Failed to load script "'.concat(e,'"'))),this.onerror=null};var o=(0,r(n(769)).default)("lib/load-script/callback-handler"),i=new Map;function a(){return i}function s(e){return a().has(e)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=a(),r=n.get(e);if(r){var i='Executing callbacks for "'.concat(e,'"')+(null===t?" with success":' with error "'.concat(t,'"'));o(i),r.forEach((function(e){"function"==typeof e&&e(t)})),n.delete(e)}}},469:(e,t,n)=>{"use strict";var r=n(994);Object.defineProperty(t,"__esModule",{value:!0}),t.createScriptElement=function(e){a('Creating script element for "'.concat(e,'"'));var t=document.createElement("script");return t.src=e,t.type="text/javascript",t.async=!0,t.onload=i.handleRequestSuccess,t.onerror=i.handleRequestError,t},t.attachToHead=function(e){a("Attaching element to head"),document.head.appendChild(e)};var o=r(n(769)),i=n(510),a=(0,o.default)("lib/load-script/dom-operations")},50:(e,t,n)=>{"use strict";var r=n(994);t.k0=function(e,t){if(!(0,i.isLoading)(e)&&(0,a.attachToHead)((0,a.createScriptElement)(e)),"function"!=typeof t)return new Promise((function(t,n){(0,i.addScriptCallback)(e,(function(e){null===e?t():n(e)}))}));(0,i.addScriptCallback)(e,t)};var o=r(n(769)),i=n(510),a=n(469);(0,o.default)("package/load-script")},769:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":r(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(632)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},632:(e,t,n)=>{"use strict";e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){var n;function a(){if(a.enabled){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var i=a,s=Number(new Date),l=s-(n||s);i.diff=l,i.prev=n,i.curr=s,n=s,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;c++;var o=r.formatters[n];if("function"==typeof o){var a=t[c];e=o.call(i,a),t.splice(c,1),c--}return e})),r.formatArgs.call(i,t),(i.log||r.log).apply(i,t)}}return a.namespace=e,a.enabled=r.enabled(e),a.useColors=r.useColors(),a.color=t(e),a.destroy=o,a.extend=i,"function"==typeof r.init&&r.init(a),r.instances.push(a),a}function o(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function i(e,t){return r(this.namespace+(void 0===t?":":t)+e)}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){r.enable("")},r.enable=function(e){var t;r.save(e),r.names=[],r.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){var i=r.instances[t];i.enabled=r.enabled(i.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(585),Object.keys(e).forEach((function(t){r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},833:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(736)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e,t){let n=0,r=0,o=-1,i=0;for(;n<e.length;)if(r<t.length&&(t[r]===e[n]||"*"===t[r]))"*"===t[r]?(o=r,i=n,r++):(n++,r++);else{if(-1===o)return!1;r=o+1,i++,n=i}for(;r<t.length&&"*"===t[r];)r++;return r===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names,...t.skips.map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const e of n)"-"===e[0]?t.skips.push(e.slice(1)):t.names.push(e)},t.enabled=function(e){for(const n of t.skips)if(o(e,n))return!1;for(const n of t.names)if(o(e,n))return!0;return!1},t.humanize=n(585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},7:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}g(e,t,i,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var o,i,a,c;if(s(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(o=l(e))>0&&a.length>o&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=u.bind(r);return o.listener=n,r.wrapFn=o,o}function p(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,u=v(l,c);for(n=0;n<c;++n)r(u[n],this,t)}return!0},i.prototype.addListener=function(e,t){return c(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return c(this,e,t,!0)},i.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,o,i,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return p(this,e,!0)},i.prototype.rawListeners=function(e){return p(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},166:(e,t,n)=>{"use strict";var r=n(426),o=n(349);function i(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=i,i.prototype.update=function(e,t){if(e=r.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=r.join32(e,0,e.length-n,this.endian);for(var o=0;o<e.length;o+=this._delta32)this._update(e,o,o+this._delta32)}return this},i.prototype.digest=function(e){return this.update(this._pad()),o(null===this.pending),this._digest(e)},i.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var o=1;o<n;o++)r[o]=0;if(e<<=3,"big"===this.endian){for(var i=8;i<this.padLength;i++)r[o++]=0;r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=e>>>24&255,r[o++]=e>>>16&255,r[o++]=e>>>8&255,r[o++]=255&e}else for(r[o++]=255&e,r[o++]=e>>>8&255,r[o++]=e>>>16&255,r[o++]=e>>>24&255,r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0,i=8;i<this.padLength;i++)r[o++]=0;return r}},287:(e,t,n)=>{"use strict";var r=n(426),o=n(166),i=n(225),a=n(349),s=r.sum32,l=r.sum32_4,c=r.sum32_5,u=i.ch32,d=i.maj32,p=i.s0_256,f=i.s1_256,v=i.g0_256,g=i.g1_256,h=o.BlockHash,m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;h.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=m,this.W=new Array(64)}r.inherits(b,h),e.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=l(g(n[r-2]),n[r-7],v(n[r-15]),n[r-16]);var o=this.h[0],i=this.h[1],h=this.h[2],m=this.h[3],b=this.h[4],y=this.h[5],C=this.h[6],_=this.h[7];for(a(this.k.length===n.length),r=0;r<n.length;r++){var w=c(_,f(b),u(b,y,C),this.k[r],n[r]),j=s(p(o),d(o,i,h));_=C,C=y,y=b,b=s(m,w),m=h,h=i,i=o,o=s(w,j)}this.h[0]=s(this.h[0],o),this.h[1]=s(this.h[1],i),this.h[2]=s(this.h[2],h),this.h[3]=s(this.h[3],m),this.h[4]=s(this.h[4],b),this.h[5]=s(this.h[5],y),this.h[6]=s(this.h[6],C),this.h[7]=s(this.h[7],_)},b.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},225:(e,t,n)=>{"use strict";var r=n(426).rotr32;function o(e,t,n){return e&t^~e&n}function i(e,t,n){return e&t^e&n^t&n}function a(e,t,n){return e^t^n}t.ft_1=function(e,t,n,r){return 0===e?o(t,n,r):1===e||3===e?a(t,n,r):2===e?i(t,n,r):void 0},t.ch32=o,t.maj32=i,t.p32=a,t.s0_256=function(e){return r(e,2)^r(e,13)^r(e,22)},t.s1_256=function(e){return r(e,6)^r(e,11)^r(e,25)},t.g0_256=function(e){return r(e,7)^r(e,18)^e>>>3},t.g1_256=function(e){return r(e,17)^r(e,19)^e>>>10}},426:(e,t,n)=>{"use strict";var r=n(349),o=n(698);function i(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function a(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function s(e){return 1===e.length?"0"+e:e}function l(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=o,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),o=0;o<e.length;o+=2)n.push(parseInt(e[o]+e[o+1],16))}else for(var r=0,o=0;o<e.length;o++){var a=e.charCodeAt(o);a<128?n[r++]=a:a<2048?(n[r++]=a>>6|192,n[r++]=63&a|128):i(e,o)?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++o)),n[r++]=a>>18|240,n[r++]=a>>12&63|128,n[r++]=a>>6&63|128,n[r++]=63&a|128):(n[r++]=a>>12|224,n[r++]=a>>6&63|128,n[r++]=63&a|128)}else for(o=0;o<e.length;o++)n[o]=0|e[o];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=s(e[n].toString(16));return t},t.htonl=a,t.toHex32=function(e,t){for(var n="",r=0;r<e.length;r++){var o=e[r];"little"===t&&(o=a(o)),n+=l(o.toString(16))}return n},t.zero2=s,t.zero8=l,t.join32=function(e,t,n,o){var i=n-t;r(i%4==0);for(var a=new Array(i/4),s=0,l=t;s<a.length;s++,l+=4){var c;c="big"===o?e[l]<<24|e[l+1]<<16|e[l+2]<<8|e[l+3]:e[l+3]<<24|e[l+2]<<16|e[l+1]<<8|e[l],a[s]=c>>>0}return a},t.split32=function(e,t){for(var n=new Array(4*e.length),r=0,o=0;r<e.length;r++,o+=4){var i=e[r];"big"===t?(n[o]=i>>>24,n[o+1]=i>>>16&255,n[o+2]=i>>>8&255,n[o+3]=255&i):(n[o+3]=i>>>24,n[o+2]=i>>>16&255,n[o+1]=i>>>8&255,n[o]=255&i)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,r){return e+t+n+r>>>0},t.sum32_5=function(e,t,n,r,o){return e+t+n+r+o>>>0},t.sum64=function(e,t,n,r){var o=e[t],i=r+e[t+1]>>>0,a=(i<r?1:0)+n+o;e[t]=a>>>0,e[t+1]=i},t.sum64_hi=function(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,r){return t+r>>>0},t.sum64_4_hi=function(e,t,n,r,o,i,a,s){var l=0,c=t;return l+=(c=c+r>>>0)<t?1:0,l+=(c=c+i>>>0)<i?1:0,e+n+o+a+(l+=(c=c+s>>>0)<s?1:0)>>>0},t.sum64_4_lo=function(e,t,n,r,o,i,a,s){return t+r+i+s>>>0},t.sum64_5_hi=function(e,t,n,r,o,i,a,s,l,c){var u=0,d=t;return u+=(d=d+r>>>0)<t?1:0,u+=(d=d+i>>>0)<i?1:0,u+=(d=d+s>>>0)<s?1:0,e+n+o+a+l+(u+=(d=d+c>>>0)<c?1:0)>>>0},t.sum64_5_lo=function(e,t,n,r,o,i,a,s,l,c){return t+r+i+s+c>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},698:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},349:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},585:e=>{var t=1e3,n=60*t,r=60*n,o=24*r,i=7*o;function a(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,s){s=s||{};var l,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&isFinite(e))return s.long?(l=e,(c=Math.abs(l))>=o?a(l,c,o,"day"):c>=r?a(l,c,r,"hour"):c>=n?a(l,c,n,"minute"):c>=t?a(l,c,t,"second"):l+" ms"):function(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},994:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.blocks;function t(e){var t,n;return null!==(n=null===(t=r(e))||void 0===t?void 0:t.availableBindings)&&void 0!==n?n:{}}function r(e){var t,n;return null===(n=null===(t=window.REMOTE_DATA_BLOCKS)||void 0===t?void 0:t.config)||void 0===n?void 0:n[e]}function o(e){var t,n;return e&&null!==(n=null===(t=r(e))||void 0===t?void 0:t.dataSourceType)&&void 0!==n?n:""}function i(){var e,t;return null!==(t=null===(e=window.REMOTE_DATA_BLOCKS)||void 0===e?void 0:e.config)&&void 0!==t?t:{}}function a(e,t){return function(...e){return e.filter(Boolean).join(" ")}(t,`rdb-${n=e,n.replace(/[^a-zA-Z\d\u00C0-\u00FF]/g,"-").toLowerCase()}`);var n}const s=["core/button","core/heading","core/image","core/paragraph"],l="display",c="remote-data-blocks/remoteData",u=null!==(p=null===(d=window.REMOTE_DATA_BLOCKS)||void 0===d?void 0:d.rest_url)&&void 0!==p?p:"http://127.0.0.1:9999";var d,p;a("container");const f="ui:search_input",v=["button_text"],g=["button_url"],h=["html"],m=["id","id:list"],b=["image_alt"],y=["image_url"],C=["currency_in_current_locale","email_address","integer","markdown","number","string","title"],_="remote-data/binding";(0,e.registerBlockBindingsSource)({name:_,usesContext:["remote-data-blocks/remoteData"],getValues({bindings:e,context:t,select:n}){const r=t[c],o=n("remote-data-blocks/store").getPreviewIndex(null==r?void 0:r.resultId);return Object.fromEntries(Object.entries(e).filter((([e,t])=>{var n;return t.args.isPreview||Boolean(null===(n=null==r?void 0:r.results)||void 0===n?void 0:n.length)})).map((([e,t])=>{var n,i,a,s,l,c,u,d;const p=null!==(i=null!==(n=t.args.previewIndex)&&void 0!==n?n:o)&&void 0!==i?i:0;return[e,`${t.args.label?`${t.args.label}: `:""}${null!==(a=t.args.previewValue)&&void 0!==a?a:String(null!==(d=null===(u=null===(c=null===(l=null===(s=null==r?void 0:r.results)||void 0===s?void 0:s[p])||void 0===l?void 0:l.result)||void 0===c?void 0:c[t.args.field])||void 0===u?void 0:u.value)&&void 0!==d?d:"")}`]})))}});const w=window.wp.hooks,j=window.ReactJSXRuntime,k=window.wp.blockEditor,x=window.wp.components,F=window.wp.compose,O=window.wp.data,S=window.wp.i18n;var E=n(833);const P=n.n(E)()("calypso:analytics");let I;n(287);let L=null;"undefined"!=typeof window&&window.addEventListener("popstate",(function(){L=null}));var N=n(545);const A=["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI","SK","GB","CH","IS","LI","NO"],B=["california","colorado","connecticut","utah","virginia","texas","tennessee","oregon","new jersey","montana","iowa","indiana","delaware"],T="sensitive_pixel_option",M="sensitive_pixel_options",D={ok:!1,buckets:{essential:!0,analytics:!1,advertising:!1}},R={ok:!1,buckets:{essential:!0,analytics:!0,advertising:!1}},q={ok:!0,buckets:{essential:!0,analytics:!0,advertising:!0}},z=(e,t,n=D)=>{const{ok:r,buckets:o}=e?JSON.parse(e):{};return"boolean"==typeof r?{ok:r,buckets:{...n.buckets,...o}}:t&&["yes","no"].includes(t)?{ok:"yes"===t,buckets:q.buckets}:n};var $=n(7),H=n(50);const U=["calypso","jetpack","remotedatablocks","wpcom_dsp_widget"],K=["a8c_cookie_banner_ok","a8c_cookie_banner_view","a8c_ccpa_optout","wcadmin_storeprofiler_create_jetpack_account","wcadmin_storeprofiler_connect_store","wcadmin_storeprofiler_login_jetpack_account","wcadmin_storeprofiler_payment_login","wcadmin_storeprofiler_payment_create_account","calypso_checkout_switch_to_p_24","calypso_checkout_composite_p24_submit_clicked","wpcom_launchbar_button_click","wpcom_support_free_migration_request_click"];let G,V=Promise.resolve();"undefined"!=typeof document&&(V=(0,H.k0)("//stats.wp.com/w.js?67"));const J=new $.EventEmitter;function Q(e,t){t=t||{};const n=I;n?.localeSlug&&(t.user_lang=n.localeSlug);const r=function(){if("undefined"==typeof document)return q;const e=N.parse(document.cookie),t="unknown"===(n=e.country_code)||void 0!==n&&A.includes(n);var n;const r=function(e,t){return"US"===e&&("unknown"===t||void 0!==t&&B.includes(t.toLowerCase()))}(e.country_code,e.region);if(!t&&!r)return q;const o=t?R:q,{ok:i,buckets:a}=z(e[M],e[T],o);return r?{ok:i,buckets:{...q.buckets,advertising:a.advertising}}:{ok:i,buckets:a}}();if(r?.buckets.analytics)if(P('Record event "%s" called with props %o',e,t),function(e){return U.some((t=>e.startsWith(`${t}_`)))}(e)||K.includes(e)){if(G){const e=G(t);t={...t,...e}}t=Object.fromEntries(Object.entries(t).filter((([,e])=>void 0!==e))),P('Recording event "%s" with actual props %o',e,t),o=["recordEvent",e,t],"undefined"!=typeof window&&(window._tkq=window._tkq||[],window._tkq.push(o)),J.emit("record-event",e,t)}else P("- Event name must be prefixed by a known source or added to `EVENT_NAME_EXCEPTIONS`");else P('Analytics has been disabled - Ignoring event "%s" with actual props %o',e,t);var o}const Z="remotedatablocks_";function W(e,t){const n=function(){var e;return null===(e=window.REMOTE_DATA_BLOCKS)||void 0===e?void 0:e.tracks_global_properties}();n&&"local"!==n.vip_env&&Q(`${Z}${e}`,Object.assign(Object.assign({},n),t))}function X(e){const{availableBindings:t,fieldTypes:n,label:r,target:o,updateFieldBinding:i,value:a}=e,s=Object.entries(t).filter((([e,t])=>n.includes(t.type))).map((([e,t])=>({label:t.name,value:e})));return(0,j.jsx)(x.SelectControl,{label:r,name:o,options:[{label:"Select a field",value:""},...s],onChange:e=>i(o,e),value:a,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}function Y(e){var t,n,r,i,a,s,l,c,u,d,p,f,m,_,w,k,F,O,S,E,P,_x,I,L;const{attributes:N,availableBindings:A,blockName:B,remoteDataName:T,removeBinding:M,updateBinding:D}=e,R=null===(r=null===(n=null===(t=N.metadata)||void 0===t?void 0:t.bindings)||void 0===n?void 0:n.content)||void 0===r?void 0:r.args,q=null!==(i=null==R?void 0:R.field)&&void 0!==i?i:"",z=null!==(u=null===(c=null===(l=null===(s=null===(a=N.metadata)||void 0===a?void 0:a.bindings)||void 0===s?void 0:s.alt)||void 0===l?void 0:l.args)||void 0===c?void 0:c.field)&&void 0!==u?u:"",$=null!==(_=null===(m=null===(f=null===(p=null===(d=N.metadata)||void 0===d?void 0:d.bindings)||void 0===p?void 0:p.url)||void 0===f?void 0:f.args)||void 0===m?void 0:m.field)&&void 0!==_?_:"",H=null!==(S=null===(O=null===(F=null===(k=null===(w=N.metadata)||void 0===w?void 0:w.bindings)||void 0===k?void 0:k.url)||void 0===F?void 0:F.args)||void 0===O?void 0:O.field)&&void 0!==S?S:"",U=null!==(L=null===(I=null===(_x=null===(P=null===(E=N.metadata)||void 0===E?void 0:E.bindings)||void 0===P?void 0:P.text)||void 0===_x?void 0:_x.args)||void 0===I?void 0:I.field)&&void 0!==L?L:"";function K(e,t){var n,r,i,a;if(!t)return M(e),void W("remote_data_container_actions",{action:"remove_binding",data_source_type:o(T),block_target_attribute:e});const s=null!==(a=null===(i=null===(r=null===(n=N.metadata)||void 0===n?void 0:n.bindings)||void 0===r?void 0:r[e])||void 0===i?void 0:i.args)&&void 0!==a?a:{};D(e,Object.assign(Object.assign({},s),{field:t})),W("remote_data_container_actions",{action:"update_binding",data_source_type:o(T),remote_data_field:t,block_target_attribute:e})}switch(B){case"core/heading":case"core/paragraph":return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(X,{availableBindings:A,fieldTypes:C,label:"Content",target:"content",updateFieldBinding:K,value:q}),(0,j.jsx)(x.CheckboxControl,{checked:Boolean(null==R?void 0:R.label),disabled:!q,label:"Show label",name:"show_label",onChange:function(e){var t,n;if(!q)return;const r=e?null===(n=null===(t=Object.entries(A).find((([e])=>e===q)))||void 0===t?void 0:t[1])||void 0===n?void 0:n.name:void 0;D("content",Object.assign(Object.assign({},R),{field:q,label:r})),W("remote_data_container_actions",{action:e?"show_label":"hide_label",data_source_type:o(T)})}})]});case"core/image":return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(X,{availableBindings:A,fieldTypes:y,label:"Image URL",target:"url",updateFieldBinding:K,value:$}),(0,j.jsx)(X,{availableBindings:A,fieldTypes:b,label:"Image alt text",target:"alt",updateFieldBinding:K,value:z})]});case"core/button":return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(X,{availableBindings:A,fieldTypes:g,label:"Button URL",target:"url",updateFieldBinding:K,value:H}),(0,j.jsx)(X,{availableBindings:A,fieldTypes:v,label:"Button Text",target:"text",updateFieldBinding:K,value:U})]});case"remote-data-blocks/remote-html":return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(X,{availableBindings:A,fieldTypes:h,label:"Raw HTML",target:"content",updateFieldBinding:K,value:q})})}return null}const ee=window.wp.editor;var te=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function ne(e){return e.map((e=>Object.fromEntries(Object.entries(e.result).map((([e,t])=>[e,t.value])))))}function re(e,t,n=""){var r,o,i;return null!==(i=null===(o=null===(r=null==e?void 0:e.result[t])||void 0===r?void 0:r.value)||void 0===o?void 0:o.toString())&&void 0!==i?i:n}function oe(e){var t;if(!e)return;const{queryInput:n,results:r}=e,o=te(e,["queryInput","results"]),i=null==r?void 0:r.map(((e,t)=>{var n;const r=null!==(n=e.result)&&void 0!==n?n:{};return function(e){return Object.prototype.hasOwnProperty.call(e,"result")&&Object.prototype.hasOwnProperty.call(e,"uuid")}(e)?e:(o=r,i=`${t}`,{result:Object.fromEntries(Object.entries(o).map((([e,t])=>[e,{name:e,type:"string",value:t}]))),uuid:i});var o,i}));return Object.assign(Object.assign({},o),{queryInputs:null!==(t=e.queryInputs)&&void 0!==t?t:n?[n]:[{}],results:i})}function ie(e,t){var n,r;return Object.entries(null!==(r=null===(n=e.metadata)||void 0===n?void 0:n.bindings)&&void 0!==r?r:{}).filter((([e,n])=>{var r;return n.source===_&&(null===(r=n.args)||void 0===r?void 0:r.block)===t}))}function ae(e,t){var n;const r=(null!==(n=e.className)&&void 0!==n?n:"").split(/\s/).filter((e=>!e.startsWith("rdb-block-data-"))),o=new Set([...r,...ie(e,t).map((([e,t])=>a(`block-data-${t.args.field}`)))]);return Array.from(o.values()).filter(Boolean).join(" ")}function se(e){var t,n;const{attributes:r,availableBindings:o,blockName:i,remoteDataName:a,remoteDataTitle:s,setAttributes:l}=e,c=null!==(n=null===(t=r.metadata)||void 0===t?void 0:t.bindings)&&void 0!==n?n:{};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(k.InspectorControls,{children:(0,j.jsxs)(x.PanelBody,{title:(0,S.__)("Remote Data","remote-data-blocks"),children:[(0,j.jsx)("p",{className:"rdb-block-helper-text",children:(0,S.sprintf)((0,S.__)("Connected to %s","remote-data-blocks"),s)}),(0,j.jsx)(Y,{attributes:r,availableBindings:o,blockName:i,remoteDataName:a,removeBinding:function(e){const t=c,n=e,o=(t[n],function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["symbol"==typeof n?n:n+""]));l({metadata:Object.assign(Object.assign({},r.metadata),{bindings:o,name:void 0})})},updateBinding:function(e,t){var n,i;l({className:ae(r,a),metadata:Object.assign(Object.assign({},r.metadata),{bindings:Object.assign(Object.assign({},null===(n=r.metadata)||void 0===n?void 0:n.bindings),{[e]:{source:_,args:Object.assign(Object.assign({},t),{block:a})}}),name:null===(i=o[t.field])||void 0===i?void 0:i.name})})}})]})}),e.children]})}const le=(0,F.createHigherOrderComponent)((e=>n=>{var o,i,a,s;const{attributes:l,context:u,name:d,setAttributes:p}=n,{remoteData:f}=function(e){var t;const{postMeta:n,postType:o}=(i=e=>{var t,n;return{postMeta:null!==(t=e("meta"))&&void 0!==t?t:{},postType:null!==(n=e("type"))&&void 0!==n?n:""}},(0,O.useSelect)((e=>{const{getEditedPostAttribute:t}=e(ee.store);return i(t)}),[]));var i;if("wp_block"===o){const e=String(null!==(t=n._remote_data_blocks_block_type)&&void 0!==t?t:""),o=r(e);if(o)return{remoteData:{blockName:e,metadata:{},queryInputs:[],queryKey:"Example Query Key",resultId:"",results:[{result:Object.fromEntries(Object.entries(o.availableBindings).map((([e,t])=>[e,{name:t.name,type:t.type,value:t.name}]))),uuid:"Example Entity ID"}]}}}return{remoteData:e[c]}}(u),v=t(null!==(o=null==f?void 0:f.blockName)&&void 0!==o?o:""),g=Boolean(Object.keys(v).length),{hasMultiSelection:h}=(0,O.useSelect)(k.store);if(!f||!g)return(0,j.jsx)(e,Object.assign({},n));const m=u["pattern/overrides"],b=Boolean(m),y=Object.values(null!==(a=null===(i=l.metadata)||void 0===i?void 0:i.bindings)&&void 0!==a?a:{}).some((e=>"core/pattern-overrides"===e.source));if(h())return(0,j.jsx)(e,Object.assign({},n,{attributes:l}));if(b&&!y)return(0,j.jsx)(e,Object.assign({},n,{attributes:l}));const C=function(e){var t,n,o;return e?null!==(o=null===(n=null===(t=r(e))||void 0===t?void 0:t.settings)||void 0===n?void 0:n.title)&&void 0!==o?o:e.replace("remote-data-blocks/",""):""}(null==f?void 0:f.blockName);return(0,j.jsx)(se,{attributes:l,availableBindings:v,blockName:d,remoteDataName:null!==(s=null==f?void 0:f.blockName)&&void 0!==s?s:"",remoteDataTitle:C,setAttributes:p,children:(0,j.jsx)(e,Object.assign({},n,{attributes:l}))})}),"withBlockBinding");(0,w.addFilter)("blocks.registerBlockType","remote-data-blocks/withBlockBinding",(function(e){var t;return Object.assign(Object.assign({},e),{edit:le(null!==(t=e.edit)&&void 0!==t?t:()=>null)})}),5),(0,w.addFilter)("blocks.registerBlockType","remote-data-blocks/addUsesContext",(function(e,t){if(!s.includes(t))return e;const{usesContext:n=[]}=e;return(null==n?void 0:n.includes(c))?e:Object.assign(Object.assign({},e),{usesContext:[...n,c]})}),10);const ce=window.wp.richText,ue=window.wp.element,de=window.wp.primitives,pe=(0,j.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,j.jsx)(de.Path,{d:"M10.8622 8.04053L14.2805 12.0286L10.8622 16.0167L9.72327 15.0405L12.3049 12.0286L9.72327 9.01672L10.8622 8.04053Z"})}),fe=(0,j.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,j.jsx)(de.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),ve=window.wp.apiFetch;var ge,he=n.n(ve);class me extends Error{}function be(e){return e instanceof Error?e:null==e?new Error("An unknown error occurred"):"string"==typeof e?new Error(e):"object"==typeof e&&"message"in e?new Error(String(e.message)):new Error(String(e))}!function(e){e.MissingRequiredInput="missing_required_input"}(ge||(ge={}));class ye extends me{constructor(e,t,n){super(e),this.type=t,this.affectedInputVariables=n}toString(){return`${this.type}: ${this.message}\n\n\t${this.affectedInputVariables.map((e=>e.slug)).join(", ")}`}}function Ce(e,t){const n=t.filter((e=>e.required)).filter((t=>{var n;return null===(null!==(n=e[t.slug])&&void 0!==n?n:null)}));if(n.length)throw new ye("Missing required query input variables",ge.MissingRequiredInput,n);return!0}var _e=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},we=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const je=function(){const e=new Map,t=e=>{try{return JSON.stringify(e)}catch(t){return String(e)}};return(...n)=>{const r=Array.from(n).map(t).join(",");if(e.has(r))return e.get(r);const o=function(e){return _e(this,void 0,void 0,(function*(){var t,n;const{body:r,status:o}=yield he()({url:u,method:"POST",data:e});if(200!==o||!r)throw new Error(String(null!==(n=null!==(t=null==r?void 0:r.message)&&void 0!==t?t:null==r?void 0:r.code)&&void 0!==n?n:"Request for remote data failed"));return{blockName:r.block_name,metadata:r.metadata,pagination:r.pagination,queryKey:r.query_key,queryInputs:r.query_inputs,resultId:r.result_id,results:r.results}}))}(...n);return o instanceof Promise?o.then((()=>(e.set(r,o),o))):(e.set(r,o),o)}}();function ke({blockName:e,externallyManagedRemoteData:t,externallyManagedUpdateRemoteData:n,fetchOnMount:o=!1,initialPage:i,initialPerPage:a,initialSearchInput:s,onSuccess:l,queryKey:c}){var u,d;const[p,v]=(0,ue.useState)(),[g,h]=(0,ue.useState)(),[m,b]=(0,ue.useState)(!1),y=null!=t?t:p,C=null!=n?n:v,_=Boolean(y),w=r(e),j=null===(u=null==w?void 0:w.selectors)||void 0===u?void 0:u.find((e=>e.query_key===c));if(!j)throw new Error(`Query not found for block "${e}" and key "${c}".`);const k=null!==(d=null==t?void 0:t.enabledOverrides)&&void 0!==d?d:[],x=j.inputs,F=function({initialPage:e=1,initialPerPage:t,paginationData:n}){var r,o,i,a,s,l;const[c,u]=(0,ue.useState)(e),[d,p]=(0,ue.useState)(null!=t?t:null),[f,v]=(0,ue.useState)(),g=null===(r=null==n?void 0:n.input_variables)||void 0===r?void 0:r.next_page,h=null===(o=null==n?void 0:n.input_variables)||void 0===o?void 0:o.previous_page,m=null===(i=null==n?void 0:n.input_variable_targets)||void 0===i?void 0:i.offset,b=null===(a=null==n?void 0:n.input_variable_targets)||void 0===a?void 0:a.page,y=null===(s=null==n?void 0:n.input_variable_targets)||void 0===s?void 0:s.per_page,C=null!==(l=null!=d?d:null==n?void 0:n.per_page)&&void 0!==l?l:10,_=Boolean(g),w=Boolean((null==n?void 0:n.type)&&"NONE"!==(null==n?void 0:n.type)),j=null==n?void 0:n.total_items,k=j?Math.ceil(j/C):void 0;return{hasNextPage:_,page:c,paginationQueryInput:f,perPage:null!=d?d:null==n?void 0:n.per_page,setPage:function(e){if(!w)return;const t=e>c,r=e<c&&e>0,o=t?Math.min(null!=k?k:c+1,e):Math.max(1,e);if(t||r)switch(null==n?void 0:n.type){case"CURSOR":case"CURSOR_SIMPLE":if(t){u(c+1),v(g);break}u(c-1),v(h);break;case"OFFSET":if(!m)break;if(u(o),t){v(Object.assign(Object.assign({},g),{[m]:C*(o-1)}));break}v(Object.assign(Object.assign({},h),{[m]:C*(o-1)}));break;case"PAGE":if(!b)break;if(u(o),t){v(Object.assign(Object.assign({},g),{[b]:o}));break}v(Object.assign(Object.assign({},h),{[b]:o}))}},setPerPage:function(e){y&&C!==e&&(p(e),v(Object.assign(Object.assign({},f),{[y]:e})))},supportsPagination:w,supportsPerPage:Boolean(y),totalItems:j,totalPages:k}}({initialPage:i,initialPerPage:a,paginationData:null==y?void 0:y.pagination}),{hasNextPage:S,page:E,perPage:P,paginationQueryInput:I,supportsPagination:L,totalItems:N,totalPages:A}=F,B=we(F,["hasNextPage","page","perPage","paginationQueryInput","supportsPagination","totalItems","totalPages"]),{hasSearchInput:T,searchQueryInput:M,searchInput:D,setSearchInput:R,supportsSearch:q}=function({initialSearchInput:e="",inputVariables:t,searchInputDelayInMs:n=500}){var r;const[o,i]=function(e,t){const n=(0,ue.useRef)(null),[r,o]=(0,ue.useState)(t);return[r,(0,ue.useCallback)((t=>{n.current&&clearTimeout(n.current),n.current=setTimeout((()=>{o(t)}),e)}),[])]}(n,e),a=null==t?void 0:t.find((e=>e.type===f)),s=Boolean(a),l=s&&!(null==a?void 0:a.required),c=s&&Boolean(o||l);return{hasSearchInput:c,searchInput:o,searchQueryInput:s?{[null!==(r=null==a?void 0:a.slug)&&void 0!==r?r:""]:c?o:null}:{},setSearchInput:s?i:()=>{},supportsSearch:s}}({initialSearchInput:s,inputVariables:x}),z=Object.assign(Object.assign({},I),M),$=!g&&(_||T),H=_&&q&&!T;if((0,ue.useEffect)((()=>{var e;H?C(void 0):$&&U(null!==(e=null==y?void 0:y.queryInputs)&&void 0!==e?e:[{}])}),[H,$,E,P,D]),(0,ue.useEffect)((()=>{o&&function(e,t){try{return Ce(e,t),!0}catch(e){return!1}}(z,x)&&U([{}])}),[]),g&&!m)throw g;function U(t){return _e(this,void 0,void 0,(function*(){const{getCurrentPostId:n}=(0,O.select)(ee.store),r=n();if(0===t.length)return void K(new Error("Query input is empty"));1===t.length&&(t[0]=Object.assign(Object.assign({},t[0]),z));const o={block_name:e,post_id:null!=r?r:null,query_key:c,query_inputs:t};try{t.forEach((e=>Ce(e,x)))}catch(e){return void K(be(e))}b(!0);const i=yield je(o).catch((e=>{K(be(e))}));i&&(C(Object.assign({enabledOverrides:k},i)),b(!1),null==l||l())}))}function K(e){C(void 0),h(e),b(!1)}return Object.assign({data:y,error:g,fetch:U,hasNextPage:null!=S?S:A?E<A:L,hasPreviousPage:E>1,loading:m,page:E,perPage:P,reset:K,searchInput:D,setSearchInput:R,supportsPagination:L,supportsSearch:q,totalPages:A},B)}function xe(e){return(0,j.jsx)(j.Fragment,{children:Object.entries(e.fields).map((([t,n],r)=>{var o;const i={action:"add_field_shortcode",selectedField:t,remoteData:e.remoteData,type:e.fieldType,selectionPath:"select_new_tab"};return(0,j.jsx)(x.MenuItem,{className:"remote-data-blocks-inline-field",onClick:t=>{t.preventDefault(),e.onSelectField(i,n.value)},onKeyDown:t=>{"enter"===t.key.toLowerCase()&&e.onSelectField(i,n.value)},suffix:e.selectedField===t?(0,j.jsx)(x.Icon,{icon:fe,size:24,style:{color:"#4ab866"}}):void 0,children:(0,j.jsxs)(x.BaseControl,{className:"remote-data-blocks-inline-field-choice",__nextHasNoMarginBottom:!0,children:[(0,j.jsxs)(x.BaseControl.VisualLabel,{style:{marginBottom:0,whiteSpace:"normal"},children:[n.name,":"]}),null===(o=n.value)||void 0===o?void 0:o.toString()]})},r)}))})}function Fe(e){const n=t(e.remoteData.blockName),r=Object.entries(n).reduce(((t,[n,r])=>{const o=re(e.remoteData.results[0],n);return o&&C.includes(r.type)?Object.assign(Object.assign({},t),{[n]:{name:r.name,value:o}}):t}),{});return(0,j.jsx)(xe,Object.assign({},e,{fields:r,fieldType:"field"}))}function Oe(e){var t;const n=Object.fromEntries(Object.entries(null!==(t=e.remoteData.metadata)&&void 0!==t?t:{}).map((([e,t])=>{var n,r;return[e,{name:t.name,value:null!==(r=null===(n=t.value)||void 0===n?void 0:n.toString())&&void 0!==r?r:""}]})));return(0,j.jsx)(xe,Object.assign({},e,{fields:n,fieldType:"meta"}))}function Se(e){const{data:t,fetch:n,loading:r}=ke({blockName:e.blockName,queryKey:l});if((0,ue.useEffect)((()=>{r||t||n(e.queryInputs)}),[r,t]),!t||r)return(0,j.jsx)(x.Spinner,{});const o={onSelectField:e.onSelectField,remoteData:t,selectedField:e.selectedField};return"meta"===e.fieldType?(0,j.jsx)(Oe,Object.assign({},o)):(0,j.jsx)(Fe,Object.assign({},o))}function Ee(e){const t=i(),{remoteData:n}=e;return n.length>0?(0,j.jsx)(x.DropdownMenu,{icon:pe,label:"",text:(0,S.__)("Existing items","remote-data-blocks"),popoverProps:{className:"remote-data-blocks-inline-binding-dropdown remote-data-blocks-select-existing",placement:"right-start",offset:0},children:()=>n.map((n=>{var r,o;return(0,j.jsx)(x.MenuGroup,{label:null!==(o=null===(r=t[n.blockName])||void 0===r?void 0:r.settings.title)&&void 0!==o?o:n.blockName,children:(0,j.jsx)(Fe,{onSelectField:(t,n)=>e.onSelectField(Object.assign(Object.assign({},t),{selectionPath:"select_existing_tab"}),n),remoteData:n})},n.blockName)}))}):void 0}function Pe(e){var t,n;const r=(0,ce.useAnchor)({editableContentElement:e.contentRef.current,settings:e.formatTypeSettings}),{remoteData:o,selectedField:i,type:a}=e.fieldSelection;return(0,j.jsx)(x.Popover,{placement:"bottom-start",anchor:r,className:"block-editor-format-toolbar__image-popover",noArrow:!1,offset:8,onClose:e.onClose,focusOnMount:"firstElement",children:(0,j.jsxs)(x.Card,{style:{width:"24rem"},children:[(0,j.jsx)(x.CardHeader,{children:(0,j.jsx)(x.__experimentalHeading,{level:4,children:(0,S.__)("Select a field to bind","remote-data-blocks")})}),(0,j.jsx)(x.CardBody,{children:(0,j.jsx)(Se,{blockName:null!==(t=null==o?void 0:o.blockName)&&void 0!==t?t:"Remote Data Block",fieldType:null!=a?a:"field",onSelectField:(t,n)=>e.onSelectField(Object.assign(Object.assign({},t),{action:"update_field_shortcode"}),n),queryInputs:null!==(n=null==o?void 0:o.queryInputs)&&void 0!==n?n:[{}],selectedField:i})}),(0,j.jsx)(x.CardFooter,{children:(0,j.jsx)(x.Button,{onClick:()=>e.resetField(null==o?void 0:o.blockName),isDestructive:!0,children:(0,S.__)("Reset field","remote-data-blocks")})})]})})}function Ie(){const{getBlocksByName:e,getBlocksByClientId:t}=(0,O.useSelect)(k.store,[]);return Object.keys(i()).flatMap((n=>e(n).map((e=>{var n;const r=t(e)[0];return oe(null===(n=null==r?void 0:r.attributes)||void 0===n?void 0:n.remoteData)})).filter((e=>Boolean(e)))))}function Le(e){const t=i(),n=Ie();return n.length>0?(0,j.jsx)(x.DropdownMenu,{icon:pe,label:"",text:(0,S.__)("Query metadata","remote-data-blocks"),popoverProps:{className:"remote-data-blocks-inline-binding-dropdown remote-data-blocks-select-meta",placement:"right-start",offset:0},children:()=>n.map((n=>{var r,o;return(0,j.jsx)(x.MenuGroup,{label:null!==(o=null===(r=t[n.blockName])||void 0===r?void 0:r.settings.title)&&void 0!==o?o:n.blockName,children:(0,j.jsx)(Oe,{onSelectField:(t,n)=>e.onSelectField(Object.assign(Object.assign({},t),{selectionPath:"select_meta_tab"}),n),remoteData:n})},n.blockName)}))}):void 0}function Ne(e){const{blockName:t,field:n,item:r,mediaField:o,onSelectField:i}=e,a=re(r,n);if(n===o){const e=function(e,t,n=""){var r,o,i;return null!==(i=null===(o=null===(r=Object.values(e.result).find((e=>e.type===t)))||void 0===r?void 0:r.value)||void 0===o?void 0:o.toString())&&void 0!==i?i:n}(r,"image_alt");return(0,j.jsx)("img",{alt:e,src:a})}return i?(0,j.jsx)(x.Button,{onClick:()=>{i(function(e,t,n){return{action:"add_field_shortcode",remoteData:{blockName:n,queryInputs:ne([t]),metadata:{}},selectedField:e,selectionPath:"select_new_tab",type:"field"}}(n,r,t),a)},variant:"link",children:a}):a}function Ae(e){var t,n,r,o;const{blockName:i,hasNextPage:a,loading:s,onSelect:l,onSelectField:c,page:u,perPage:d,results:p=[],searchInput:f,selectionIds:v,setPage:g,setPerPage:h,setSearchInput:b,setSelectionIds:C,supportsSearch:_,totalItems:w,totalPages:k}=e,{DataViews:x}=window.LockedPrivateDataViews,F=null!==(n=null===(t=null==p?void 0:p[0])||void 0===t?void 0:t.result)&&void 0!==n?n:{},O=Object.entries(F).filter((([e,t])=>!m.includes(t.type))).map((([e])=>e)),E=null===(r=Object.entries(F).find((([e,t])=>"title"===t.type)))||void 0===r?void 0:r[0],P=null===(o=Object.entries(F).find((([e,t])=>y.includes(t.type))))||void 0===o?void 0:o[0],I=O.map((e=>{var t,n;return{id:e,label:null!==(n=null===(t=F[e])||void 0===t?void 0:t.name)&&void 0!==n?n:e,enableGlobalSearch:!0,getValue:({item:t})=>re(t,e),render:({item:t})=>(0,j.jsx)(Ne,{blockName:i,field:e,item:t,mediaField:P,onSelectField:c}),enableSorting:e!==P}})),L=null!=d?d:Math.max(p.length,10),N=O.filter((e=>e!==P&&e!==E)),[A,B]=(0,ue.useState)({type:"table",perPage:L,page:u,search:f,fields:N,filters:[],layout:{},titleField:E,mediaField:P});(0,ue.useEffect)((()=>{B((e=>Object.assign(Object.assign({},e),{fields:N,mediaField:P,titleField:E})))}),[[P,E,...N].join(";")]);const T=P?{table:{},grid:{}}:{table:{}},M={id:"choose",icon:(0,j.jsx)(j.Fragment,{children:(0,S.__)("Choose")}),isPrimary:!0,label:"",callback:e=>{null==l||l(e)},supportsBulk:!0};let D=[];return l&&(null==p?void 0:p.length)&&(D=[M]),(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(x,{actions:D,data:p,defaultLayouts:T,fields:I,getItemId:e=>e.uuid,isLoading:s||!p,isItemClickable:()=>!0,onChangeSelection:C,onChangeView:function(e){var t,n,r;g(null!==(t=e.page)&&void 0!==t?t:1),h(null!==(n=e.perPage)&&void 0!==n?n:L),b(null!==(r=e.search)&&void 0!==r?r:""),B(e)},paginationInfo:{totalItems:null!=w?w:p.length,totalPages:null!=k?k:a?u+1:Math.max(1,u)},search:_,selection:v,view:A})})}const Be=e=>{var t,n,i,a;const{className:s,blockName:l,onSelect:c,onSelectField:u,queryKey:d,renderTrigger:p,title:f}=e,v=r(l),[g,h]=(0,ue.useState)([]),{close:m,isOpen:b,open:y}=function(){const[e,t]=(0,ue.useState)(!1);return{close:function(){t(!1)},isOpen:e,open:function(){t(!0)}}}(),{data:C,hasNextPage:_,loading:w,page:k,perPage:F,searchInput:O,setPage:E,setPerPage:P,setSearchInput:I,supportsSearch:L,totalItems:N,totalPages:A}=ke({blockName:l,fetchOnMount:!0,queryKey:d}),B=g.map((e=>e.uuid)),T=null!==(n=null===(t=null==C?void 0:C.results)||void 0===t?void 0:t.map((e=>e.uuid)))&&void 0!==n?n:[],M=Boolean(c);function D(e){const t=B.filter((e=>!T.includes(e))),n=Array.from(new Set([...t,...e])).map((e=>{var t,n,r;return null!==(r=null!==(n=null===(t=null==C?void 0:C.results)||void 0===t?void 0:t.find((t=>e===t.uuid)))&&void 0!==n?n:g.find((t=>e===t.uuid)))&&void 0!==r?r:null})).filter((e=>null!==e));h(n)}function R(e){M&&e.length&&(null==c||c(ne(e)),W("add_block",{action:"select_item",selected_option:"search_from_list",data_source_type:o(l)}),m())}const q=p?p({onClick:y}):(0,j.jsx)(x.Button,{variant:"primary",onClick:y,__next40pxDefaultSize:!0,children:(0,S.__)("Select items")});return(0,j.jsxs)(j.Fragment,{children:[q,b&&(0,j.jsxs)(x.Modal,{className:M?`${s} rdb-dataviews-bulk-actions-modal`:s,isFullScreen:!0,onRequestClose:m,title:null!==(a=null===(i=null==v?void 0:v.settings)||void 0===i?void 0:i.title)&&void 0!==a?a:f,children:[(0,j.jsx)(Ae,{blockName:l,hasNextPage:null!=_&&_,loading:w,onSelect:M?R:void 0,onSelectField:u,page:k,perPage:F,results:w||null==C?void 0:C.results,searchInput:O,selectionIds:B,setPage:E,setPerPage:P,setSearchInput:I,setSelectionIds:D,supportsSearch:L,totalItems:N,totalPages:A}),M&&!w&&(0,j.jsxs)(x.__experimentalHStack,{className:"rdb-dataviews-bulk-actions-footer__selection-total",justify:"flex-end",spacing:3,children:[(0,j.jsx)(x.Button,{disabled:0===g.length,onClick:()=>D([]),variant:"tertiary",isDestructive:!0,__next40pxDefaultSize:!0,children:(0,S.__)("Clear selection")}),(0,j.jsx)(x.Button,{disabled:0===g.length,onClick:()=>R(g),variant:"primary",__next40pxDefaultSize:!0,children:(0,S.__)("Select items")})]})]})]})};function Te(e){const{onSelectField:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["onSelectField"]),r=i(),o=Object.values(r).reduce(((e,t)=>{const n=t.dataSourceType;return e[n]||(e[n]=[]),e[n].push(t),e}),{});return(0,j.jsx)(x.DropdownMenu,Object.assign({icon:pe,label:"",text:(0,S.__)("Select an item","remote-data-blocks"),popoverProps:{className:"remote-data-blocks-inline-binding-dropdown remote-data-blocks-select-new",placement:"right-start",offset:0}},n,{children:()=>Object.entries(o).map((([e,n])=>(0,j.jsx)(x.MenuGroup,{label:e,children:n.map((e=>{const n=e.selectors.find((e=>["list","search"].includes(e.type)));return n?(0,j.jsx)(Be,{blockName:e.name,headerImage:n.image_url,onSelectField:t,queryKey:n.query_key,renderTrigger:({onClick:t})=>{var n,r;return(0,j.jsx)(x.MenuItem,{onClick:t,children:null!==(r=null===(n=e.settings)||void 0===n?void 0:n.title)&&void 0!==r?r:e.name})}},e.name):null}))},e)))}))}const Me="remote-data-blocks/inline-field",De={attributes:{"data-query":"data-query"},className:null,contentEditable:!1,edit:()=>null,interactive:!0,name:Me,object:!1,tagName:"remote-data-blocks-inline-field",title:"Block Bindings"};(0,ce.registerFormatType)("remote-data-blocks/inline-binding",Object.assign(Object.assign({},De),{edit:function(e){const{onChange:t,onFocus:n,value:r,isObjectActive:i,activeObjectAttributes:a,contentRef:s}=e,l=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(null==a?void 0:a["data-query"]),[c,u]=(0,ue.useState)(!1);(0,ue.useEffect)((()=>{i&&u(!0)}),[i]);const d=(e,n)=>{const o={remoteData:null==e?void 0:e.remoteData,selectedField:null==e?void 0:e.selectedField,type:null==e?void 0:e.type},i={attributes:Object.assign(Object.assign({},a),{"data-query":e?JSON.stringify(o):""}),innerHTML:n,type:Me};t(Object.keys(a).length?Object.assign(Object.assign({},r),{replacements:r.replacements.map(((e,t)=>t===r.start?i:e))}):(0,ce.insertObject)(r,i))},p=(e,t)=>{var r;d(e,t),u(!1),n(),W("field_shortcode",{action:e.action,data_source_type:o(null===(r=e.remoteData)||void 0===r?void 0:r.blockName),selection_path:e.selectionPath})},f=Ie();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(k.BlockControls,{children:(0,j.jsx)(x.ToolbarGroup,{children:f.length>0?(0,j.jsx)(x.ToolbarDropdownMenu,{className:"remote-data-blocks-select-new",icon:"shortcode",label:(0,S.__)("Select block bindings","remote-data-blocks"),popoverProps:{className:"rdb-inline-binding_dropdown",offset:8},children:()=>(0,j.jsxs)(x.ToolbarGroup,{children:[(0,j.jsx)(Te,{onSelectField:p}),(0,j.jsx)(Ee,{onSelectField:p,remoteData:f}),(0,j.jsx)(Le,{onSelectField:p})]})}):(0,j.jsx)(Te,{onSelectField:p,icon:"shortcode",label:(0,S.__)("Select block bindings","remote-data-blocks"),popoverProps:{offset:8,placement:"bottom-start"},text:void 0})})}),c&&l&&(0,j.jsx)(Pe,{contentRef:s,fieldSelection:l,formatTypeSettings:De,onClose:()=>{u(!1),n()},onSelectField:(e,t)=>p(Object.assign(Object.assign({},e),{selectionPath:"popover"}),t),resetField:e=>{d(null,"Unbound field"),W("field_shortcode",{action:"reset_field_shortcode",data_source_type:o(e)})}})]})}}))})()})();